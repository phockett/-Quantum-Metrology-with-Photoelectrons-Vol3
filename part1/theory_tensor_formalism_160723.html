

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3.3. Tensor formulation of photoionization &#8212; Quantum Metrology with Photoelectrons Vol. 3 *Analysis methodologies*</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["\\boldsymbol{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part1/theory_tensor_formalism_160723';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.4. Density matrix representation" href="theory_density_matrices_190723.html" />
    <link rel="prev" title="3.2. Symmetry in photoionization" href="theory_symmetry_140723.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/ePSproc_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/ePSproc_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    About the book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Frontmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/about_the_authors.html">About the authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/book_versions_note.html">A note on book versions, formats and conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/overview_270122.html">Overview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I - Theory &amp; software</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="main_intro_060723.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="platform_intro_070723.html">2. Quantum metrology software platform/ecosystem overview</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="theory_100723.html">3. Theory</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="theory_photoionization_dynamics_140723.html">3.1. Photoionization dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_symmetry_140723.html">3.2. Symmetry in photoionization</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.3. Tensor formulation of photoionization</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_density_matrices_190723.html">3.4. Density matrix representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_molecular_alignment_170723.html">3.5. Molecular alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_observables_intro_100723.html">3.6. Observables: photoelectron flux in the LF and MF</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_info_content_221122.html">3.7. Information content &amp; sensitivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="numerics_070723.html">4. Numerical methodologies for extracting matrix elements</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II - Extracting matrix elements - numerical methods &amp; case studies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part2/extracting_matrix_elements_overview_270423.html">5. Extracting matrix elements overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/sym-fitting-intro_220423.html">6. Basis sets for fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/basic_fitting_numerics_intro_260423.html">7. Basic fit setup and numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/case-study-N2_270423.html">8. Case study: Generalised bootstrapping for a homonuclear diatomic scattering system, <span class="math notranslate nohighlight">\(N_2~(D_{\infty h})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/case-study-OCS_270423-headerOnly.html">9. Case study: Generalised bootstrapping for a linear heteronuclear scattering system, <span class="math notranslate nohighlight">\(OCS~(C_{\infty v})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/case-study-C2H4_270423.html">10. Case study: Generalised bootstrapping for a general asymmetric top scattering system, <span class="math notranslate nohighlight">\(C_2H_4~(D_{2h})\)</span></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../backmatter/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backmatter/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Test pages</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tests/build_versions_checks.html">Build versions and config tests</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/phockett/Quantum-Metrology-with-Photoelectrons-Vol3" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/phockett/Quantum-Metrology-with-Photoelectrons-Vol3/issues/new?title=Issue%20on%20page%20%2Fpart1/theory_tensor_formalism_160723.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part1/theory_tensor_formalism_160723.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tensor formulation of photoionization</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#channel-functions">3.3.1. Channel functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-tensor-expansion">3.3.2. Full tensor expansion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frame-definitions">3.3.3. Frame definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-aside-symmetry-defined-channel-functions">3.3.4. Numerical aside: symmetry-defined channel functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-element-geometric-coupling-term-b-l-m">3.3.5. Matrix element geometric coupling term <span class="math notranslate nohighlight">\(B_{L,M}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#electric-field-geometric-coupling-term-e-p-r-hat-e-mu-0">3.3.6. Electric field geometric coupling term <span class="math notranslate nohighlight">\({E_{P,R}(\hat{e};\mu_{0})}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#molecular-frame-projection-term-lambda">3.3.7. Molecular frame projection term <span class="math notranslate nohighlight">\(\Lambda\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-tensor-delta-l-m-k-q-s">3.3.8. Alignment tensor <span class="math notranslate nohighlight">\(\Delta_{L,M}(K,Q,S)\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-cases">3.3.8.1. Basic cases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-alignments-and-symmetry-breaking">3.3.8.2. 3D alignments and symmetry breaking</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-product-terms">3.3.9. Tensor product terms</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tensor-formulation-of-photoionization">
<span id="sec-tensor-formulation"></span><h1><span class="section-number">3.3. </span>Tensor formulation of photoionization<a class="headerlink" href="#tensor-formulation-of-photoionization" title="Permalink to this heading">#</a></h1>
<p>A number of authors have treated <a class="reference internal" href="../backmatter/glossary.html#term-PADs"><span class="xref std std-term">PADs</span></a> and related problems in the context of photoionization theory and matrix element reconstruction (see <em>Quantum Metrology</em> Vol. 2 <span id="id1">[<a class="reference internal" href="../backmatter/bibliography.html#id664" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 2: Applications and Advances. IOP Publishing, 2018. ISBN 978-1-68174-688-3. URL: http://iopscience.iop.org/book/978-1-6817-4688-3.">5</a>]</span> Chpt. 8 for examples and discussion, a range of review articles can also be found in the literature, e.g. Refs. <span id="id2">[<a class="reference internal" href="../backmatter/bibliography.html#id514" title="Uwe Becker. Complete photoionisation experiments. Journal of Electron Spectroscopy and Related Phenomena, 96(1-3):105–115, November 1998. URL: http://linkinghub.elsevier.com/retrieve/pii/S0368204898002266 (visited on 2012-10-02).">82</a>, <a class="reference internal" href="../backmatter/bibliography.html#id822" title="Katharine L Reid. Photoelectron angular distributions. Annual review of physical chemistry, 54(19):397–424, January 2003. URL: http://dx.doi.org/10.1146/annurev.physchem.54.011002.103814 (visited on 2012-07-17).">83</a>, <a class="reference internal" href="../backmatter/bibliography.html#id707">84</a>, <a class="reference internal" href="../backmatter/bibliography.html#id708" title="Hans Kleinpoppen, Bernd Lohmann, and Alexei N Grum-Grzhimailo. Perfect/Complete Scattering Experiments. Volume 75. Springer Berlin Heidelberg, Berlin, Heidelberg, 2013. ISBN 978-3-642-40513-6. URL: https://books.google.ca/books?id=Cia4BAAAQBAJ.">85</a>]</span>); herein, a geometric tensor based formalism is developed, which is close in spirit to the treatments given by Underwood and co-workers <span id="id3">[<a class="reference internal" href="../backmatter/bibliography.html#id886" title="Albert Stolow and Jonathan G. Underwood. Time-Resolved Photoelectron Spectroscopy of Non-Adiabatic Dynamics in Polyatomic Molecules. In Stuart A. Rice, editor, Advances in Chemical Physics, volume 139, pages 497–584. John Wiley &amp; Sons, Inc., Hoboken, NJ, USA, March 2008. URL: http://doi.wiley.com/10.1002/9780470259498 (visited on 2012-07-18).">79</a>, <a class="reference internal" href="../backmatter/bibliography.html#id821" title="Katharine L. Reid and Jonathan G. Underwood. Extracting molecular axis alignment from photoelectron angular distributions. The Journal of Chemical Physics, 112(8):3643, 2000. URL: http://link.aip.org/link/JCPSA6/v112/i8/p3643/s1&amp;Agg=doi.">86</a>, <a class="reference internal" href="../backmatter/bibliography.html#id916" title="Jonathan G. Underwood and Katharine L. Reid. Time-resolved photoelectron angular distributions as a probe of intramolecular dynamics: Connecting the molecular frame and the laboratory frame. The Journal of Chemical Physics, 113(3):1067, 2000. URL: http://link.aip.org/link/JCPSA6/v113/i3/p1067/s1&amp;Agg=doi (visited on 2012-07-17).">87</a>]</span>, but further separates various sets of physical parameters into dedicated tensors; this allows for a unified theoretical and numerical treatment, where the latter computes properties as tensor variables which can be further manipulated and investigated to give detailed insights into various aspects of photoionization for the system at hand, and implications/effects for matrix element retrieval in a given case. Furthermore, the tensors can readily be converted to a density matrix representation <span id="id4">[<a class="reference internal" href="../backmatter/bibliography.html#id968" title="Richard N Zare. Angular Momentum: Understanding Spatial Aspects in Chemistry and Physics. John Wiley &amp; Sons, 1988.">74</a>, <a class="reference internal" href="../backmatter/bibliography.html#id525" title="Karl Blum. Density Matrix Theory and Applications. Volume 64. Springer Berlin Heidelberg, Berlin, Heidelberg, 3rd editio edition, 2012. ISBN 978-3-642-20560-6. URL: http://link.springer.com/10.1007/978-3-642-20561-3.">88</a>]</span>, which is more natural for some quantities, and also emphasizes the link to quantum state tomography and other quantum information techniques. Much of the theoretical background, as well as application to aspects of the current problem, can be found in the textbooks of Blum <span id="id5">[<a class="reference internal" href="../backmatter/bibliography.html#id525" title="Karl Blum. Density Matrix Theory and Applications. Volume 64. Springer Berlin Heidelberg, Berlin, Heidelberg, 3rd editio edition, 2012. ISBN 978-3-642-20560-6. URL: http://link.springer.com/10.1007/978-3-642-20561-3.">88</a>]</span> and Zare <span id="id6">[<a class="reference internal" href="../backmatter/bibliography.html#id968" title="Richard N Zare. Angular Momentum: Understanding Spatial Aspects in Chemistry and Physics. John Wiley &amp; Sons, 1988.">74</a>]</span>.</p>
<p>Within this treatment, the observables can be defined in a series of simplified forms, emphasizing the quantities of interest for a given problem. The most general, and simplest, form is given in <a class="reference internal" href="#sec-channel-funcs"><span class="std std-numref">Sect. 3.3.1</span></a>, in terms of <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a>, and the remainder of this section (<a class="reference internal" href="#sec-full-tensor-expansion"><span class="std std-numref">Sect. 3.3.2</span></a> - <a class="reference internal" href="#sec-theory-tensor-products"><span class="std std-numref">Section 3.3.9</span></a>) gives a detailed breakdown of the various components of the <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a>, and numerical examples.</p>
<section id="channel-functions">
<span id="sec-channel-funcs"></span><h2><span class="section-number">3.3.1. </span>Channel functions<a class="headerlink" href="#channel-functions" title="Permalink to this heading">#</a></h2>
<p>A simple form of the equations<a class="footnote-reference brackets" href="#eqfootnote" id="id7" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>, amenable to fitting and numerical implementation, is to write the observables in terms of <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a>, which define the ionization continuum for a given case and set of parameters <span class="math notranslate nohighlight">\(u\)</span> (e.g. defined for the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>, or defined for a specific experimental configuration),</p>
<div class="math notranslate nohighlight" id="equation-eqn-channel-fns">
<span class="eqno">(3.13)<a class="headerlink" href="#equation-eqn-channel-fns" title="Permalink to this equation">#</a></span>\[\beta_{L,M}^{u}=\sum_{\zeta,\zeta'}\varUpsilon_{L,M}^{u,\zeta\zeta'}\mathbb{I}^{\zeta\zeta'}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\zeta,\zeta'\)</span> collect all the required quantum numbers, and
define all (coherent) pairs of components. The term
<span class="math notranslate nohighlight">\(\mathbb{I}^{\zeta\zeta'}\)</span> denotes the coherent square of the ionization
matrix elements:</p>
<div class="math notranslate nohighlight" id="equation-eqn-i-zeta">
<span class="eqno">(3.14)<a class="headerlink" href="#equation-eqn-i-zeta" title="Permalink to this equation">#</a></span>\[\mathbb{I}^{\zeta,\zeta}=I^{\zeta}(\epsilon)I^{\zeta'*}(\epsilon)
\]</div>
<p>Eq. <a class="reference internal" href="#equation-eqn-channel-fns">(3.13)</a> is effectively a convolution equation (cf. Refs. <span id="id8">[<a class="reference internal" href="../backmatter/bibliography.html#id821" title="Katharine L. Reid and Jonathan G. Underwood. Extracting molecular axis alignment from photoelectron angular distributions. The Journal of Chemical Physics, 112(8):3643, 2000. URL: http://link.aip.org/link/JCPSA6/v112/i8/p3643/s1&amp;Agg=doi.">86</a>, <a class="reference internal" href="../backmatter/bibliography.html#id625" title="Margaret Gregory, Paul Hockett, Albert Stolow, and Varun Makhija. Towards molecular frame photoelectron angular distributions in polyatomic molecules from lab frame coherent rotational wavepacket evolution. Journal of Physics B: Atomic, Molecular and Optical Physics, 54(14):145601, July 2021. URL: https://doi.org/10.1088/1361-6455/ac135f (visited on 2021-08-17), arXiv:2012.04561.">89</a>]</span>) with channel functions <span class="math notranslate nohighlight">\(\varUpsilon_{L,M}^{u,\zeta\zeta'}\)</span>, for a given “experiment” <span class="math notranslate nohighlight">\(u\)</span>, summed over all terms <span class="math notranslate nohighlight">\(\zeta,\zeta'\)</span>. Aside from the change in notation (which is here chosen to match the formalism of Refs. <span id="id9">[<a class="reference internal" href="../backmatter/bibliography.html#id747" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18).">27</a>, <a class="reference internal" href="../backmatter/bibliography.html#id617" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13).">28</a>, <a class="reference internal" href="../backmatter/bibliography.html#id786" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18).">29</a>]</span>),
these matrix elements are essentially identical to the simplified <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a>
<span class="math notranslate nohighlight">\(\mathbf{r}_{k,l,m}\)</span> defined in Eq. <a class="reference internal" href="theory_photoionization_dynamics_140723.html#equation-eq-r-kllam">(3.6)</a>, in the case where <span class="math notranslate nohighlight">\(\zeta=\{k,l,m\}\)</span>. Similarly, the <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a> are essentially nothing but a slightly different form of the <a class="reference internal" href="../backmatter/glossary.html#term-geometric-coupling-parameters"><span class="xref std std-term">geometric coupling parameters</span></a> of Eqs. <a class="reference internal" href="theory_photoionization_dynamics_140723.html#equation-eq-r-kllam">(3.6)</a>, <a class="reference internal" href="theory_photoionization_dynamics_140723.html#equation-eq-i-reduced-lf-2-45-vol1">(3.9)</a>, incorporating all required geometric parameters.
Note, also, that the <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a> used herein are usually assumed to be symmetrized (unless explicitly stated), i.e. expanded in <a class="reference internal" href="../backmatter/glossary.html#term-symmetrized-harmonics"><span class="xref std std-term">symmetrized harmonics</span></a> per Eq. <a class="reference internal" href="theory_observables_intro_100723.html#equation-eq-symharm-defn">(3.38)</a>, but with any additional symmetry parameters <span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span> incorporated into the value of the <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a>.</p>
<p>These complex matrix elements can also be equivalently defined in a magnitude, phase
form:</p>
<div class="math notranslate nohighlight" id="equation-eqn-i-zeta-mag-phase">
<span class="eqno">(3.15)<a class="headerlink" href="#equation-eqn-i-zeta-mag-phase" title="Permalink to this equation">#</a></span>\[I^{\zeta}(\epsilon)\equiv\mathbf{r}_{\zeta}\equiv r_{\zeta}e^{i\phi_{\zeta}}\]</div>
<p>This tensorial form is numerically implemented in the <a class="reference external" href="https://github.com/phockett/ePSproc">ePSproc</a> <span id="id10">[<a class="reference internal" href="../backmatter/bibliography.html#id597" title="Paul Hockett. ePSproc: Post-processing for ePolyScat (Github repository). Github, 2016. URL: https://github.com/phockett/ePSproc.">25</a>]</span> codebase, and is in contradistinction to standard numerical routines in which the requisite terms are usually computed from vectorial and/or nested summations. The <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id11">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span> codebase implements <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a> retrieval based on the tensor formalism, with pre-computation of all the geometric tensor components (<a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a>) prior to a fitting protocol for matrix element analysis, essentially a fit to Eqn. <a class="reference internal" href="#equation-eqn-channel-fns">(3.13)</a>, with terms <span class="math notranslate nohighlight">\(I^{\zeta}(\epsilon)\)</span> as the unknowns (in magnitude, phase form per <a class="reference internal" href="#equation-eqn-i-zeta-mag-phase">(3.15)</a>). The main computational cost of a tensor-based approach is that more RAM is required to store the full set of tensor variables; however, the method is computationally efficient since it is inherently parallel (as compared to a traditional, serial loop-based solution), hence may lead to significantly faster evaluation of observables. Furthermore, the method allows for the computational routines to match the formalism quite closely, and for the investigation of the properties of the <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a> for a given problem in general terms, as well as for specific experimental cases including examination of specific couplings/effects. (Again, this is in contrast to standard nested-loop routines, which can be somewhat opaque to detailed interpretation, and typically implement the full computation of the observables in one monolithic computational routine; they do, however, have significantly lower RAM requirements since the full multi-dimensional basis tensors are not required to be stored.) <a class="reference internal" href="#sec-full-tensor-expansion"><span class="std std-numref">Sect. 3.3.2</span></a> provides details of the tensor components of the <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a>, and the remainder of this section breaks these down further, including numerical examples, and discussion of their significance for fitting problems in specific cases.</p>
</section>
<section id="full-tensor-expansion">
<span id="sec-full-tensor-expansion"></span><h2><span class="section-number">3.3.2. </span>Full tensor expansion<a class="headerlink" href="#full-tensor-expansion" title="Permalink to this heading">#</a></h2>
<p>In more detail, the <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a> <span class="math notranslate nohighlight">\(\varUpsilon_{L,M}^{u,\zeta\zeta'}\)</span> can be given as a set of tensors, defining each aspect of the problem. The following equations illustrate this for the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> and <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> cases, fully expanding the general form of Eq. <a class="reference internal" href="#equation-eqn-channel-fns">(3.13)</a> in terms of the relevant tensors. Further details and numerical examples are given in the following sub-sections.</p>
<p>For the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-eq-blm-tensor-mf">
<span class="eqno">(3.16)<a class="headerlink" href="#equation-eq-blm-tensor-mf" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
\beta_{L,-M}^{\mu_{i},\mu_{f}}(\epsilon) &amp; = &amp; (-1)^{M}\sum_{P,R',R}{[P]^{\frac{1}{2}}}{E_{P-R}(\hat{e};\mu_{0})}\\
 &amp; \times &amp;\sum_{l,m,\mu}\sum_{l',m',\mu'}(-1)^{(\mu'-\mu_{0})}{\Lambda_{R',R}(R_{\hat{n}};\mu,P,R,R')B_{L,-M}(l,l',m,m')}\\
 &amp; \times &amp; I_{l,m,\mu}^{p_{i}\mu_{i},p_{f}\mu_{f}}(\epsilon)I_{l',m',\mu'}^{p_{i}\mu_{i},p_{f}\mu_{f}*}(\epsilon)\end{aligned}\end{split}\]</div>
<p>And the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> as:</p>
<div class="math notranslate nohighlight" id="equation-eq-blm-tensor-af">
<span class="eqno">(3.17)<a class="headerlink" href="#equation-eq-blm-tensor-af" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{aligned}
\bar{\beta}_{L,-M}^{\mu_{i},\mu_{f}}(\epsilon,t) &amp; = &amp; (-1)^{M}\sum_{P,R',R}{[P]^{\frac{1}{2}}}{E_{P-R}(\hat{e};\mu_{0})}\\
 &amp; \times &amp;\sum_{l,m,\mu}\sum_{l',m',\mu'}(-1)^{(\mu'-\mu_{0})}{\bar{\Lambda}_{R'}(\mu,P,R')B_{L,S-R'}(l,l',m,m')}\\
 &amp; \times &amp;I_{l,m,\mu}^{p_{i}\mu_{i},p_{f}\mu_{f}}(\epsilon)I_{l',m',\mu'}^{p_{i}\mu_{i},p_{f}\mu_{f}*}(\epsilon)\sum_{K,Q,S}\Delta_{L,M}(K,Q,S)A_{Q,S}^{K}(t)\end{aligned}\end{split}\]</div>
<p>In both cases a set of geometric tensor terms are required,</p>
<p>these terms provide details of:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\({E_{P-R}(\hat{e};\mu_{0})}\)</span>: polarization geometry &amp; coupling with
the electric field.</p></li>
<li><p><span class="math notranslate nohighlight">\(B_{L,M}(l,l',m,m')\)</span>: geometric coupling of the partial waves into the <span class="math notranslate nohighlight">\(\beta_{L,M}\)</span> terms (spherical tensors). Note for the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> case the terms may be reindexed by <span class="math notranslate nohighlight">\(M=S-R'\)</span>, which allows for the projection dependence on the <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a> (see below).</p></li>
<li><p><span class="math notranslate nohighlight">\(\Lambda_{R',R}(R_{\hat{n}};\mu,P,R,R')\)</span>, <span class="math notranslate nohighlight">\(\bar{\Lambda}_{R'}(\mu,P,R')\)</span>: frame couplings and rotations (note slightly different terms for <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> and <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a>).</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta_{L,M}(K,Q,S)\)</span>: alignment frame coupling (<a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> only).</p></li>
<li><p><span class="math notranslate nohighlight">\(A_{Q,S}^{K}(t)\)</span>: ensemble alignment described as a set of <a class="reference internal" href="../backmatter/glossary.html#term-axis-distribution-moments"><span class="xref std std-term">axis distribution moments</span></a> (<a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a>, <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> only).  Note for a one-photon ionization case - the traditional <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> experiment - there will only be a single term, <span class="math notranslate nohighlight">\(K=Q=S=0\)</span>, with no time-dependence, which describes an isotropic molecular ensemble. In general only the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> is discussed explicitly herein, but it is of note that this is identical to the traditional <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> definition for this limiting case of an isotropic ensemble.</p></li>
<li><p>Square-brackets are short-hand for degeneracy terms, e.g. <span class="math notranslate nohighlight">\([P]^{\frac{1}{2}} = (2P+1)^{\frac{1}{2}}\)</span>.</p></li>
</ul>
<p>And <span class="math notranslate nohighlight">\(I_{l,m,\mu}^{p_{i}\mu_{i},p_{f}\mu_{f}}(\epsilon)\)</span> are the <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a>, as a function of energy <span class="math notranslate nohighlight">\(\epsilon\)</span>.
As noteed above, these <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a> are essentially identical to the simplified forms
<span class="math notranslate nohighlight">\(r_{k,l,m}\)</span> defined in Eqn. <a class="reference internal" href="theory_photoionization_dynamics_140723.html#equation-eq-r-kllam">(3.6)</a>, except now with additional indices to label
symmetry and polarization components defined by a set of <a class="reference internal" href="../backmatter/glossary.html#term-partial-waves"><span class="xref std std-term">partial-waves</span></a>
<span class="math notranslate nohighlight">\(\{l,m\}\)</span>, for polarization component <span class="math notranslate nohighlight">\(\mu\)</span> (denoting the photon angular
momentum components) and channels (symmetries) labelled by initial and
final state indexes <span class="math notranslate nohighlight">\((p_{i}\mu_{i},p_{f}\mu_{f})\)</span>. The notation here
follows that used by <a class="reference external" href="https://epolyscat.droppages.com/">ePolyScat (ePS)</a> <span id="id12">[<a class="reference internal" href="../backmatter/bibliography.html#id747" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18).">27</a>, <a class="reference internal" href="../backmatter/bibliography.html#id617" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13).">28</a>, <a class="reference internal" href="../backmatter/bibliography.html#id786" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18).">29</a>, <a class="reference internal" href="../backmatter/bibliography.html#id750" title="R R Lucchese. ePolyScat User's Manual. URL: https://epolyscat.droppages.com/ (visited on 2022-04-26).">30</a>]</span>, and these matrix elements again represent the quantities to be obtained numerically from data analysis, or from an <a class="reference external" href="https://epsproc.readthedocs.io/en/latest/ePS_ePSproc_tutorial/ePS_tutorial_080520.html#Theoretical-background">ePolyScat (or similar) calculation</a>.</p>
<p>Following the tensor components detailed above, the full form of the <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a> of Eq. <a class="reference internal" href="#equation-eqn-channel-fns">(3.13)</a> for the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> and <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> can be written as:</p>
<div class="math notranslate nohighlight" id="equation-eq-channelfunc-mf-defn">
<span class="eqno">(3.18)<a class="headerlink" href="#equation-eq-channelfunc-mf-defn" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\varUpsilon_{L,M}^{u,\zeta\zeta'} &amp; = &amp; (-1)^{M}{[P]^{\frac{1}{2}}}E_{P-R}(\hat{e};\mu_{0})(-1)^{(\mu'-\mu_{0})}\Lambda_{R',R}(R_{\hat{n}};\mu,P,R,R')\\
 &amp; \times &amp; B_{L,-M}(l,l',m,m')\end{aligned}
\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-channelfunc-af-defn">
<span class="eqno">(3.19)<a class="headerlink" href="#equation-eq-channelfunc-af-defn" title="Permalink to this equation">#</a></span>\[\begin{split}
\begin{aligned}
\bar{\varUpsilon_{}}_{L,M}^{u,\zeta\zeta'} &amp; = &amp; (-1)^{M}[P]^{\frac{1}{2}}E_{P-R}(\hat{e};\mu_{0})(-1)^{(\mu'-\mu_{0})}\bar{\Lambda}_{R'}(\mu,P,R')\\
 &amp; \times &amp; B_{L,S-R'}(l,l',m,m')\Delta_{L,M}(K,Q,S)A_{Q,S}^{K}(t)\end{aligned}
\end{split}\]</div>
<p>Note that, in this case as given, time-dependence arises purely from the
<span class="math notranslate nohighlight">\(A_{Q,S}^{K}(t)\)</span> terms in the AF case, and the electric field term
currently describes only the photon angular momentum coupling, although
can in principle also describe time-dependent/shaped fields. Similarly,
a time-dependent initial state (e.g. a vibrational wavepacket) could
also describe a time-dependent MF case.</p>
<p>It should be emphasized, however, that the underlying physical
quantities are essentially identical in all the theoretical approaches,
with a set of coupled angular-momenta defining the <a class="reference internal" href="../backmatter/glossary.html#term-geometric-coupling-parameters"><span class="xref std std-term">geometric coupling parameters</span></a> part of
the photoionization problem, despite these differences in the details of
the theory and notation.</p>
<p>The various tensors defined above are implemented as functions in the <a class="reference external" href="https://epsproc.readthedocs.io">ePSproc codebase</a> <span id="id13">[<a class="reference internal" href="../backmatter/bibliography.html#id655" title="Paul Hockett. ePSproc: Post-processing suite for ePolyScat electron-molecule scattering calculations. Authorea, 2016. URL: https://www.authorea.com/users/71114/articles/122402/_show_article.">24</a>, <a class="reference internal" href="../backmatter/bibliography.html#id597" title="Paul Hockett. ePSproc: Post-processing for ePolyScat (Github repository). Github, 2016. URL: https://github.com/phockett/ePSproc.">25</a>, <a class="reference internal" href="../backmatter/bibliography.html#id595" title="Paul Hockett. ePSproc: Post-processing for ePolyScat documentation. 2020. URL: https://epsproc.readthedocs.io (visited on 2022-02-18).">26</a>]</span>, and further wrapped for fitting cases in the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id14">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span>. In the remainder of this section, numerical examples using these codes are illustrated and explored. Full computational details can be found in the <a class="reference external" href="https://epsproc.readthedocs.io">ePSproc documentation</a> <span id="id15">[<a class="reference internal" href="../backmatter/bibliography.html#id595" title="Paul Hockett. ePSproc: Post-processing for ePolyScat documentation. 2020. URL: https://epsproc.readthedocs.io (visited on 2022-02-18).">26</a>]</span>, including <a class="reference external" href="https://epsproc.readthedocs.io/en/latest/methods/geometric_method_dev_260220_090420_tidy.html">extended discussion of each tensor</a> and complete function references in the <a class="reference external" href="https://epsproc.readthedocs.io/en/latest/modules/epsproc.geomFunc.geomCalc.html">geomCalc submodule documentation</a>.</p>
</section>
<section id="frame-definitions">
<span id="sec-frame-definitions"></span><h2><span class="section-number">3.3.3. </span>Frame definitions<a class="headerlink" href="#frame-definitions" title="Permalink to this heading">#</a></h2>
<p>A conceptual overview of the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> and relation to the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>, in the context of the bootstrap reconstruction protocol, can be found in <a class="reference internal" href="main_intro_060723.html#fig-bootstrap-concept-outline"><span class="std std-numref">Fig. 1.1</span></a>. A more detailed definition is given in <a class="reference internal" href="#fig-frame-defns"><span class="std std-numref">Fig. 3.1</span></a>, as pertains to the use of angular momentum notation and projections. The figure shows the general use of angular momenta and associated projection terms in molecular spectroscopy as an aid to visualising the discussion in the following sections. Note, however, that some alternative notations are used in this volume, in particular specific projection terms may be used for certain physical quantities.</p>
<p>In simple cases, the frame definition for the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> is identical to that of the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>, since it is usually defined by the laser polarization, with the distinction that an aligned molecular ensemble is additionally present. For the limiting case of an isotropic distribution, the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> and (traditional) <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> are identical. However, in cases with non-linear laser polarization, and/or multiple pulses with different polarization vectors, the situation may be more complicated, and additional <a class="reference internal" href="../backmatter/glossary.html#term-frame-rotation"><span class="xref std std-term">frame rotation</span></a>(s) may be required (see <a class="reference internal" href="#fig-frame-defns"><span class="std std-numref">Fig. 3.1</span></a> inset). In such cases the reference frame may be chosen as the final ionizing laser pulse polarization, or as a symmetry axis in the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a>. For high degrees of (3D) alignment the AF may approach the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> in the ideal case, although will usually be limited by the symmetry of the system.</p>
<figure class="align-default" id="fig-frame-defns">
<img alt="../_images/axes_QNs_inc_rotations_QM1.pdf" src="../_images/axes_QNs_inc_rotations_QM1.pdf" />
<figcaption>
<p><span class="caption-number">Fig. 3.1 </span><span class="caption-text">Reference frame and angular momentum definitions for the Laboratory frame (<a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>) and Molecular frame (<a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>), using a general notation from molecular spectroscopy. In this case the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> shows an angular momentum vectors <span class="math notranslate nohighlight">\(J\)</span> and <span class="math notranslate nohighlight">\(l\)</span>; <span class="math notranslate nohighlight">\(J\)</span> is usually used to define rotational (or sometimes total) angular momentum of the system, and <span class="math notranslate nohighlight">\(l\)</span> the electronic component. Projection terms onto the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> <span class="math notranslate nohighlight">\(z\)</span>-axis, <span class="math notranslate nohighlight">\(M_J\)</span> and <span class="math notranslate nohighlight">\(m_l\)</span> are also indicated. In the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> equivalent angular momentum terms are shown, with projections <span class="math notranslate nohighlight">\(K\)</span> and <span class="math notranslate nohighlight">\(\lambda\)</span> onto the molecular symmetry axis. The insert shows a <a class="reference internal" href="../backmatter/glossary.html#term-frame-rotation"><span class="xref std std-term">frame rotation</span></a> <span class="math notranslate nohighlight">\((x,y,z)\leftarrow(x',y',z')\)</span>, defined by a set of <a class="reference internal" href="../backmatter/glossary.html#term-Euler-angles"><span class="xref std std-term">Euler angles</span></a> <span class="math notranslate nohighlight">\(R_{\hat{n}}=\{\chi,\Theta,\Phi\}\)</span>, and illustrating the rotation of the <span class="math notranslate nohighlight">\(z\)</span>-axis (defined by the electric field vector <span class="math notranslate nohighlight">\(E\)</span>), and a spherical harmonic function in the <span class="math notranslate nohighlight">\((x',y',z')\)</span> frame. See also <a class="reference internal" href="main_intro_060723.html#fig-bootstrap-concept-outline"><span class="std std-numref">Fig. 1.1</span></a>. Figure reproduced from <em>Quantum Metrology</em> Vol. 1 <span id="id16">[<a class="reference internal" href="../backmatter/bibliography.html#id663" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5.">2</a>]</span>, Fig. 2.3, and shows  - note that some alternative notations are used in this volume.</span><a class="headerlink" href="#fig-frame-defns" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="numerical-aside-symmetry-defined-channel-functions">
<h2><span class="section-number">3.3.4. </span>Numerical aside: symmetry-defined channel functions<a class="headerlink" href="#numerical-aside-symmetry-defined-channel-functions" title="Permalink to this heading">#</a></h2>
<p>In the following sub-sections, each component is defined in detail, including numerical examples. For illustration purposes, the numerical example uses a minimal set of assumptions, and is defined initially purely by symmetry, although further terms may be required for computation of some of the geometric terms and are discussed where required. A fuller discussion of symmetry considerations in photoionization can be found in <a class="reference internal" href="theory_symmetry_140723.html#sec-theory-symmetry-intro"><span class="std std-numref">Sect. 3.2</span></a>, and discussion of <a class="reference internal" href="../backmatter/glossary.html#term-symmetrized-harmonics"><span class="xref std std-term">symmetrized harmonics</span></a> in <a class="reference internal" href="theory_observables_intro_100723.html#sec-theory-sym-harm-into"><span class="std std-numref">Sect. 3.6.2</span></a>.</p>
<p>For this example, the <span class="math notranslate nohighlight">\(D_{2h}\)</span> point group is used, representing a fairly general case of a planar asymmetric top system, e.g. ethylene (<span class="math notranslate nohighlight">\(C_2H_4\)</span>). Note that, in this case, the symmetrization coefficients (<span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span>, see <a class="reference internal" href="theory_observables_intro_100723.html#equation-eq-symharm-defn">(3.38)</a>) have the property that <span class="math notranslate nohighlight">\(\mu=0\)</span> only, and the <span class="math notranslate nohighlight">\(h\)</span> index is redundant, since it maps uniquely to <span class="math notranslate nohighlight">\(l\)</span> - see <a class="reference internal" href="#tab-d2hxlm"><span class="std std-numref">Fig. 3.2</span></a> - so these indexes can be dropped. Note, also, the unfortunate convention that the label <span class="math notranslate nohighlight">\(\mu\)</span> is used for multiple indexes; to avoid ambiguity this term is remapped to <span class="math notranslate nohighlight">\(\mu_X\)</span> in the numerics below. However, in this case, since <span class="math notranslate nohighlight">\(\mu\)</span> can be dropped from the symmetrization coefficients, there is actually no ambiguity in later usage.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Full tabulations of the parameters available in HTML or notebook formats only.</p>
</div>
</aside>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run default config - may need to set full path here</span>
<span class="o">%</span><span class="k">run</span> &#39;../scripts/setup_notebook.py&#39;

<span class="c1"># Override plotters backend?</span>
<span class="c1"># plotBackend = &#39;pl&#39;</span>

<span class="c1"># Set Matplotlib inline for lmPlot() with Seaborn display</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Setting up notebook with standard Quantum Metrology Vol. 3 imports...
For more details see https://pemtk.readthedocs.io/en/latest/fitting/PEMtk_fitting_basic_demo_030621-full.html
To use local source code, pass the parent path to this script at run time, e.g. &quot;setup_fit_demo ~/github&quot;

*** Running: 2023-07-22 13:39:32
Working dir: /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part1
Build env: html

* Loading packages...
* sparse not found, sparse matrix forms not available. 
* natsort not found, some sorting functions not available. 
* Setting plotter defaults with epsproc.basicPlotters.setPlotters(). Run directly to modify, or change options in local env.
* Set Holoviews with bokeh.
* pyevtk not found, VTK export not available. 
* Set Holoviews with bokeh.
Jupyter Book      : 0.15.1
External ToC      : 0.3.1
MyST-Parser       : 0.18.1
MyST-NB           : 0.17.2
Sphinx Book Theme : 1.0.1
Jupyter-Cache     : 0.6.1
NbClient          : 0.7.4
</pre></div>
</div>
<script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = false;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.1.1.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/panel.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><div class="output text_html"><div id='4622cf98-ccea-4551-87f9-1fdead4a543c'>
  <div id="ab50cdda-b220-4f38-b92b-226895e5aa06" data-root-id="4622cf98-ccea-4551-87f9-1fdead4a543c" style="display: contents;"></div>
</div>
<script type="application/javascript">(function(root) {
  var docs_json = {"496f2ace-4a25-4d46-88fc-8fb3d47f2b4a":{"version":"3.1.1","title":"Bokeh Application","defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]}],"roots":[{"type":"object","name":"panel.models.browser.BrowserInfo","id":"4622cf98-ccea-4551-87f9-1fdead4a543c"},{"type":"object","name":"panel.models.comm_manager.CommManager","id":"1fb8558a-2365-4795-b756-32616a6ec5ac","attributes":{"plot_id":"4622cf98-ccea-4551-87f9-1fdead4a543c","comm_id":"4f1ba275964c4cebb81ca5276c7f989d","client_comm_id":"f770af6c43bc4de28535510673b504a3"}}],"callbacks":{"type":"map"}}};
  var render_items = [{"docid":"496f2ace-4a25-4d46-88fc-8fb3d47f2b4a","roots":{"4622cf98-ccea-4551-87f9-1fdead4a543c":"ab50cdda-b220-4f38-b92b-226895e5aa06"},"root_ids":["4622cf98-ccea-4551-87f9-1fdead4a543c"]}];
  var docs = Object.values(docs_json)
  if (!docs) {
    return
  }
  const py_version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')
  const is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1
  function embed_document(root) {
    var Bokeh = get_bokeh(root)
    Bokeh.embed.embed_items_notebook(docs_json, render_items);
    for (const render_item of render_items) {
      for (const root_id of render_item.root_ids) {
	const id_el = document.getElementById(root_id)
	if (id_el.children.length && (id_el.children[0].className === 'bk-root')) {
	  const root_el = id_el.children[0]
	  root_el.id = root_el.id + '-rendered'
	}
      }
    }
  }
  function get_bokeh(root) {
    if (root.Bokeh === undefined) {
      return null
    } else if (root.Bokeh.version !== py_version && !is_dev) {
      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(py_version)) {
	return null
      }
      return root.Bokeh.versions.get(py_version);
    } else if (root.Bokeh.version === py_version) {
      return root.Bokeh
    }
    return null
  }
  function is_loaded(root) {
    var Bokeh = get_bokeh(root)
    return (Bokeh != null && Bokeh.Panel !== undefined && ( root['Plotly'] !== undefined) && ( root['Plotly'] !== undefined))
  }
  if (is_loaded(root)) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (is_loaded(root)) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
	  var Bokeh = get_bokeh(root)
	  if (Bokeh == null || Bokeh.Panel == null) {
            console.warn("Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing");
	  } else {
	    console.warn("Panel: WARNING: Attempting to render but not all required libraries could be resolved.")
	    embed_document(root)
	  }
        }
      }
    }, 25, root)
  }
})(window);</script></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
<script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div></div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Setup symmetry-defined matrix elements using PEMtk</span>

<span class="c1"># Import class</span>
<span class="kn">from</span> <span class="nn">pemtk.sym.symHarm</span> <span class="kn">import</span> <span class="n">symHarm</span>

<span class="c1">#*** Compute hamronics for Td, lmax=4</span>
<span class="n">sym</span> <span class="o">=</span> <span class="s1">&#39;D2h&#39;</span>
<span class="n">lmax</span><span class="o">=</span><span class="mi">4</span>

<span class="n">lmaxPlot</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Set lmaxPlot for subselection on plots later.</span>

<span class="c1"># Create symHarm object with given settings, </span>
<span class="c1"># this will also compute the symmetrized harmonics</span>
<span class="n">symObj</span> <span class="o">=</span> <span class="n">symHarm</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span><span class="n">lmax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;it&#39;}
Added dim Eke
Added dim Targ
Added dim Total
Added dim mu
Added dim Type
Found dipole symmetries: 
{&#39;B1u&#39;: {&#39;m&#39;: [0], &#39;pol&#39;: [&#39;z&#39;]}, &#39;B2u&#39;: {&#39;m&#39;: [-1, 1], &#39;pol&#39;: [&#39;y&#39;]}, &#39;B3u&#39;: {&#39;m&#39;: [-1, 1], &#39;pol&#39;: [&#39;x&#39;]}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/home/jovyan/github/PEMtk/pemtk/sym/_dipoleTerms.py:102: FutureWarning: iteritems is deprecated and will be removed in a future version. Use .items instead.
  for (col, vals) in dipolePD.iteritems():
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Glue items for later</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;symHarmPGmatE&quot;</span><span class="p">,</span> <span class="n">sym</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;symHarmLmaxmatE&quot;</span><span class="p">,</span> <span class="n">lmax</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;symHarmBasislmaxPlot&quot;</span><span class="p">,</span> <span class="n">lmaxPlot</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Display results (real harmonics)</span>
<span class="n">symObj</span><span class="o">.</span><span class="n">displayXlm</span><span class="p">(</span><span class="n">setCols</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>  <span class="c1">#, dropLevels=&#39;mu&#39;)</span>

<span class="c1"># Glue version for JupyterBook output</span>
<span class="c1"># As above, but with PD object return and glue.</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;D2hXlm&quot;</span><span class="p">,</span><span class="n">symObj</span><span class="o">.</span><span class="n">displayXlm</span><span class="p">(</span><span class="n">setCols</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="n">returnPD</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="6" halign="left">b</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>h</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
    <tr>
      <th>Character ($\Gamma$)</th>
      <th>PFIX ($\mu$)</th>
      <th>l</th>
      <th>m</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">A1g</th>
      <th rowspan="6" valign="top">0</th>
      <th>0</th>
      <th>0</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2</th>
      <th>0</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">4</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>A1u</th>
      <th>0</th>
      <th>3</th>
      <th>-2</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B1g</th>
      <th rowspan="3" valign="top">0</th>
      <th>2</th>
      <th>-2</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>-4</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B1u</th>
      <th rowspan="3" valign="top">0</th>
      <th>1</th>
      <th>0</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>0</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B2g</th>
      <th rowspan="3" valign="top">0</th>
      <th>2</th>
      <th>1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>1</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B2u</th>
      <th rowspan="3" valign="top">0</th>
      <th>1</th>
      <th>-1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>-3</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B3g</th>
      <th rowspan="3" valign="top">0</th>
      <th>2</th>
      <th>-1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>-3</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B3u</th>
      <th rowspan="3" valign="top">0</th>
      <th>1</th>
      <th>1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>1</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<figure class="align-default" id="tab-d2hxlm">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="6" halign="left">b</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>h</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
    </tr>
    <tr>
      <th>Character ($\Gamma$)</th>
      <th>PFIX ($\mu$)</th>
      <th>l</th>
      <th>m</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">A1g</th>
      <th rowspan="6" valign="top">0</th>
      <th>0</th>
      <th>0</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2</th>
      <th>0</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">4</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
    </tr>
    <tr>
      <th>4</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>A1u</th>
      <th>0</th>
      <th>3</th>
      <th>-2</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B1g</th>
      <th rowspan="3" valign="top">0</th>
      <th>2</th>
      <th>-2</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>-4</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B1u</th>
      <th rowspan="3" valign="top">0</th>
      <th>1</th>
      <th>0</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>0</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B2g</th>
      <th rowspan="3" valign="top">0</th>
      <th>2</th>
      <th>1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>1</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B2u</th>
      <th rowspan="3" valign="top">0</th>
      <th>1</th>
      <th>-1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>-3</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B3g</th>
      <th rowspan="3" valign="top">0</th>
      <th>2</th>
      <th>-1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">4</th>
      <th>-3</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B3u</th>
      <th rowspan="3" valign="top">0</th>
      <th>1</th>
      <th>1</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">3</th>
      <th>1</th>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 3.2 </span><span class="caption-text">Symmetrized harmonics coefficients (<span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span>, see <a class="reference internal" href="theory_observables_intro_100723.html#equation-eq-symharm-defn">(3.38)</a>) for <span class="pasted-text">D2h</span> symmetry (<span class="math notranslate nohighlight">\(l_{max}=\)</span><span class="pasted-text">4</span>) generated with the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id17">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span> wrapper for <a class="reference external" href="https://github.com/mcodev31/libmsym"><code class="docutils literal notranslate"><span class="pre">libmsym</span></code></a> <span id="id18">[<a class="reference internal" href="../backmatter/bibliography.html#id691" title="Marcus Johansson and Valera Veryazov. Automatic procedure for generating symmetry adapted wavefunctions. Journal of Cheminformatics, 9(1):8, February 2017. URL: https://doi.org/10.1186/s13321-017-0193-3 (visited on 2022-08-03).">55</a>, <a class="reference internal" href="../backmatter/bibliography.html#id692" title="Marcus Johansson. Libmsym Github. July 2022. URL: https://github.com/mcodev31/libmsym (visited on 2022-08-03).">56</a>]</span>. Note that, in this case, the coeffcients have the property that <span class="math notranslate nohighlight">\(\mu=0\)</span> only, and the <span class="math notranslate nohighlight">\(h\)</span> index is redundant (maps uniquely to <span class="math notranslate nohighlight">\(l\)</span>).</span><a class="headerlink" href="#tab-d2hxlm" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To compute basis tensors from these symmetry coefficients, they can be converted to the standard <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a> format used in the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id19">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span> (see <a class="reference internal" href="../part2/sym-fitting-intro_220423.html#sec-basis-sets-mapping-params"><span class="std std-numref">Sect. 6.3.4</span></a> for further discussion of the numerical implementation), and used with the standard routines. These are demonstrated below, for two flavours - the base <a class="reference external" href="https://github.com/phockett/ePSproc">ePSproc</a> <span id="id20">[<a class="reference internal" href="../backmatter/bibliography.html#id597" title="Paul Hockett. ePSproc: Post-processing for ePolyScat (Github repository). Github, 2016. URL: https://github.com/phockett/ePSproc.">25</a>]</span> routine for computation of <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a>-<a class="reference internal" href="../backmatter/glossary.html#term-PADs"><span class="xref std std-term">PADs</span></a>, and the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id21">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span> fitting routine which wraps this functionality. Note that all tensors are stored as <a class="reference external" href="https://docs.xarray.dev"><code class="docutils literal notranslate"><span class="pre">Xarray</span></code></a> <span id="id22">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Stephan Hoyer and Joe Hamman. Xarray: N-D labeled Arrays and Datasets in Python. Journal of Open Research Software, 5(1):10, April 2017. URL: http://openresearchsoftware.metajnl.com/article/10.5334/jors.148/ (visited on 2022-08-03).">44</a>, <a class="reference internal" href="../backmatter/bibliography.html#id953" title="Xarray documentation. URL: https://docs.xarray.dev/en/latest/index.html (visited on 2022-08-03).">45</a>]</span> objects, which allow for easy numerical manipulation, subselection etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Compute basis functions for given matrix elements using PEMtk fit class</span>
<span class="c1"># This illustration uses the symmetrized matrix elements set above</span>

<span class="c1">#*** To use ePSproc/PEMtk classes, </span>
<span class="c1"># these values can be converted to ePSproc BLM data type...</span>
<span class="c1"># Run conversion - the default is to set the coeffs to the &#39;BLM&#39; data type, </span>
<span class="c1"># additional dim mappings can also be set.</span>
<span class="c1"># Outputs are set to symObj.coeffs[dataType]</span>
<span class="n">dimMap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;Cont&#39;</span><span class="p">,</span><span class="s1">&#39;mu&#39;</span><span class="p">:</span><span class="s1">&#39;muX&#39;</span><span class="p">}</span>
<span class="n">symObj</span><span class="o">.</span><span class="n">toePSproc</span><span class="p">(</span><span class="n">dimMap</span><span class="o">=</span><span class="n">dimMap</span><span class="p">)</span>

<span class="c1"># Run conversion with a different dimMap &amp; dataType</span>
<span class="c1"># Outputs are set to symObj.coeffs[dataType]</span>
<span class="n">dataType</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span>
<span class="n">symObj</span><span class="o">.</span><span class="n">toePSproc</span><span class="p">(</span><span class="n">dimMap</span> <span class="o">=</span> <span class="n">dimMap</span><span class="p">,</span> <span class="n">dataType</span><span class="o">=</span><span class="n">dataType</span><span class="p">)</span>


<span class="c1">#*** Setup class object</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pemtkFit</span><span class="p">()</span>

<span class="c1"># Set to new key in data class</span>
<span class="n">dataKey</span> <span class="o">=</span> <span class="n">sym</span>
<span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dataKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Set data.data[dataKey][dataType] from cases set above</span>
<span class="c1"># This pushes the symmetrized coeffs computed above to the PEMtk fit class </span>
<span class="c1"># object for general use with PEMtk methods.</span>
<span class="c1"># Here set &#39;matE&#39; for use as matrix elements, and &#39;BLM&#39; for pad plotting routines.</span>
<span class="k">for</span> <span class="n">dataType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;matE&#39;</span><span class="p">,</span><span class="s1">&#39;BLM&#39;</span><span class="p">]:</span>
    <span class="c1"># Select expansion in complex harmonics, and sum redundant dims</span>
    <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dataKey</span><span class="p">][</span><span class="n">dataType</span><span class="p">]</span> <span class="o">=</span> <span class="n">symObj</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="n">dataType</span><span class="p">][</span><span class="s1">&#39;b (comp)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;muX&#39;</span><span class="p">])</span> 
    <span class="c1"># Propagate attrs</span>
    <span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dataKey</span><span class="p">][</span><span class="n">dataType</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">symObj</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="n">dataType</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>

<span class="c1"># Set data by key</span>
<span class="c1"># data.subKey is the default location used by the PEMtk routines</span>
<span class="n">data</span><span class="o">.</span><span class="n">subKey</span> <span class="o">=</span> <span class="n">dataKey</span>


<span class="c1">#*** Compute basis function - two flavours</span>
<span class="c1"># Using PEMtk `afblmMatEfit` method </span>
<span class="c1"># - this only returns the product basis set as used for fitting</span>
<span class="c1"># See the docs for more details, https://pemtk.readthedocs.io</span>
<span class="n">phaseConvention</span><span class="o">=</span><span class="s1">&#39;S&#39;</span>  <span class="c1"># For consistency in the method, explicitly set the</span>
                     <span class="c1"># phase convention used here (&#39;S&#39; = standard, &#39;E&#39; = ePS).</span>
<span class="n">BetaNormX</span><span class="p">,</span> <span class="n">basisProduct</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">afblmMatEfit</span><span class="p">(</span><span class="n">selDims</span><span class="o">=</span><span class="p">{},</span> 
                                            <span class="n">sqThres</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
                                            <span class="n">phaseConvention</span><span class="o">=</span><span class="n">phaseConvention</span><span class="p">)</span>

<span class="c1"># Using ePSproc directly - this includes full basis return if specified</span>
<span class="c1"># See the docs for more details, https://epsproc.readthedocs.io</span>
<span class="n">BetaNormX2</span><span class="p">,</span> <span class="n">basisFull</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">geomFunc</span><span class="o">.</span><span class="n">afblmXprod</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">subKey</span><span class="p">][</span><span class="s1">&#39;matE&#39;</span><span class="p">],</span> 
                                               <span class="n">basisReturn</span> <span class="o">=</span> <span class="s1">&#39;Full&#39;</span><span class="p">,</span> 
                                               <span class="n">thres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">selDims</span><span class="o">=</span><span class="p">{},</span> 
                                               <span class="n">sqThres</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                               <span class="n">phaseConvention</span><span class="o">=</span><span class="n">phaseConvention</span><span class="p">)</span>

<span class="c1"># The basis dictionary contains various numerical parameters, these are investigated below.</span>
<span class="c1"># See also the ePSproc docs at </span>
<span class="c1"># https://epsproc.readthedocs.io/en/latest/methods/geometric_method_dev_260220_090420_tidy.html</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Product basis elements: </span><span class="si">{</span><span class="n">basisProduct</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Full basis elements: </span><span class="si">{</span><span class="n">basisFull</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Use full basis for following sections</span>
<span class="n">basis</span> <span class="o">=</span> <span class="n">basisFull</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = BLM
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;muX&#39;}
Added dim Eke
Added dim P
Added dim T
Added dim C
*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;muX&#39;}
Added dim Eke
Added dim Targ
Added dim Total
Added dim mu
Added dim it
Added dim Type
Product basis elements: dict_keys([&#39;BLMtableResort&#39;, &#39;polProd&#39;, &#39;phaseConvention&#39;, &#39;BLMRenorm&#39;])
Full basis elements: dict_keys([&#39;QNs&#39;, &#39;EPRX&#39;, &#39;lambdaTerm&#39;, &#39;BLMtable&#39;, &#39;BLMtableResort&#39;, &#39;AFterm&#39;, &#39;AKQS&#39;, &#39;polProd&#39;, &#39;phaseConvention&#39;, &#39;BLMRenorm&#39;, &#39;matEmult&#39;])
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrix-element-geometric-coupling-term-b-l-m">
<span id="sec-theory-blm-term"></span><h2><span class="section-number">3.3.5. </span>Matrix element geometric coupling term <span class="math notranslate nohighlight">\(B_{L,M}\)</span><a class="headerlink" href="#matrix-element-geometric-coupling-term-b-l-m" title="Permalink to this heading">#</a></h2>
<p>The coupling of the <a class="reference internal" href="../backmatter/glossary.html#term-partial-waves"><span class="xref std std-term">partial-waves</span></a> as coherent pairs, <span class="math notranslate nohighlight">\(|l,m\rangle\)</span> and <span class="math notranslate nohighlight">\(|l',m'\rangle\)</span>, into the observable set of <span class="math notranslate nohighlight">\(\{L,M\}\)</span> is defined by a tensor contraction with two 3j terms:</p>
<div class="math notranslate nohighlight" id="equation-eq-basis-blm-defn">
<span class="eqno">(3.20)<a class="headerlink" href="#equation-eq-basis-blm-defn" title="Permalink to this equation">#</a></span>\[\begin{split}
B_{L,M}=(-1)^{m}\left(\frac{(2l+1)(2l'+1)(2L+1)}{4\pi}\right)^{1/2}\left(\begin{array}{ccc}
l &amp; l' &amp; L\\
0 &amp; 0 &amp; 0
\end{array}\right)\left(\begin{array}{ccc}
l &amp; l' &amp; L\\
-m &amp; m' &amp; M
\end{array}\right)
\end{split}\]</div>
<p>Note that this term is equivalent, effectively, to a triple integral over spherical harmonics (e.g. Eq. 3.119 in Zare <span id="id23">[<a class="reference internal" href="../backmatter/bibliography.html#id968" title="Richard N Zare. Angular Momentum: Understanding Spatial Aspects in Chemistry and Physics. John Wiley &amp; Sons, 1988.">74</a>]</span>):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
\intop_{0}^{2\pi}\intop_{0}^{\pi}Y_{J_{3}M_{3}}(\theta,\phi)Y_{J_{2}M_{2}}(\theta,\phi)Y_{J_{1}M_{1}}(\theta,\phi)\sin\theta d\theta d\phi &amp; = &amp; \left(\frac{(2J_{1}+1)(2J_{2}+1)(2J_{3}+1)}{4\pi}\right)^{1/2}\\
 &amp; \times &amp; \left(\begin{array}{ccc}
J_{1} &amp; J_{2} &amp; J_{3}\\
0 &amp; 0 &amp; 0
\end{array}\right)\left(\begin{array}{ccc}
J_{1} &amp; J_{2} &amp; J_{3}\\
M_{1} &amp; M_{2} &amp; M_{3}
\end{array}\right)
\end{aligned}
\end{split}\]</div>
<p>And a similar term appears in the contraction over a pair of harmonics into a resultant harmonic (e.g. Eqs. C.21, C.22 in Blum <span id="id24">[<a class="reference internal" href="../backmatter/bibliography.html#id525" title="Karl Blum. Density Matrix Theory and Applications. Volume 64. Springer Berlin Heidelberg, Berlin, Heidelberg, 3rd editio edition, 2012. ISBN 978-3-642-20560-6. URL: http://link.springer.com/10.1007/978-3-642-20561-3.">88</a>]</span>) - this is how the term arises in the derivation of the observables.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
Y_{J_{1}M_{1}}(\theta,\phi)Y_{J_{2}M_{2}}(\theta,\phi) &amp; = &amp; \sum_{J_{3}M_{3}}\left(\frac{(2J_{1}+1)(2J_{2}+1)(2J_{3}+1)}{4\pi}\right)^{1/2}\\
 &amp; \times &amp; \left(\begin{array}{ccc}
J_{1} &amp; J_{2} &amp; J_{3}\\
0 &amp; 0 &amp; 0
\end{array}\right)\left(\begin{array}{ccc}
J_{1} &amp; J_{2} &amp; J_{3}\\
M_{1} &amp; M_{2} &amp; M_{3}
\end{array}\right)Y_{J_{3}M_{3}}^{*}(\theta,\phi)
\end{aligned}
\end{split}\]</div>
<p>Note also some definitions use conjugate spherical harmonics, which can be converted as, e.g., Eq. C.21 in Blum <span id="id25">[<a class="reference internal" href="../backmatter/bibliography.html#id525" title="Karl Blum. Density Matrix Theory and Applications. Volume 64. Springer Berlin Heidelberg, Berlin, Heidelberg, 3rd editio edition, 2012. ISBN 978-3-642-20560-6. URL: http://link.springer.com/10.1007/978-3-642-20561-3.">88</a>]</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-b623d16e-451e-42a9-934c-a03576291169">
<span class="eqno">(3.21)<a class="headerlink" href="#equation-b623d16e-451e-42a9-934c-a03576291169" title="Permalink to this equation">#</a></span>\[\begin{equation}
\beta_{L,M}^{\mu_{i},\mu_{f}}Y_{LM}^{*}(\theta_{\hat{k}},\phi_{\hat{k}})=\beta_{L,-M}^{\mu_{i},\mu_{f}}(-1)^{M}Y_{L,-M}(\theta_{\hat{k}},\phi_{\hat{k}})\label{eq:sph-conj-conv}
\end{equation}\]</div>
<p>In the current <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id26">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span> codebase, the relevant basis item can be inspected as below, in order to illustrate the sensitivity of different <span class="math notranslate nohighlight">\((L,M)\)</span> terms to the matrix element products. In many typical cases, however, this term is restricted to only <span class="math notranslate nohighlight">\(M=0\)</span> components overall by other geometric factors (see below).</p>
<p>The code cells below illustrate this for the current example case, and <a class="reference internal" href="#fig-blm-basis-d2h"><span class="std std-numref">Fig. 3.3</span></a> offers a general summary. In general, this is a convenient way to visualize the selection rules into the observable: for instance, only terms <span class="math notranslate nohighlight">\(l=l'\)</span> and <span class="math notranslate nohighlight">\(m=-m'\)</span> contribute to the overall photoionization cross-section term (<span class="math notranslate nohighlight">\(L=0, M=0\)</span>), and the maximum observable <span class="math notranslate nohighlight">\(L_{max}=2l_{max}\)</span>. However, since these terms are fairly simply followed algebraically in this case, via the rules inherent in the <span class="math notranslate nohighlight">\(3j\)</span> product (Eq. <a class="reference internal" href="#equation-eq-basis-blm-defn">(3.20)</a>), this is not particularly insightful (although useful pedagogically). These visualizations will become more useful when dealing with real sets of matrix elements, and specific polarization geometries, which will further modulate or restrict the <span class="math notranslate nohighlight">\(B_{L,M}\)</span> terms.</p>
<p>Numerically, various standard functions may be used to quickly gain deeper insight, for example min/max, averages etc. Such considerations may provide a quick sanity-check for a given case, and may prove useful when planning experiments to investigate particular aspects or channels of a given system. Other properties of the basis functions may also be interrogated numerically; for instance, correlation maps provide an alternative way to check which terms are strongly correlated or coupled, or will dominate a given aspect of the observable.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Tabulate basis</span>

<span class="n">basisKey</span> <span class="o">=</span> <span class="s1">&#39;BLMtableResort&#39;</span>  <span class="c1"># Key for BLM basis set</span>

<span class="c1"># Reformat basis for display (optional)</span>
<span class="n">stackDims</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LM&#39;</span><span class="p">:[</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">]}</span>
<span class="n">basisPlot</span> <span class="o">=</span> <span class="n">basis</span><span class="p">[</span><span class="n">basisKey</span><span class="p">]</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;S-Rp&#39;</span><span class="p">:</span><span class="s1">&#39;M&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">stackDims</span><span class="p">)</span>

<span class="c1"># Convert to Pandas, use ep.multiDimXrToPD as a general multi-dimensional restacker</span>
<span class="n">pd</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">multiDimXrToPD</span><span class="p">(</span><span class="n">basisPlot</span><span class="p">,</span> <span class="n">colDims</span><span class="o">=</span><span class="n">stackDims</span><span class="p">)</span>

<span class="c1"># Summarise properties and tabulate via Pandas Describe</span>
<span class="n">pd</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>count</th>
      <th>mean</th>
      <th>std</th>
      <th>min</th>
      <th>25%</th>
      <th>50%</th>
      <th>75%</th>
      <th>max</th>
    </tr>
    <tr>
      <th>L</th>
      <th>M</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>25.0</td>
      <td>0.011</td>
      <td>2.877e-01</td>
      <td>-0.282</td>
      <td>-0.282</td>
      <td>0.282</td>
      <td>0.282</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>1</th>
      <td>32.0</td>
      <td>0.005</td>
      <td>2.265e-01</td>
      <td>-0.326</td>
      <td>-0.173</td>
      <td>0.011</td>
      <td>0.206</td>
      <td>0.320</td>
    </tr>
    <tr>
      <th>0</th>
      <td>32.0</td>
      <td>0.007</td>
      <td>2.265e-01</td>
      <td>-0.238</td>
      <td>-0.222</td>
      <td>0.011</td>
      <td>0.221</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>32.0</td>
      <td>0.005</td>
      <td>2.265e-01</td>
      <td>-0.326</td>
      <td>-0.173</td>
      <td>0.011</td>
      <td>0.206</td>
      <td>0.320</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2</th>
      <th>2</th>
      <td>34.0</td>
      <td>0.021</td>
      <td>2.047e-01</td>
      <td>-0.320</td>
      <td>-0.180</td>
      <td>0.040</td>
      <td>0.185</td>
      <td>0.337</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>0.018</td>
      <td>1.935e-01</td>
      <td>-0.261</td>
      <td>-0.162</td>
      <td>0.059</td>
      <td>0.216</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>0</th>
      <td>42.0</td>
      <td>0.015</td>
      <td>1.841e-01</td>
      <td>-0.229</td>
      <td>-0.180</td>
      <td>0.057</td>
      <td>0.167</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>38.0</td>
      <td>0.018</td>
      <td>1.935e-01</td>
      <td>-0.261</td>
      <td>-0.162</td>
      <td>0.059</td>
      <td>0.216</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>34.0</td>
      <td>0.021</td>
      <td>2.047e-01</td>
      <td>-0.320</td>
      <td>-0.180</td>
      <td>0.040</td>
      <td>0.185</td>
      <td>0.337</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">3</th>
      <th>3</th>
      <td>26.0</td>
      <td>0.026</td>
      <td>2.090e-01</td>
      <td>-0.326</td>
      <td>-0.140</td>
      <td>0.077</td>
      <td>0.188</td>
      <td>0.320</td>
    </tr>
    <tr>
      <th>2</th>
      <td>32.0</td>
      <td>0.031</td>
      <td>1.865e-01</td>
      <td>-0.282</td>
      <td>-0.125</td>
      <td>0.070</td>
      <td>0.192</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>1</th>
      <td>38.0</td>
      <td>0.032</td>
      <td>1.701e-01</td>
      <td>-0.238</td>
      <td>-0.149</td>
      <td>0.083</td>
      <td>0.183</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>0</th>
      <td>38.0</td>
      <td>0.033</td>
      <td>1.700e-01</td>
      <td>-0.195</td>
      <td>-0.099</td>
      <td>-0.044</td>
      <td>0.195</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>38.0</td>
      <td>0.032</td>
      <td>1.701e-01</td>
      <td>-0.238</td>
      <td>-0.149</td>
      <td>0.083</td>
      <td>0.183</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>32.0</td>
      <td>0.031</td>
      <td>1.865e-01</td>
      <td>-0.282</td>
      <td>-0.125</td>
      <td>0.070</td>
      <td>0.192</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>26.0</td>
      <td>0.026</td>
      <td>2.090e-01</td>
      <td>-0.326</td>
      <td>-0.140</td>
      <td>0.077</td>
      <td>0.188</td>
      <td>0.320</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">4</th>
      <th>4</th>
      <td>19.0</td>
      <td>0.065</td>
      <td>2.147e-01</td>
      <td>-0.229</td>
      <td>-0.166</td>
      <td>0.107</td>
      <td>0.248</td>
      <td>0.337</td>
    </tr>
    <tr>
      <th>3</th>
      <td>26.0</td>
      <td>0.054</td>
      <td>1.825e-01</td>
      <td>-0.204</td>
      <td>-0.159</td>
      <td>0.096</td>
      <td>0.188</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>2</th>
      <td>33.0</td>
      <td>0.046</td>
      <td>1.621e-01</td>
      <td>-0.190</td>
      <td>-0.084</td>
      <td>0.066</td>
      <td>0.191</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>1</th>
      <td>36.0</td>
      <td>0.044</td>
      <td>1.547e-01</td>
      <td>-0.201</td>
      <td>-0.140</td>
      <td>0.079</td>
      <td>0.168</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>0</th>
      <td>39.0</td>
      <td>0.042</td>
      <td>1.486e-01</td>
      <td>-0.190</td>
      <td>-0.073</td>
      <td>0.040</td>
      <td>0.160</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>36.0</td>
      <td>0.044</td>
      <td>1.547e-01</td>
      <td>-0.201</td>
      <td>-0.140</td>
      <td>0.079</td>
      <td>0.168</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>33.0</td>
      <td>0.046</td>
      <td>1.621e-01</td>
      <td>-0.190</td>
      <td>-0.084</td>
      <td>0.066</td>
      <td>0.191</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>26.0</td>
      <td>0.054</td>
      <td>1.825e-01</td>
      <td>-0.204</td>
      <td>-0.159</td>
      <td>0.096</td>
      <td>0.188</td>
      <td>0.282</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>19.0</td>
      <td>0.065</td>
      <td>2.147e-01</td>
      <td>-0.229</td>
      <td>-0.166</td>
      <td>0.107</td>
      <td>0.248</td>
      <td>0.337</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">5</th>
      <th>5</th>
      <td>10.0</td>
      <td>0.112</td>
      <td>2.433e-01</td>
      <td>-0.190</td>
      <td>-0.139</td>
      <td>0.212</td>
      <td>0.329</td>
      <td>0.347</td>
    </tr>
    <tr>
      <th>4</th>
      <td>16.0</td>
      <td>0.090</td>
      <td>1.876e-01</td>
      <td>-0.208</td>
      <td>-0.015</td>
      <td>0.145</td>
      <td>0.232</td>
      <td>0.295</td>
    </tr>
    <tr>
      <th>3</th>
      <td>22.0</td>
      <td>0.072</td>
      <td>1.608e-01</td>
      <td>-0.196</td>
      <td>-0.069</td>
      <td>0.127</td>
      <td>0.199</td>
      <td>0.260</td>
    </tr>
    <tr>
      <th>2</th>
      <td>26.0</td>
      <td>0.063</td>
      <td>1.490e-01</td>
      <td>-0.179</td>
      <td>-0.065</td>
      <td>0.085</td>
      <td>0.190</td>
      <td>0.246</td>
    </tr>
    <tr>
      <th>1</th>
      <td>30.0</td>
      <td>0.055</td>
      <td>1.398e-01</td>
      <td>-0.161</td>
      <td>-0.092</td>
      <td>0.093</td>
      <td>0.173</td>
      <td>0.241</td>
    </tr>
    <tr>
      <th>0</th>
      <td>30.0</td>
      <td>0.055</td>
      <td>1.397e-01</td>
      <td>-0.171</td>
      <td>-0.076</td>
      <td>0.054</td>
      <td>0.166</td>
      <td>0.246</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>30.0</td>
      <td>0.055</td>
      <td>1.398e-01</td>
      <td>-0.161</td>
      <td>-0.092</td>
      <td>0.093</td>
      <td>0.173</td>
      <td>0.241</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>26.0</td>
      <td>0.063</td>
      <td>1.490e-01</td>
      <td>-0.179</td>
      <td>-0.065</td>
      <td>0.085</td>
      <td>0.190</td>
      <td>0.246</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>22.0</td>
      <td>0.072</td>
      <td>1.608e-01</td>
      <td>-0.196</td>
      <td>-0.069</td>
      <td>0.127</td>
      <td>0.199</td>
      <td>0.260</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>16.0</td>
      <td>0.090</td>
      <td>1.876e-01</td>
      <td>-0.208</td>
      <td>-0.015</td>
      <td>0.145</td>
      <td>0.232</td>
      <td>0.295</td>
    </tr>
    <tr>
      <th>-5</th>
      <td>10.0</td>
      <td>0.112</td>
      <td>2.433e-01</td>
      <td>-0.190</td>
      <td>-0.139</td>
      <td>0.212</td>
      <td>0.329</td>
      <td>0.347</td>
    </tr>
    <tr>
      <th rowspan="13" valign="top">6</th>
      <th>6</th>
      <td>6.0</td>
      <td>0.160</td>
      <td>2.560e-01</td>
      <td>-0.163</td>
      <td>-0.069</td>
      <td>0.285</td>
      <td>0.354</td>
      <td>0.360</td>
    </tr>
    <tr>
      <th>5</th>
      <td>10.0</td>
      <td>0.130</td>
      <td>1.863e-01</td>
      <td>-0.200</td>
      <td>0.100</td>
      <td>0.204</td>
      <td>0.255</td>
      <td>0.289</td>
    </tr>
    <tr>
      <th>4</th>
      <td>14.0</td>
      <td>0.107</td>
      <td>1.571e-01</td>
      <td>-0.191</td>
      <td>0.004</td>
      <td>0.166</td>
      <td>0.230</td>
      <td>0.266</td>
    </tr>
    <tr>
      <th>3</th>
      <td>18.0</td>
      <td>0.090</td>
      <td>1.405e-01</td>
      <td>-0.156</td>
      <td>0.048</td>
      <td>0.109</td>
      <td>0.179</td>
      <td>0.252</td>
    </tr>
    <tr>
      <th>2</th>
      <td>22.0</td>
      <td>0.077</td>
      <td>1.294e-01</td>
      <td>-0.165</td>
      <td>0.004</td>
      <td>0.090</td>
      <td>0.177</td>
      <td>0.243</td>
    </tr>
    <tr>
      <th>1</th>
      <td>24.0</td>
      <td>0.072</td>
      <td>1.247e-01</td>
      <td>-0.160</td>
      <td>0.007</td>
      <td>0.099</td>
      <td>0.152</td>
      <td>0.230</td>
    </tr>
    <tr>
      <th>0</th>
      <td>26.0</td>
      <td>0.066</td>
      <td>1.210e-01</td>
      <td>-0.156</td>
      <td>0.007</td>
      <td>0.062</td>
      <td>0.174</td>
      <td>0.239</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>24.0</td>
      <td>0.072</td>
      <td>1.247e-01</td>
      <td>-0.160</td>
      <td>0.007</td>
      <td>0.099</td>
      <td>0.152</td>
      <td>0.230</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>22.0</td>
      <td>0.077</td>
      <td>1.294e-01</td>
      <td>-0.165</td>
      <td>0.004</td>
      <td>0.090</td>
      <td>0.177</td>
      <td>0.243</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>18.0</td>
      <td>0.090</td>
      <td>1.405e-01</td>
      <td>-0.156</td>
      <td>0.048</td>
      <td>0.109</td>
      <td>0.179</td>
      <td>0.252</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>14.0</td>
      <td>0.107</td>
      <td>1.571e-01</td>
      <td>-0.191</td>
      <td>0.004</td>
      <td>0.166</td>
      <td>0.230</td>
      <td>0.266</td>
    </tr>
    <tr>
      <th>-5</th>
      <td>10.0</td>
      <td>0.130</td>
      <td>1.863e-01</td>
      <td>-0.200</td>
      <td>0.100</td>
      <td>0.204</td>
      <td>0.255</td>
      <td>0.289</td>
    </tr>
    <tr>
      <th>-6</th>
      <td>6.0</td>
      <td>0.160</td>
      <td>2.560e-01</td>
      <td>-0.163</td>
      <td>-0.069</td>
      <td>0.285</td>
      <td>0.354</td>
      <td>0.360</td>
    </tr>
    <tr>
      <th rowspan="15" valign="top">7</th>
      <th>7</th>
      <td>2.0</td>
      <td>0.369</td>
      <td>0.000e+00</td>
      <td>0.369</td>
      <td>0.369</td>
      <td>0.369</td>
      <td>0.369</td>
      <td>0.369</td>
    </tr>
    <tr>
      <th>6</th>
      <td>4.0</td>
      <td>0.260</td>
      <td>2.159e-02</td>
      <td>0.242</td>
      <td>0.242</td>
      <td>0.260</td>
      <td>0.279</td>
      <td>0.279</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6.0</td>
      <td>0.208</td>
      <td>5.293e-02</td>
      <td>0.150</td>
      <td>0.164</td>
      <td>0.205</td>
      <td>0.252</td>
      <td>0.268</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.0</td>
      <td>0.174</td>
      <td>6.729e-02</td>
      <td>0.087</td>
      <td>0.130</td>
      <td>0.178</td>
      <td>0.222</td>
      <td>0.251</td>
    </tr>
    <tr>
      <th>3</th>
      <td>10.0</td>
      <td>0.149</td>
      <td>7.566e-02</td>
      <td>0.045</td>
      <td>0.098</td>
      <td>0.148</td>
      <td>0.214</td>
      <td>0.239</td>
    </tr>
    <tr>
      <th>2</th>
      <td>12.0</td>
      <td>0.129</td>
      <td>8.089e-02</td>
      <td>0.020</td>
      <td>0.062</td>
      <td>0.130</td>
      <td>0.195</td>
      <td>0.239</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14.0</td>
      <td>0.114</td>
      <td>8.427e-02</td>
      <td>0.007</td>
      <td>0.038</td>
      <td>0.124</td>
      <td>0.198</td>
      <td>0.225</td>
    </tr>
    <tr>
      <th>0</th>
      <td>14.0</td>
      <td>0.114</td>
      <td>8.308e-02</td>
      <td>0.018</td>
      <td>0.034</td>
      <td>0.082</td>
      <td>0.183</td>
      <td>0.236</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>14.0</td>
      <td>0.114</td>
      <td>8.427e-02</td>
      <td>0.007</td>
      <td>0.038</td>
      <td>0.124</td>
      <td>0.198</td>
      <td>0.225</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>12.0</td>
      <td>0.129</td>
      <td>8.089e-02</td>
      <td>0.020</td>
      <td>0.062</td>
      <td>0.130</td>
      <td>0.195</td>
      <td>0.239</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>10.0</td>
      <td>0.149</td>
      <td>7.566e-02</td>
      <td>0.045</td>
      <td>0.098</td>
      <td>0.148</td>
      <td>0.214</td>
      <td>0.239</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>8.0</td>
      <td>0.174</td>
      <td>6.729e-02</td>
      <td>0.087</td>
      <td>0.130</td>
      <td>0.178</td>
      <td>0.222</td>
      <td>0.251</td>
    </tr>
    <tr>
      <th>-5</th>
      <td>6.0</td>
      <td>0.208</td>
      <td>5.293e-02</td>
      <td>0.150</td>
      <td>0.164</td>
      <td>0.205</td>
      <td>0.252</td>
      <td>0.268</td>
    </tr>
    <tr>
      <th>-6</th>
      <td>4.0</td>
      <td>0.260</td>
      <td>2.159e-02</td>
      <td>0.242</td>
      <td>0.242</td>
      <td>0.260</td>
      <td>0.279</td>
      <td>0.279</td>
    </tr>
    <tr>
      <th>-7</th>
      <td>2.0</td>
      <td>0.369</td>
      <td>0.000e+00</td>
      <td>0.369</td>
      <td>0.369</td>
      <td>0.369</td>
      <td>0.369</td>
      <td>0.369</td>
    </tr>
    <tr>
      <th rowspan="17" valign="top">8</th>
      <th>8</th>
      <td>1.0</td>
      <td>0.380</td>
      <td>NaN</td>
      <td>0.380</td>
      <td>0.380</td>
      <td>0.380</td>
      <td>0.380</td>
      <td>0.380</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2.0</td>
      <td>0.269</td>
      <td>5.551e-17</td>
      <td>0.269</td>
      <td>0.269</td>
      <td>0.269</td>
      <td>0.269</td>
      <td>0.269</td>
    </tr>
    <tr>
      <th>6</th>
      <td>3.0</td>
      <td>0.215</td>
      <td>5.424e-02</td>
      <td>0.184</td>
      <td>0.184</td>
      <td>0.184</td>
      <td>0.231</td>
      <td>0.277</td>
    </tr>
    <tr>
      <th>5</th>
      <td>4.0</td>
      <td>0.180</td>
      <td>6.937e-02</td>
      <td>0.120</td>
      <td>0.120</td>
      <td>0.180</td>
      <td>0.240</td>
      <td>0.240</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>0.155</td>
      <td>7.763e-02</td>
      <td>0.075</td>
      <td>0.075</td>
      <td>0.189</td>
      <td>0.189</td>
      <td>0.249</td>
    </tr>
    <tr>
      <th>3</th>
      <td>6.0</td>
      <td>0.136</td>
      <td>8.257e-02</td>
      <td>0.043</td>
      <td>0.066</td>
      <td>0.136</td>
      <td>0.205</td>
      <td>0.228</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.0</td>
      <td>0.120</td>
      <td>8.559e-02</td>
      <td>0.022</td>
      <td>0.056</td>
      <td>0.090</td>
      <td>0.188</td>
      <td>0.238</td>
    </tr>
    <tr>
      <th>1</th>
      <td>8.0</td>
      <td>0.107</td>
      <td>8.742e-02</td>
      <td>0.010</td>
      <td>0.042</td>
      <td>0.097</td>
      <td>0.161</td>
      <td>0.222</td>
    </tr>
    <tr>
      <th>0</th>
      <td>9.0</td>
      <td>0.095</td>
      <td>8.852e-02</td>
      <td>0.003</td>
      <td>0.027</td>
      <td>0.094</td>
      <td>0.188</td>
      <td>0.234</td>
    </tr>
    <tr>
      <th>-1</th>
      <td>8.0</td>
      <td>0.107</td>
      <td>8.742e-02</td>
      <td>0.010</td>
      <td>0.042</td>
      <td>0.097</td>
      <td>0.161</td>
      <td>0.222</td>
    </tr>
    <tr>
      <th>-2</th>
      <td>7.0</td>
      <td>0.120</td>
      <td>8.559e-02</td>
      <td>0.022</td>
      <td>0.056</td>
      <td>0.090</td>
      <td>0.188</td>
      <td>0.238</td>
    </tr>
    <tr>
      <th>-3</th>
      <td>6.0</td>
      <td>0.136</td>
      <td>8.257e-02</td>
      <td>0.043</td>
      <td>0.066</td>
      <td>0.136</td>
      <td>0.205</td>
      <td>0.228</td>
    </tr>
    <tr>
      <th>-4</th>
      <td>5.0</td>
      <td>0.155</td>
      <td>7.763e-02</td>
      <td>0.075</td>
      <td>0.075</td>
      <td>0.189</td>
      <td>0.189</td>
      <td>0.249</td>
    </tr>
    <tr>
      <th>-5</th>
      <td>4.0</td>
      <td>0.180</td>
      <td>6.937e-02</td>
      <td>0.120</td>
      <td>0.120</td>
      <td>0.180</td>
      <td>0.240</td>
      <td>0.240</td>
    </tr>
    <tr>
      <th>-6</th>
      <td>3.0</td>
      <td>0.215</td>
      <td>5.424e-02</td>
      <td>0.184</td>
      <td>0.184</td>
      <td>0.184</td>
      <td>0.231</td>
      <td>0.277</td>
    </tr>
    <tr>
      <th>-7</th>
      <td>2.0</td>
      <td>0.269</td>
      <td>5.551e-17</td>
      <td>0.269</td>
      <td>0.269</td>
      <td>0.269</td>
      <td>0.269</td>
      <td>0.269</td>
    </tr>
    <tr>
      <th>-8</th>
      <td>1.0</td>
      <td>0.380</td>
      <td>NaN</td>
      <td>0.380</td>
      <td>0.380</td>
      <td>0.380</td>
      <td>0.380</td>
      <td>0.380</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Plot BLM terms for basis set - basic case</span>
<span class="n">basisKey</span> <span class="o">=</span> <span class="s1">&#39;BLMtableResort&#39;</span>

<span class="c1"># Basic plot</span>
<span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">basisPlot</span><span class="p">,</span> <span class="n">xDim</span><span class="o">=</span><span class="n">stackDims</span><span class="p">);</span>  <span class="c1"># Basic plot with all terms</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plotting data (No filename), pType=a, thres=0.01, with Seaborn
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
<img alt="../_images/cdf86aeb7d86efecc54c604c6933cc96b876f781f4c07e31f65682785ae8abd5.png" src="../_images/cdf86aeb7d86efecc54c604c6933cc96b876f781f4c07e31f65682785ae8abd5.png" />
</div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Plot BLM terms for basis set - plot with some additional figure formatting options</span>

<span class="c1"># Formatting options</span>
<span class="n">titleString</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$B_</span><span class="se">{{</span><span class="s1">L,M</span><span class="se">}}</span><span class="s1">$ terms for </span><span class="si">{</span><span class="n">sym</span><span class="si">}</span><span class="s1">, lmax=</span><span class="si">{</span><span class="n">lmaxPlot</span><span class="si">}</span><span class="s1">&#39;</span>
<span class="n">titleDetails</span><span class="o">=</span><span class="kc">True</span>
<span class="n">labelRound</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">catLegend</span><span class="o">=</span><span class="kc">False</span>
<span class="n">labelCols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># cmap = None for default.</span>
<span class="c1"># cmap = &#39;vlag&#39;</span>

<span class="c1"># lmPlot with various options</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">basisPlot</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">basisPlot</span><span class="o">.</span><span class="n">l</span><span class="o">&lt;=</span><span class="n">lmaxPlot</span><span class="p">)</span> 
                        <span class="o">&amp;</span> <span class="p">(</span><span class="n">basisPlot</span><span class="o">.</span><span class="n">lp</span><span class="o">&lt;=</span><span class="n">lmaxPlot</span><span class="p">)),</span> 
                       <span class="n">xDim</span><span class="o">=</span><span class="n">stackDims</span><span class="p">,</span> <span class="n">pType</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> 
                       <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">labelRound</span> <span class="o">=</span> <span class="n">labelRound</span><span class="p">,</span> 
                       <span class="n">catLegend</span><span class="o">=</span><span class="n">catLegend</span><span class="p">,</span> 
                       <span class="n">titleString</span><span class="o">=</span><span class="n">titleString</span><span class="p">,</span> <span class="n">titleDetails</span><span class="o">=</span><span class="n">titleDetails</span><span class="p">,</span> 
                       <span class="n">labelCols</span> <span class="o">=</span> <span class="n">labelCols</span><span class="p">);</span>

<span class="c1"># Glue figure</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;lmPlot_BLM_basis_D2h&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plotting data (No filename), pType=r, thres=0.01, with Seaborn
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-blm-basis-d2h">
<img alt="../_images/1a70c9da2b5175d1dafa3f01e0fcd8393d208c491421f863c9432dea5252a0da.png" src="../_images/1a70c9da2b5175d1dafa3f01e0fcd8393d208c491421f863c9432dea5252a0da.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.3 </span><span class="caption-text">Example <span class="math notranslate nohighlight">\(B_{L,M}\)</span> basis functions for <span class="pasted-text">D2h</span> symmetry. Note figure is truncated to <span class="math notranslate nohighlight">\(l_{max}=l'_{max}=\)</span><span class="pasted-text">2</span> for clarity.</span><a class="headerlink" href="#fig-blm-basis-d2h" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="electric-field-geometric-coupling-term-e-p-r-hat-e-mu-0">
<span id="sec-theory-epr-term"></span><h2><span class="section-number">3.3.6. </span>Electric field geometric coupling term <span class="math notranslate nohighlight">\({E_{P,R}(\hat{e};\mu_{0})}\)</span><a class="headerlink" href="#electric-field-geometric-coupling-term-e-p-r-hat-e-mu-0" title="Permalink to this heading">#</a></h2>
<p>The coupling of two 1-photon terms (which arises in the square of the ionization matrix element as per Eq. <a class="reference internal" href="theory_photoionization_dynamics_140723.html#equation-eq-i-reduced-lf-2-45-vol1">(3.9)</a>) can be written as a tensor contraction:</p>
<div class="math notranslate nohighlight" id="equation-eq-epr-defn-1">
<span class="eqno">(3.22)<a class="headerlink" href="#equation-eq-epr-defn-1" title="Permalink to this equation">#</a></span>\[\begin{split}
E_{P,R}(\hat{e})=[e\otimes e^{*}]_{R}^{P}=[P]^{\frac{1}{2}}\sum_{p}(-1)^{R}\left(\begin{array}{ccc}
1 &amp; 1 &amp; P\\
p &amp; R-p &amp; -R
\end{array}\right)e_{p}e_{R-p}^{*}
\end{split}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(e_{p}\)</span> and <span class="math notranslate nohighlight">\(e_{R-p}\)</span> define the field strengths for the polarizations <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(R-p\)</span>, which are coupled into the spherical tensor <span class="math notranslate nohighlight">\(E_{PR}\)</span>;</p></li>
<li><p>square-brackets indicate degeneracy terms, e.g. <span class="math notranslate nohighlight">\([P]^{\frac{1}{2}} = (2P+1)^{\frac{1}{2}}\)</span>;</p></li>
<li><p>in the literature <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> field projection terms are usually denoted <span class="math notranslate nohighlight">\(p\)</span> (as above) or <span class="math notranslate nohighlight">\(\mu_0\)</span> (used as a more general angular-momentum projection notation). For the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> case photon projection terms are usually denoted by <span class="math notranslate nohighlight">\(q\)</span> or <span class="math notranslate nohighlight">\(\mu\)</span>.</p></li>
<li><p>The polarization vector or propagation direction is usually chosen to define the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> z-axis for linear or non-linearly polarized light respectively (see <a class="reference internal" href="main_intro_060723.html#fig-bootstrap-concept-outline"><span class="std std-numref">Fig. 1.1</span></a> for the linear example), or defined relative to the molecular symmetry axis in the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>. (See <a class="reference internal" href="#sec-frame-definitions"><span class="std std-numref">Sect. 3.3.3</span></a> for further details.)</p></li>
<li><p>For a given case the polarization geometry may define a single projection term, or there may be multiple terms allowed. For instance, linearly polarized light is defined by <span class="math notranslate nohighlight">\(\mu_0=0\)</span> only, resulting in non-zero values for just the <span class="math notranslate nohighlight">\(P=0,2\)</span> terms in Eq. <a class="reference internal" href="#equation-eq-epr-defn-1">(3.22)</a>, i.e. product terms <span class="math notranslate nohighlight">\(E_{0,0}, E_{2,0}\)</span> are allowed. Non-linearly polarized light may contain all allowed components (<span class="math notranslate nohighlight">\(\mu_0=-1,0,1\)</span>). For the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> case, allowed components may be defined directly in the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> or determined via a frame transformation from the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> - see <a class="reference internal" href="#sec-theory-lambda-term"><span class="std std-numref">Sect. 3.3.7</span></a>.</p></li>
<li><p>Note this notation implicitly describes only the time-independent photon angular momentum coupling, but time-dependent/shaped laser fields can be readily incorporated by allowing for time-dependent fields <span class="math notranslate nohighlight">\(e_{p}(t)\)</span> (see, for instance, Ref. \cite{hockett2015CompletePhotoionizationExperiments}). (Support for this is planned in <a class="reference external" href="https://github.com/phockett/ePSproc">ePSproc</a> <span id="id27">[<a class="reference internal" href="../backmatter/bibliography.html#id597" title="Paul Hockett. ePSproc: Post-processing for ePolyScat (Github repository). Github, 2016. URL: https://github.com/phockett/ePSproc.">25</a>]</span>, as of v1.3.2 this is in the development and testing phase.)</p></li>
</ul>
<p>To derive this result, one can start from a general spherical tensor direct product, e.g., Eq. 5.36 in Zare <span id="id28">[<a class="reference internal" href="../backmatter/bibliography.html#id968" title="Richard N Zare. Angular Momentum: Understanding Spatial Aspects in Chemistry and Physics. John Wiley &amp; Sons, 1988.">74</a>]</span>; for two first-rank tensors (e.g. electric field vectors) this contraction is given explicitly by Eq. 5.40 in Zare <span id="id29">[<a class="reference internal" href="../backmatter/bibliography.html#id968" title="Richard N Zare. Angular Momentum: Understanding Spatial Aspects in Chemistry and Physics. John Wiley &amp; Sons, 1988.">74</a>]</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-bcf9bbdd-91d3-4ceb-9991-0e2555e80fc0">
<span class="eqno">(3.23)<a class="headerlink" href="#equation-bcf9bbdd-91d3-4ceb-9991-0e2555e80fc0" title="Permalink to this equation">#</a></span>\[\begin{equation}
[A^{(1)}\otimes B^{(1)}]_{q}^{k}=\sum_{m}\langle1m,1q-m|kq\rangle A(1,m)B(1,q-m)
\end{equation}\]</div>
<p>Convert to <span class="math notranslate nohighlight">\(3j\)</span> form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f171b33b-fc31-4f89-b66c-acb6d7650205">
<span class="eqno">(3.24)<a class="headerlink" href="#equation-f171b33b-fc31-4f89-b66c-acb6d7650205" title="Permalink to this equation">#</a></span>\[\begin{equation}
[A^{(1)}\otimes B^{(1)}]_{q}^{k}=\sum_{m}(-1)^{q}[k]^{1/2}\left(\begin{array}{ccc}
1 &amp; 1 &amp; k\\
m &amp; q-m &amp; -q
\end{array}\right)A(1,m)B(1,q-m)
\end{equation}\]</div>
<p>And substitute in appropriate terms.</p>
<p>As before, we can visualise these values with the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id30">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span>.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** For illustration, recompute EPR term for default case.</span>
<span class="n">EPRX</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">geomCalc</span><span class="o">.</span><span class="n">EPR</span><span class="p">(</span><span class="n">form</span> <span class="o">=</span> <span class="s1">&#39;xarray&#39;</span><span class="p">)</span>

<span class="c1"># Set parameters to restack the Xarray into (L,M) pairs</span>
<span class="n">plotDimsRed</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;p&#39;</span><span class="p">,</span> <span class="s1">&#39;R-p&#39;</span><span class="p">]</span>
<span class="n">xDim</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PR&#39;</span><span class="p">:[</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">]}</span>

<span class="c1"># Plot with ep.lmPlot(), real values</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">EPRX</span><span class="p">,</span> <span class="n">plotDims</span><span class="o">=</span><span class="n">plotDimsRed</span><span class="p">,</span> <span class="n">xDim</span><span class="o">=</span><span class="n">xDim</span><span class="p">,</span> 
                     <span class="n">pType</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> 
                     <span class="n">titleString</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$E_</span><span class="se">{{</span><span class="s1">P,R</span><span class="se">}}</span><span class="s1">$ terms (all cases).&#39;</span><span class="p">,</span>
                     <span class="n">labelCols</span> <span class="o">=</span> <span class="n">labelCols</span><span class="p">)</span>

<span class="c1"># Alternative version summed over l,l&#39;,m</span>
<span class="c1"># *_, gFig = ep.lmPlot(EPRX.unstack().sum([&#39;l&#39;,&#39;lp&#39;,&#39;R-p&#39;]), xDim=xDim, pType = &#39;r&#39;)</span>

<span class="c1"># Glue figure</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;lmPlot_EPR_basis&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plotting data (No filename), pType=r, thres=0.01, with Seaborn
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-epr-basis">
<img alt="../_images/80f09ffaf7bd2b91ed3143103d8f1aedc9b508eb9bad2ea77f7d2e5c6499e037.png" src="../_images/80f09ffaf7bd2b91ed3143103d8f1aedc9b508eb9bad2ea77f7d2e5c6499e037.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.4 </span><span class="caption-text">Example <span class="math notranslate nohighlight">\(E_{P,R}\)</span> basis functions. Note that for linearly polarised light <span class="math notranslate nohighlight">\(p=R-p=0\)</span> only, hence only the terms <span class="math notranslate nohighlight">\(E_{0,0}\)</span> and <span class="math notranslate nohighlight">\(E_{2,0}\)</span> are non-zero in this case. For non-linearly polarised cases many other terms are allowed.</span><a class="headerlink" href="#fig-epr-basis" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="molecular-frame-projection-term-lambda">
<span id="sec-theory-lambda-term"></span><h2><span class="section-number">3.3.7. </span>Molecular frame projection term <span class="math notranslate nohighlight">\(\Lambda\)</span><a class="headerlink" href="#molecular-frame-projection-term-lambda" title="Permalink to this heading">#</a></h2>
<p>For the molecular frame case, the coupling between the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> and <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> can be defined by a projection term, <span class="math notranslate nohighlight">\(\Lambda_{R',R}(R_{\hat{n}})\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-basis-lambda-mf-defn">
<span class="eqno">(3.25)<a class="headerlink" href="#equation-eq-basis-lambda-mf-defn" title="Permalink to this equation">#</a></span>\[\begin{split}
\Lambda_{R',R}(R_{\hat{n}})=(-1)^{(R')}\left(\begin{array}{ccc}
1 &amp; 1 &amp; P\\
\mu &amp; -\mu' &amp; R'
\end{array}\right)D_{-R',-R}^{P}(R_{\hat{n}})
\end{split}\]</div>
<p>This is similar to the <span class="math notranslate nohighlight">\(E_{P,R}\)</span> term, and essentially rotates it into the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>, defining the projections of the polarization vector (photon angular momentum) <span class="math notranslate nohighlight">\(\mu\)</span> into the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> for a given molecular orientation (<a class="reference internal" href="../backmatter/glossary.html#term-frame-rotation"><span class="xref std std-term">frame rotation</span></a>) defined by a set of rotations. The <a class="reference internal" href="../backmatter/glossary.html#term-frame-rotation"><span class="xref std std-term">frame rotation</span></a> is parameterized by a set of <a class="reference internal" href="../backmatter/glossary.html#term-Euler-angles"><span class="xref std std-term">Euler angles</span></a>, <span class="math notranslate nohighlight">\(R_{\hat{n}}=\{\chi,\Theta,\Phi\}\)</span>, with projections given by <a class="reference internal" href="../backmatter/glossary.html#term-Wigner-rotation-matrix-elements"><span class="xref std std-term">Wigner rotation matrix elements</span></a> <span class="math notranslate nohighlight">\(D_{-R',-R}^{P}(R_{\hat{n}})\)</span>.</p>
<p>For the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> case, the same term appears but in a simplified form:</p>
<div class="math notranslate nohighlight" id="equation-eq-basis-lambda-lf-defn">
<span class="eqno">(3.26)<a class="headerlink" href="#equation-eq-basis-lambda-lf-defn" title="Permalink to this equation">#</a></span>\[\begin{split}
\bar{\Lambda}_{R'}=(-1)^{(R')}\left(\begin{array}{ccc}
1 &amp; 1 &amp; P\\
\mu &amp; -\mu' &amp; R'
\end{array}\right)\equiv\Lambda_{R',R'}(R_{\hat{n}}=0)
\end{split}\]</div>
<p>This form pertains since - in the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> case - there is no specific frame transformation defined (i.e. there is no single molecular orientation defined in relation to the light polarization, rather a distribution as defined by the <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a>), but the total angular momentum coupling of the photon terms is still required in the equations.</p>
<p>Numerically, the function is calculated for a specified set of orientations, which default to the standard set of <span class="math notranslate nohighlight">\((x,y,z)\)</span> <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> polarization cases in the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id31">[<a class="reference internal" href="../backmatter/bibliography.html#id668" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">3</a>]</span> routines. For the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> case, this term is still used, but restricted to <span class="math notranslate nohighlight">\(R_{\hat{n}} = (0,0,0) = z\)</span>, i.e. no frame rotation relative to the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> <span class="math notranslate nohighlight">\(E_{P,R}\)</span> definition. In some cases additional frame transformations may be required here to define, e.g., the use of the propagation axis as the reference <span class="math notranslate nohighlight">\(z\)</span>-axis for circularly or elliptically polarized light. (See <a class="reference internal" href="#sec-frame-definitions"><span class="std std-numref">Sect. 3.3.3</span></a> for further discussion.)</p>
</section>
<section id="alignment-tensor-delta-l-m-k-q-s">
<span id="sec-theory-af-alignment-term"></span><h2><span class="section-number">3.3.8. </span>Alignment tensor <span class="math notranslate nohighlight">\(\Delta_{L,M}(K,Q,S)\)</span><a class="headerlink" href="#alignment-tensor-delta-l-m-k-q-s" title="Permalink to this heading">#</a></h2>
<p>Finally, for the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>/<a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> case, the alignment tensor couples the molecular axis ensemble (defined as a set of <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a>, see <a class="reference internal" href="theory_molecular_alignment_170723.html#sect-theory-alignment"><span class="std std-numref">Sect. 3.5</span></a> for details) and the photoionization multipole terms into the final observable.</p>
<div class="math notranslate nohighlight" id="equation-eq-basis-alignmenttensor-defn">
<span class="eqno">(3.27)<a class="headerlink" href="#equation-eq-basis-alignmenttensor-defn" title="Permalink to this equation">#</a></span>\[\begin{split}
\Delta_{L,M}(K,Q,S)=(2K+1)^{1/2}(-1)^{K+Q}\left(\begin{array}{ccc}
P &amp; K &amp; L\\
R &amp; -Q &amp; -M
\end{array}\right)\left(\begin{array}{ccc}
P &amp; K &amp; L\\
R' &amp; -S &amp; S-R'
\end{array}\right)
\end{split}\]</div>
<p>In the full equations for the observable, this term appears in a summation with the <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a>, as:</p>
<div class="math notranslate nohighlight" id="equation-eq-basis-aligmentterm-defn">
<span class="eqno">(3.28)<a class="headerlink" href="#equation-eq-basis-aligmentterm-defn" title="Permalink to this equation">#</a></span>\[
\tilde{\Delta}_{L,M}(t) = \sum_{K,Q,S}\Delta_{L,M}(K,Q,S)A_{Q,S}^{K}(t)
\]</div>
<p>This summed alignment term can be considered, essentially, as a (coherent) geometric averaging of the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> observable weighted by the axis distribution in the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> (for more on the axis averaging as a convolution, see Refs. <span id="id32">[<a class="reference internal" href="../backmatter/bibliography.html#id663" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5.">2</a>, <a class="reference internal" href="../backmatter/bibliography.html#id916" title="Jonathan G. Underwood and Katharine L. Reid. Time-resolved photoelectron angular distributions as a probe of intramolecular dynamics: Connecting the molecular frame and the laboratory frame. The Journal of Chemical Physics, 113(3):1067, 2000. URL: http://link.aip.org/link/JCPSA6/v113/i3/p1067/s1&amp;Agg=doi (visited on 2012-07-17).">87</a>]</span>); equivalently, the averaging can be considered as a purely angular-momentum coupling effect, which accounts for all contributing moments of the various aspects of the system, and defines the allowed projections onto the final observables in the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a>.</p>
<p>Mappings of these terms are investigated numerically below, for some examplar cases.</p>
<section id="basic-cases">
<span id="sec-theory-af-alignment-term-basic"></span><h3><span class="section-number">3.3.8.1. </span>Basic cases<a class="headerlink" href="#basic-cases" title="Permalink to this heading">#</a></h3>
<p><a class="reference internal" href="#fig-deltaterm000"><span class="std std-numref">Fig. 3.5</span></a> illustrates the alignment tensor <span class="math notranslate nohighlight">\(\Delta_{L,M}(K,Q,S)\)</span> for some basic cases, and values are also tabulated in <a class="reference internal" href="#tab-deltaterm000"><span class="std std-numref">Table 3.6</span></a>. Note that for illustration purposes the term is subselected with <span class="math notranslate nohighlight">\(K=0\)</span>, <span class="math notranslate nohighlight">\(Q=0\)</span>, <span class="math notranslate nohighlight">\(S=0\)</span> and <span class="math notranslate nohighlight">\(R'=0\)</span>; <span class="math notranslate nohighlight">\(R\neq0\)</span> terms are included to illustrate the elliptically-polarized case, which can give rise to non-zero <span class="math notranslate nohighlight">\(M\)</span> terms.</p>
<p>For the simplest case of an unaligned ensemble, this term is restricted to <span class="math notranslate nohighlight">\(K=Q=S=0\)</span>, i.e. <span class="math notranslate nohighlight">\(\Delta_{L,M}(0,0,0)\)</span>; for single-photon ionization with linearly-polarized light (<span class="math notranslate nohighlight">\(p=0\)</span>, hence <span class="math notranslate nohighlight">\(P=0,2\)</span> and <span class="math notranslate nohighlight">\(R=R'=0\)</span>), this has non-zero values for <span class="math notranslate nohighlight">\(L=0,2\)</span> and <span class="math notranslate nohighlight">\(M=0\)</span> only. Typically, this simplest case is synonymous with standard <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> results, and maintains cylindrical and up-down symmetry in the observable.</p>
<p>For circularly polarized light (<span class="math notranslate nohighlight">\(p=\pm1\)</span>, hence <span class="math notranslate nohighlight">\(P=0,1,2\)</span> and <span class="math notranslate nohighlight">\(R=R'=0\)</span>), odd-<span class="math notranslate nohighlight">\(L\)</span> is allowed, signifying up/down symmetry breaking in the observable (where up/down pertains to the propagation direction of the light, conventionally the <span class="math notranslate nohighlight">\(z\)</span>-axis for non-linear polarizations, see <a class="reference internal" href="#sec-frame-definitions"><span class="std std-numref">Sect. 3.3.3</span></a>). For elliptically polarized light, mixing of terms with different <span class="math notranslate nohighlight">\(p\)</span> allows for non-zero <span class="math notranslate nohighlight">\(R\)</span> terms (see Eq. <a class="reference internal" href="#equation-eq-epr-defn-1">(3.22)</a>), hence non-zero <span class="math notranslate nohighlight">\(M\)</span> is allowed (see Eq. <a class="reference internal" href="#equation-eq-basis-alignmenttensor-defn">(3.27)</a>), signifying breaking of cylindrical symmetry in the observable is allowed. Note, however, that non-zero values here do not indicate that such effects <em>will</em> be observed in any given case, only that they may be (or, at least, are not restricted by the alignment tensor).</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Set range of ADMs for test as time-dependent values (linear ramps)</span>

<span class="c1"># Set ADMs for increasing alignment...</span>
<span class="c1"># Note that delta term is independent of the absolute values of the ADMs(t), </span>
<span class="c1"># but does use this term to define limits on some quantum numbers.</span>

<span class="n">tPoints</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># 10 t-points</span>
<span class="n">inputADMs</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">tPoints</span><span class="p">)],</span>
             <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)],</span> 
             <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)],</span>
             <span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.3</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)],</span>
             <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)]]</span>

<span class="c1"># Set to AKQS parameters in Xarray</span>
<span class="n">AKQS</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">setADMs</span><span class="p">(</span><span class="n">ADMs</span> <span class="o">=</span> <span class="n">inputADMs</span><span class="p">)</span>

<span class="c1"># Use default EPR term - note this computes for all pol states, p=[-1,0,1]</span>
<span class="n">EPR</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">geomCalc</span><span class="o">.</span><span class="n">EPR</span><span class="p">(</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;xarray&#39;</span><span class="p">)</span>

<span class="c1">#*** Compute alignment terms</span>
<span class="n">AFterm</span><span class="p">,</span> <span class="n">DeltaTerm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">geomCalc</span><span class="o">.</span><span class="n">deltaLMKQS</span><span class="p">(</span><span class="n">EPR</span><span class="p">,</span> <span class="n">AKQS</span><span class="p">)</span>

<span class="c1">#*** Plot Delta term with subselections and formatting</span>
<span class="n">xDim</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;LM&#39;</span><span class="p">:[</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M&#39;</span><span class="p">]}</span>
<span class="n">daPlot</span><span class="p">,</span> <span class="n">daPlotpd</span><span class="p">,</span> <span class="n">legendList</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span>
                     <span class="n">DeltaTerm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Q</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">S</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">Rp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;S-Rp&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}),</span> 
                     <span class="n">xDim</span> <span class="o">=</span> <span class="n">xDim</span><span class="p">,</span> 
                     <span class="n">pType</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">squeeze</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">thres</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">titleString</span><span class="o">=</span><span class="s2">&quot;$\Delta(0,0,0)$ term ($R&#39;=0$ only)&quot;</span><span class="p">,</span>
                     <span class="c1"># Set dim mapping to use P,R with &quot;l,m&quot; colourmap</span>
                     <span class="n">dimMaps</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;lDims&#39;</span><span class="p">:[</span><span class="s1">&#39;P&#39;</span><span class="p">],</span><span class="s1">&#39;mDims&#39;</span><span class="p">:</span><span class="s1">&#39;R&#39;</span><span class="p">},</span>  
                     <span class="n">labelCols</span><span class="o">=</span><span class="n">labelCols</span><span class="p">,</span>
                     <span class="n">catLegend</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


<span class="c1"># Glue versions for JupyterBook output</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;deltaTerm000-lmPlot&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># As above, but with PD object return and glue.</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;deltaTerm000-tab&quot;</span><span class="p">,</span><span class="n">daPlotpd</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set dataType (No dataType)
Plotting data (No filename), pType=r, thres=None, with Seaborn
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-deltaterm000">
<img alt="../_images/0b181a471caeb0bd22ab9abccc869734f8179274383cfca076619ea60d1d939b.png" src="../_images/0b181a471caeb0bd22ab9abccc869734f8179274383cfca076619ea60d1d939b.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.5 </span><span class="caption-text">Example <span class="math notranslate nohighlight">\(\Delta_{L,M}(0,0,0)\)</span> basis functions (see also <a class="reference internal" href="#tab-deltaterm000"><span class="std std-numref">Fig. 3.6</span></a>). For illustration purposes, the plot only shows terms for <span class="math notranslate nohighlight">\(R'=0\)</span>. See main text for discussion.</span><a class="headerlink" href="#fig-deltaterm000" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="tab-deltaterm000">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>L</th>
      <th>0</th>
      <th colspan="3" halign="left">1</th>
      <th colspan="5" halign="left">2</th>
    </tr>
    <tr>
      <th></th>
      <th>M</th>
      <th>0</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>-2</th>
      <th>-1</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
    <tr>
      <th>P</th>
      <th>R</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td>-0.333</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>0</th>
      <td></td>
      <td></td>
      <td>0.333</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>-0.333</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.2</td>
    </tr>
    <tr>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-0.2</td>
      <td></td>
    </tr>
    <tr>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.2</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>-0.2</td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>0.2</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 3.6 </span><span class="caption-text">Example <span class="math notranslate nohighlight">\(\Delta_{L,M}(0,0,0)\)</span> basis functions (see also <a class="reference internal" href="#fig-deltaterm000"><span class="std std-numref">Fig. 3.5</span></a>). For illustration purposes, the table only shows terms for <span class="math notranslate nohighlight">\(R'=0\)</span>. See main text for discussion.</span><a class="headerlink" href="#tab-deltaterm000" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Plot ADMs</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">ADMFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">AKQS</span><span class="p">,</span> <span class="n">xDim</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">pType</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> 
                       <span class="n">labelCols</span><span class="o">=</span><span class="n">labelCols</span><span class="p">,</span> <span class="n">catLegend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;vlag&#39;</span><span class="p">,</span>
                       <span class="n">titleString</span><span class="o">=</span><span class="s1">&#39;ADMs (linear ramp example)&#39;</span><span class="p">)</span> 

<span class="c1">#*** Plot AF term with subselection</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">AFFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">AFterm</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">R</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Rp</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;S-Rp&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">}),</span> 
                      <span class="n">xDim</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">pType</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span> 
                      <span class="n">labelCols</span><span class="o">=</span><span class="n">labelCols</span><span class="p">,</span>
                      <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;vlag&#39;</span><span class="p">,</span>
                      <span class="n">titleString</span><span class="o">=</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tilde{\Delta}_{L,M}(t)$ (linear ramp example)&#39;</span><span class="p">)</span> 

<span class="c1"># Glue versions for JupyterBook output</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ADMs-linearRamp-lmPlot&quot;</span><span class="p">,</span> <span class="n">ADMFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;AFterm-linearRamp-lmPlot&quot;</span><span class="p">,</span> <span class="n">AFFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Plotting data (No filename), pType=r, thres=0.01, with Seaborn
Set dataType (No dataType)
Plotting data (No filename), pType=r, thres=0.01, with Seaborn
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-adms-linearramp">
<img alt="../_images/e733c81a0a4c2ffdd50b03a0d1150c8eb698f4519e234bb150e4b7851e03665a.png" src="../_images/e733c81a0a4c2ffdd50b03a0d1150c8eb698f4519e234bb150e4b7851e03665a.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.7 </span><span class="caption-text">Example ADMs used for <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> basis function example (see <a class="reference internal" href="#fig-afterm-linearramp"><span class="std std-numref">Fig. 3.8</span></a>). These ADMs essentially show an increasing degree of alignment with the <span class="math notranslate nohighlight">\(t\)</span> parameter, with high-order terms increasing at later <span class="math notranslate nohighlight">\(t\)</span>.</span><a class="headerlink" href="#fig-adms-linearramp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-afterm-linearramp">
<img alt="../_images/8843790fad916e8611979f751cab5841297c84af311c71dc77879741ba266b3a.png" src="../_images/8843790fad916e8611979f751cab5841297c84af311c71dc77879741ba266b3a.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.8 </span><span class="caption-text">Example of <span class="math notranslate nohighlight">\(\tilde{\Delta}_{L,M}(t)\)</span> basis values for various choices of alignment (as per <a class="reference internal" href="#fig-adms-linearramp"><span class="std std-numref">Fig. 3.7</span></a>). The ADMs essentially show an increasing degree of alignment with the <span class="math notranslate nohighlight">\(t\)</span> parameter, with high-order terms increasing at later <span class="math notranslate nohighlight">\(t\)</span>, and this is reflected in the <span class="math notranslate nohighlight">\(\tilde{\Delta}_{L,M}(t)\)</span> terms with higher-order <span class="math notranslate nohighlight">\(L\)</span> appearing at later <span class="math notranslate nohighlight">\(t\)</span>.</span><a class="headerlink" href="#fig-afterm-linearramp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For cases with aligned molecular ensembles, additional terms can similarly appear depending on the alignment as well as the properties of the ionizing radiation. Again, the types of terms follow some typical patterns dependent on the symmetry of the ensemble, as well as the order of the terms allowed. For instance, <span class="math notranslate nohighlight">\(L_{max}=P_{max}+K_{max}=2+K_{max}\)</span>, and <span class="math notranslate nohighlight">\(K_{max}\)</span> represents the overall degree of alignment of the ensemble; hence an aligned ensemble may be signified by higher-order terms in the observable (if allowed by other terms in the overall expansion) or, equivalently, aligning an ensemble prior to ionization can be used as a way to control which terms contribute to the alignment tensor.</p>
<p>Since this is a coherent averaging, additional interferences can also appear in the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> - or be restricted in the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> - depending on these geometric parameters and the contributing matrix elements. Additionally, any effects modulating these terms, for instance a time-dependent alignment (rotational wavepacket), vibronic dynamics (vibrational and/or electronic wavepacket), time-dependent laser field (control field) may be anticipted to lead to both changes in these terms and, potentially, interesting effects in the observable. Such effects have been discussed in more detail in <em>Quantum Metrology</em> Vol. 2 <span id="id33">[<a class="reference internal" href="../backmatter/bibliography.html#id664" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 2: Applications and Advances. IOP Publishing, 2018. ISBN 978-1-68174-688-3. URL: http://iopscience.iop.org/book/978-1-6817-4688-3.">5</a>]</span>, and in the current case the focus is purely on rotational wavepackets.</p>
<p><a class="reference internal" href="#fig-afterm-linearramp"><span class="std std-numref">Fig. 3.8</span></a> shows <span class="math notranslate nohighlight">\(\tilde{\Delta}_{L,M}(t)\)</span> for various choices of alignment (as per the <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a> shown in <a class="reference internal" href="#fig-adms-linearramp"><span class="std std-numref">Fig. 3.7</span></a>), and illustrates some of the general features discussed. Note, for example:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(L_{max}\)</span> varies with alignment; in the demonstration case <span class="math notranslate nohighlight">\(K_{max}=8\)</span> at later times, resulting in <span class="math notranslate nohighlight">\(L_{max}=10\)</span>, whilst at <span class="math notranslate nohighlight">\(t=0\)</span> <span class="math notranslate nohighlight">\(K_{max}=0\)</span>, thus restricting terms to <span class="math notranslate nohighlight">\(L_{max}=2\)</span>.</p></li>
<li><p>Odd-<span class="math notranslate nohighlight">\(L\)</span> values are correlated with <span class="math notranslate nohighlight">\(P=1\)</span> terms.</p></li>
<li><p>Only <span class="math notranslate nohighlight">\(M=0\)</span> terms are allowed in this case (<span class="math notranslate nohighlight">\(Q=S=0\)</span>).</p></li>
</ul>
</section>
<section id="d-alignments-and-symmetry-breaking">
<span id="sec-theory-af-alignment-term-3d"></span><h3><span class="section-number">3.3.8.2. </span>3D alignments and symmetry breaking<a class="headerlink" href="#d-alignments-and-symmetry-breaking" title="Permalink to this heading">#</a></h3>
<p>As discussed above, for the case where <span class="math notranslate nohighlight">\(Q\neq0\)</span> and/or <span class="math notranslate nohighlight">\(S\neq0\)</span> additional symmetry breaking can occur. It is simple to examine these effects numerically via changing the trial <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a> used to determine <span class="math notranslate nohighlight">\(\tilde{\Delta}_{L,M}(t)\)</span> (Eq. <a class="reference internal" href="#equation-eq-basis-aligmentterm-defn">(3.28)</a>). (Realistic cases can be found in the case-studies presented in <a class="reference internal" href="../part2/extracting_matrix_elements_overview_270423.html#chpt-extracting-matrix-elements-overview"><span class="std std-ref">Part II</span></a>.)</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#*** Neater version</span>
<span class="c1"># Set ADMs for increasing alignment...</span>
<span class="c1"># Here add some (arb) terms for Q,S non-zero (indexed as [K,Q,S, ADMs(t)])</span>
<span class="n">tPoints</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">inputADMs3D</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">tPoints</span><span class="p">)],</span> 
             <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)],</span> 
             <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)],</span>
             <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)],</span>
             <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">,</span><span class="n">tPoints</span><span class="p">)]]</span>

<span class="c1"># Set to AKQS parameters in an Xarray</span>
<span class="n">AKQS</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">setADMs</span><span class="p">(</span><span class="n">ADMs</span> <span class="o">=</span> <span class="n">inputADMs3D</span><span class="p">)</span>

<span class="c1"># Compute alignment terms</span>
<span class="n">AFterm</span><span class="p">,</span> <span class="n">DeltaTerm</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">geomCalc</span><span class="o">.</span><span class="n">deltaLMKQS</span><span class="p">(</span><span class="n">EPR</span><span class="p">,</span> <span class="n">AKQS</span><span class="p">)</span>

<span class="c1">#*** Plot subsection, L&lt;=2, and sum over Rp and S-Rp terms</span>
<span class="n">titleString</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">tilde{\Delta}_{L,M}(t)$ (3D alignment ramp example).&#39;</span>
               <span class="s1">&#39;</span><span class="se">\n</span><span class="s1"> Summed over $R</span><span class="se">\&#39;</span><span class="s1">$ and $S-R</span><span class="se">\&#39;</span><span class="s1">$ terms.&#39;</span><span class="p">)</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">AFterm</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">AFterm</span><span class="o">.</span><span class="n">L</span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;Rp&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;S-Rp&#39;</span><span class="p">),</span>
                    <span class="n">xDim</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">pType</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;vlag&#39;</span><span class="p">,</span>
                    <span class="n">titleString</span><span class="o">=</span><span class="n">titleString</span><span class="p">)</span> 

<span class="c1"># Glue versions for JupyterBook output</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;ADMs-3DlinearRamp-lmPlot&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set dataType (No dataType)
Plotting data (No filename), pType=r, thres=0.01, with Seaborn
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-adms-3dlinearramp">
<img alt="../_images/88998ddaef4dbcb99470af20aea1b302feee88a3dcd9461cd502662b3abec19d.png" src="../_images/88998ddaef4dbcb99470af20aea1b302feee88a3dcd9461cd502662b3abec19d.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.9 </span><span class="caption-text">Example <span class="math notranslate nohighlight">\(\tilde{\Delta}_{L,M}(t)\)</span> basis values for various choices of “3D” alignment, i.e. including some <span class="math notranslate nohighlight">\(K\neq0\)</span> and <span class="math notranslate nohighlight">\(S\neq0\)</span> terms. Note, in particular, the presence of <span class="math notranslate nohighlight">\(M\neq0\)</span> terms in general, and a complicated dependence of the allowed terms on the alignment (<a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a>), which may increase, decrease, or even change sign for a given <span class="math notranslate nohighlight">\(L,M\)</span>.</span><a class="headerlink" href="#fig-adms-3dlinearramp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For illustration purposes, <a class="reference internal" href="#fig-adms-3dlinearramp"><span class="std std-numref">Fig. 3.9</span></a> shows a subselection of the <span class="math notranslate nohighlight">\(\tilde{\Delta}_{L,M}(t)\)</span> basis values, indicating some of the key features in the full 3D case, subselected for <span class="math notranslate nohighlight">\(L\leq2\)</span> and summed over <span class="math notranslate nohighlight">\(R'\)</span> and <span class="math notranslate nohighlight">\(S-R'\)</span> terms. Note, in particular, the presence of <span class="math notranslate nohighlight">\(M\neq0\)</span> terms in general, and a complicated dependence of the allowed terms on the alignment, which may increase, decrease, or even change sign. As previously, these behaviours are generally useful for understanding specific cases or planning experiments for specific systems; this is explored further in <a class="reference internal" href="../part2/extracting_matrix_elements_overview_270423.html#chpt-extracting-matrix-elements-overview"><span class="std std-ref">Part II</span></a> which focuses on the results for particular molecules (hence symmetries and sets of matrix elements).</p>
</section>
</section>
<section id="tensor-product-terms">
<span id="sec-theory-tensor-products"></span><h2><span class="section-number">3.3.9. </span>Tensor product terms<a class="headerlink" href="#tensor-product-terms" title="Permalink to this heading">#</a></h2>
<p>Following the above, further resultant terms can also be examined, up to and including the full channel functions <span class="math notranslate nohighlight">\(\varUpsilon_{L,M}^{u,\zeta\zeta'}\)</span> (see <a class="reference internal" href="#equation-eqn-channel-fns">(3.13)</a>) for a given case. Numerically these are all implemented in the main <a class="reference external" href="https://epsproc.readthedocs.io">ePSproc codebase</a> <span id="id34">[<a class="reference internal" href="../backmatter/bibliography.html#id655" title="Paul Hockett. ePSproc: Post-processing suite for ePolyScat electron-molecule scattering calculations. Authorea, 2016. URL: https://www.authorea.com/users/71114/articles/122402/_show_article.">24</a>, <a class="reference internal" href="../backmatter/bibliography.html#id597" title="Paul Hockett. ePSproc: Post-processing for ePolyScat (Github repository). Github, 2016. URL: https://github.com/phockett/ePSproc.">25</a>, <a class="reference internal" href="../backmatter/bibliography.html#id595" title="Paul Hockett. ePSproc: Post-processing for ePolyScat documentation. 2020. URL: https://epsproc.readthedocs.io (visited on 2022-02-18).">26</a>]</span>, and can be returned by these functions for inspection - the full basis set already defined includes some of these products. Custom tensor product terms are also readily computed with the codebase, with tensor multiplications handled natively by the <a class="reference external" href="https://docs.xarray.dev"><code class="docutils literal notranslate"><span class="pre">Xarray</span></code></a> <span id="id35">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Stephan Hoyer and Joe Hamman. Xarray: N-D labeled Arrays and Datasets in Python. Journal of Open Research Software, 5(1):10, April 2017. URL: http://openresearchsoftware.metajnl.com/article/10.5334/jors.148/ (visited on 2022-08-03).">44</a>, <a class="reference internal" href="../backmatter/bibliography.html#id953" title="Xarray documentation. URL: https://docs.xarray.dev/en/latest/index.html (visited on 2022-08-03).">45</a>]</span> data objects (for more details of the data structures used, see the <a class="reference external" href="https://epsproc.readthedocs.io">ePSproc documentation</a> <span id="id36">[<a class="reference internal" href="../backmatter/bibliography.html#id595" title="Paul Hockett. ePSproc: Post-processing for ePolyScat documentation. 2020. URL: https://epsproc.readthedocs.io (visited on 2022-02-18).">26</a>]</span>, specifically the <a class="reference external" href="https://epsproc.readthedocs.io/en/latest/dataStructures/ePSproc_dataStructures_demo_070622.html">data structures page</a>).</p>
<p>Polarisation &amp; ADM product term: the main product basis returned, labelled <code class="docutils literal notranslate"><span class="pre">polProd</span></code> in the output dictionary, contains the tensor product <span class="math notranslate nohighlight">\(\Lambda_{R}\otimes E_{PR}(\hat{e})\otimes \Delta_{L,M}(K,Q,S)\otimes A^{K}_{Q,S}(t)\)</span>, expanded over all quantum numbers (see <a class="reference external" href="https://epsproc.readthedocs.io/en/dev/methods/geometric_method_dev_pt3_AFBLM_090620_010920_dev_bk100920.html#%5Cbeta_%7BL,M%7D%5E%7BAF%7D-rewrite">full definition here</a>). This term, therefore, incorporates all of the dependence (or response) of the AF-<span class="math notranslate nohighlight">\(\beta_{LM}\)</span>s on the polarisation state, and the axis distribution. Example results, making use of the linear-ramp <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a> of <a class="reference internal" href="#sec-theory-af-alignment-term-basic"><span class="std std-numref">Sect. 3.3.8.1</span></a> are illustrated in <a class="reference internal" href="#fig-polprod-linearramp"><span class="std std-numref">Fig. 3.10</span></a>.</p>
<p>The full channel (response) functions <span class="math notranslate nohighlight">\(\varUpsilon_{L,M}^{u,\zeta\zeta'}\)</span> as defined in <a class="reference internal" href="#equation-eq-channelfunc-mf-defn">(3.18)</a> and <a class="reference internal" href="#equation-eq-channelfunc-af-defn">(3.19)</a> can be determined by the product of this term with the <span class="math notranslate nohighlight">\(B_{L,M}\)</span> tensor. This is essentially the complete geometric basis set, hence equivalent to the <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a>-<span class="math notranslate nohighlight">\(\beta_{LM}\)</span> if the ionization matrix elements were set to unity. This illustrates not only the coupling of the geometric terms into the observable <span class="math notranslate nohighlight">\(L,M\)</span>, but also how the partial wave <span class="math notranslate nohighlight">\(|l,m\rangle\)</span> terms map to the observables, and hence the sensitivity of the observables to given partial wave properties. Example results, making use of the linear-ramp <a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a> of <a class="reference internal" href="#sec-theory-af-alignment-term-basic"><span class="std std-numref">Sect. 3.3.8.1</span></a> are illustrated in <a class="reference internal" href="#fig-channelfunc-linearramp"><span class="std std-numref">Fig. 3.11</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set data - set example ADMs to data structure &amp; subset for calculation</span>
<span class="n">data</span><span class="o">.</span><span class="n">setADMs</span><span class="p">(</span><span class="n">ADMs</span> <span class="o">=</span> <span class="n">inputADMs</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">setSubset</span><span class="p">(</span><span class="n">dataKey</span> <span class="o">=</span> <span class="s1">&#39;ADM&#39;</span><span class="p">,</span> <span class="n">dataType</span> <span class="o">=</span> <span class="s1">&#39;ADM&#39;</span><span class="p">)</span>

<span class="c1"># Using PEMtk - this only returns the product basis set as used for fitting</span>
<span class="n">BetaNormX</span><span class="p">,</span> <span class="n">basisProduct</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">afblmMatEfit</span><span class="p">(</span><span class="n">selDims</span><span class="o">=</span><span class="p">{},</span> <span class="n">sqThres</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Subselected from dataset &#39;ADM&#39;, dataType &#39;ADM&#39;: 50 from 50 points (100.00%)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">basisKey</span> <span class="o">=</span> <span class="s1">&#39;polProd&#39;</span>  <span class="c1"># Key for BLM basis set</span>

<span class="c1"># Plot with subselection on pol state (by label, &#39;A&#39;=z-pol case)</span>
<span class="n">titleString</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;&quot;Polprod&quot; basis term, $\Lambda_</span><span class="si">{R}</span><span class="s1">\otimes E_</span><span class="si">{PR}</span><span class="s1">(\hat</span><span class="si">{e}</span><span class="s1">)\otimes&#39;</span> 
             <span class="s1">&#39;\Delta_{L,M}(K,Q,S)\otimes A^</span><span class="si">{K}</span><span class="s1">_{Q,S}(t)$.&#39;</span>
             <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Subselected for $z$-pol.&#39;</span><span class="p">)</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">basisProduct</span><span class="p">[</span><span class="n">basisKey</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Labels</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">),</span> 
                   <span class="n">xDim</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">cmap</span><span class="p">,</span> <span class="n">mDimLabel</span><span class="o">=</span><span class="s1">&#39;mu&#39;</span><span class="p">,</span>
                   <span class="n">labelCols</span><span class="o">=</span><span class="n">labelCols</span><span class="p">,</span>
                   <span class="n">titleString</span><span class="o">=</span><span class="n">titleString</span><span class="p">);</span>

<span class="c1"># Glue versions for JupyterBook output</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;polProd-linearRamp-lmPlot&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set dataType (No dataType)
Plotting data (No filename), pType=a, thres=0.01, with Seaborn
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Full channel functions</span>
<span class="c1"># Plot with subselection on pol state (by label, &#39;A&#39;=z-pol case)</span>
<span class="n">titleString</span><span class="o">=</span><span class="s1">&#39;Channel functions example.</span><span class="se">\n</span><span class="s1">Subselected for $z$-pol, $S-R</span><span class="se">\&#39;</span><span class="s1">=0$.&#39;</span>
<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span>  <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">((</span><span class="n">basisProduct</span><span class="p">[</span><span class="s1">&#39;BLMtableResort&#39;</span><span class="p">]</span> <span class="o">*</span> 
                       <span class="n">basisProduct</span><span class="p">[</span><span class="s1">&#39;polProd&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">Labels</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">({</span><span class="s1">&#39;S-Rp&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">L</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> 
                      <span class="n">xDim</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">mDimLabel</span><span class="o">=</span><span class="s1">&#39;m&#39;</span><span class="p">,</span>
                      <span class="n">titleString</span><span class="o">=</span><span class="n">titleString</span><span class="p">);</span> 

<span class="c1"># Glue versions for JupyterBook output</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;channelFunc-linearRamp-lmPlot&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set dataType (No dataType)
Plotting data (No filename), pType=a, thres=0.01, with Seaborn
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No artists with labels found to put in legend.  Note that artists whose label start with an underscore are ignored when legend() is called with no argument.
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-polprod-linearramp">
<img alt="../_images/a7cda0de841125c68778b46cbe39ecd614b61fa34b5e91e48d12033bea490374.png" src="../_images/a7cda0de841125c68778b46cbe39ecd614b61fa34b5e91e48d12033bea490374.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.10 </span><span class="caption-text">Example product basis function for the polarisation and ADM terms, as given by <span class="math notranslate nohighlight">\(\Lambda_{R}\otimes E_{PR}(\hat{e})\otimes \Delta_{L,M}(K,Q,S)\otimes A^{K}_{Q,S}(t)\)</span>. Shown for <span class="math notranslate nohighlight">\(z\)</span>-pol case only (<span class="math notranslate nohighlight">\(p=0\)</span>).</span><a class="headerlink" href="#fig-polprod-linearramp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-default" id="fig-channelfunc-linearramp">
<img alt="../_images/a3b45fc94a3fa791c444959d9f39312a374c8d1122c8cc37a48d8c40d681fa91.png" src="../_images/a3b45fc94a3fa791c444959d9f39312a374c8d1122c8cc37a48d8c40d681fa91.png" />
<figcaption>
<p><span class="caption-number">Fig. 3.11 </span><span class="caption-text">Example of <span class="math notranslate nohighlight">\(\bar{\varUpsilon_{}}_{L,M}^{u,\zeta\zeta'}\)</span> basis values for various choices of alignment (as per <a class="reference internal" href="#fig-adms-linearramp"><span class="std std-numref">Fig. 3.7</span></a>), shown for <span class="math notranslate nohighlight">\(L=2\)</span> and <span class="math notranslate nohighlight">\(z\)</span>-pol case only (<span class="math notranslate nohighlight">\(p=0\)</span>). The basis essentially shows the obsevable terms if the ionization matrix elements are neglected, hence the sensitivity of the configuration to each pair of partial wave terms. Note, in general, that the sensitivity to any given pair <span class="math notranslate nohighlight">\(\langle l',m'|l,m\rangle\)</span>, increases with alignment (hence with <span class="math notranslate nohighlight">\(t\)</span> in this example) for the linear polarisation case (<span class="math notranslate nohighlight">\(\mu=\mu'=0\)</span>), but typically decreases with alignment for cross-polarised terms.</span><a class="headerlink" href="#fig-channelfunc-linearramp" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<hr class="footnotes docutils" />
<aside class="footnote brackets" id="eqfootnote" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id7">1</a><span class="fn-bracket">]</span></span>
<p>Cf. the general form of Eq. <a class="reference internal" href="theory_photoionization_dynamics_140723.html#equation-eq-i-reduced-lf-2-45-vol1">(3.9)</a>. See also <em>Quantum Metrology</em> Vol. 2 <span id="id37">[<a class="reference internal" href="../backmatter/bibliography.html#id664" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 2: Applications and Advances. IOP Publishing, 2018. ISBN 978-1-68174-688-3. URL: http://iopscience.iop.org/book/978-1-6817-4688-3.">5</a>]</span> Chpt. 12 for early discussion and motivation for this formalism.</p>
</aside>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="theory_symmetry_140723.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.2. </span>Symmetry in photoionization</p>
      </div>
    </a>
    <a class="right-next"
       href="theory_density_matrices_190723.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.4. </span>Density matrix representation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#channel-functions">3.3.1. Channel functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#full-tensor-expansion">3.3.2. Full tensor expansion</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#frame-definitions">3.3.3. Frame definitions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#numerical-aside-symmetry-defined-channel-functions">3.3.4. Numerical aside: symmetry-defined channel functions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-element-geometric-coupling-term-b-l-m">3.3.5. Matrix element geometric coupling term <span class="math notranslate nohighlight">\(B_{L,M}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#electric-field-geometric-coupling-term-e-p-r-hat-e-mu-0">3.3.6. Electric field geometric coupling term <span class="math notranslate nohighlight">\({E_{P,R}(\hat{e};\mu_{0})}\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#molecular-frame-projection-term-lambda">3.3.7. Molecular frame projection term <span class="math notranslate nohighlight">\(\Lambda\)</span></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#alignment-tensor-delta-l-m-k-q-s">3.3.8. Alignment tensor <span class="math notranslate nohighlight">\(\Delta_{L,M}(K,Q,S)\)</span></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-cases">3.3.8.1. Basic cases</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-alignments-and-symmetry-breaking">3.3.8.2. 3D alignments and symmetry breaking</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-product-terms">3.3.9. Tensor product terms</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Hockett with Varun Makhija
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>