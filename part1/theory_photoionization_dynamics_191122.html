

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>3.2. Photoionization dynamics &#8212; Quantum Metrology with Photoelectrons Vol. 3 *Analysis methodologies*</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["\\boldsymbol{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part1/theory_photoionization_dynamics_191122';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.3. Tensor formulation of photoionization" href="theory_tensor_formalism_201122.html" />
    <link rel="prev" title="3.1. Observables: photoelectron flux in the LF and MF" href="theory_observables_intro_211122.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/ePSproc_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/ePSproc_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    About the book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Frontmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/overview_270122.html">Overview</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Theory &amp; software</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="main_intro_051122.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="platform_intro_071122.html">2. Quantum metrology software platform/ecosystem overview</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="theory_101122.html">3. Theory</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="theory_observables_intro_211122.html">3.1. Observables: photoelectron flux in the LF and MF</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">3.2. Photoionization dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_tensor_formalism_201122.html">3.3. Tensor formulation of photoionization</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_density_matrices_310123.html">3.4. Density matrix representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory_info_content_221122.html">3.5. Information content &amp; sensitivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="numerics_231122.html">4. Numerical methodologies for extracting matrix elements</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Extracting matrix elements - numerical methods &amp; case studies</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part2/extracting_matrix_elements_overview_270423.html">5. Extracting matrix elements overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/sym-fitting-intro_220423.html">6. Basis sets for fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/basic_fitting_numerics_intro_260423.html">7. Basic fit setup and numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/case-study-N2_270423.html">8. Case study: Generalised bootstrapping for a homonuclear diatomic scattering system, <span class="math notranslate nohighlight">\(N_2~(D_{\infty h})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/case-study-OCS_270423.html">9. Case study: Generalised bootstrapping for a linear heteronuclear scattering system, <span class="math notranslate nohighlight">\(OCS~(C_{\infty v})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../part2/case-study-C2H4_270423.html">10. Case study: Generalised bootstrapping for a general asymmetric top scattering system, <span class="math notranslate nohighlight">\(C_2H_4~(C_{2h})\)</span></a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../backmatter/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backmatter/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Test pages</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tests/build_versions_checks.html">Build versions and config tests</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/phockett/Quantum-Metrology-with-Photoelectrons-Vol3" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/phockett/Quantum-Metrology-with-Photoelectrons-Vol3/issues/new?title=Issue%20on%20page%20%2Fpart1/theory_photoionization_dynamics_191122.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part1/theory_photoionization_dynamics_191122.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Photoionization dynamics</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-forms">3.2.1. General forms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-in-photoionization">3.2.2. Symmetry in photoionization</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="photoionization-dynamics">
<span id="sec-dynamics-intro"></span><h1><span class="section-number">3.2. </span>Photoionization dynamics<a class="headerlink" href="#photoionization-dynamics" title="Permalink to this heading">#</a></h1>
<p>The core physics of photoionization has been covered extensively in the literature, and only a very brief overview is provided here with sufficient detail to introduce the metrology/reconstruction/retrieval problem; the reader is referred to Vol. 1 <span id="id1">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span> (and refs. therein) for further details and general discussion.</p>
<section id="general-forms">
<h2><span class="section-number">3.2.1. </span>General forms<a class="headerlink" href="#general-forms" title="Permalink to this heading">#</a></h2>
<p>Photoionization can be described by the coupling of an initial state of the system to a particular final state (photoion(s) plus free photoelectron(s)), coupled by an electric field/photon. Very generically, this can be written as a matrix element <span class="math notranslate nohighlight">\(\langle\Psi_i|\hat{\Gamma}(\boldsymbol{\mathbf{E}})|\Psi_f\rangle\)</span>, where <span class="math notranslate nohighlight">\(\hat{\Gamma}(\boldsymbol{\mathbf{E}})\)</span> defines the light-matter coupling operator (depending on the electric field <span class="math notranslate nohighlight">\(\boldsymbol{\mathbf{E}}\)</span>), and <span class="math notranslate nohighlight">\(\Psi_i\)</span>, <span class="math notranslate nohighlight">\(\Psi_f\)</span> the total wavefunctions of the initial and final states respectively.</p>
<p>There are many flavours of this fundamental light-matter interaction, depending on system and coupling. For metrology, the focus is currently on the simplest case of single-photon absorption, in the weak field (or purturbative), dipolar regime, resulting in a single photoelectron. (For more discussion of various approximations in photoionzation, see Refs. <span id="id2">[<a class="reference internal" href="../backmatter/bibliography.html#id792" title="Tamar Seideman. Time-resolved photoelectron angular distributions: concepts, applications, and directions. Annual review of physical chemistry, 53:41–65, January 2002. URL: http://www.ncbi.nlm.nih.gov/pubmed/11972002 (visited on 2012-07-17), arXiv:11972002, doi:10.1146/annurev.physchem.53.082101.130051.">41</a>, <a class="reference internal" href="../backmatter/bibliography.html#id791" title="Tamar Seideman. Time-resolved photoelectron angular distributions as a probe of coupled polyatomic dynamics. Physical Review A, 64(4):042504, September 2001. URL: http://link.aps.org/doi/10.1103/PhysRevA.64.042504 (visited on 2013-03-14), doi:10.1103/PhysRevA.64.042504.">42</a>]</span>.) In this case the core physics is well defined, and tractable (albeit non-trivial), via the separation of matrix elements into radial (energy) and angular-momentum (geometric) terms pertaining to couplings between various elements of the problem; the retrieval of such matrix elements is a well-defined problem, making use of analytic terms in combination with fitting methodologies as explored herein. Again, more extensive background and discussion can be found in <em>Quantum Metrology</em> Vol. 1 <span id="id3">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span>, and references therein. % [TODO: Add some more refs here?]</p>
<p>The basic case also provides a strong foundation for extension into more complex light-matter interactions, in particular cases with shaped laser-fields (i.e. a time-dependent coupling <span class="math notranslate nohighlight">\(\hat{\Gamma}(\boldsymbol{\mathbf{E,t}})\)</span>) and multi-photon processes (which require multiple matrix elements, and/or different approximations). Note, however, that non-perturbative (strong field) light-matter interactions are, typically, not amenable to description in a separable picture in this manner. In such cases the laser field, molecular and continuum properties are strongly coupled, and are typically treated numerically in a fully time-dependent manner (although some separation of terms may work in some cases, depending on the system and interaction(s) at hand).</p>
<p>Underlying the photoelecton observables is the photoelectron continuum state <span class="math notranslate nohighlight">\(\left|\mathbf{k}\right&gt;\)</span>, prepared via photoionization. The photoelectron momentum vector is denoted generally by
<span class="math notranslate nohighlight">\(\boldsymbol{\mathbf{k}}=k\mathbf{\hat{k}}\)</span>, in the molecular frame (<a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a>). The ionization matrix elements associated with this transition provide the set of quantum amplitudes completely defining the final continuum scattering state,</p>
<div class="math notranslate nohighlight" id="equation-eq-continuum-state-vec">
<span class="eqno">(3.6)<a class="headerlink" href="#equation-eq-continuum-state-vec" title="Permalink to this equation">#</a></span>\[\left|\Psi_f\right&gt; = \sum{\int{\left|\Psi_{+};\bf{k}\right&gt;\left&lt;\Psi_{+};\mathbf{k}|\Psi_f\right&gt; d\bf{k}}},
\]</div>
<p>where the sum is over states of the molecular ion <span class="math notranslate nohighlight">\(\left|\Psi_{+}\right&gt;\)</span>. The number of ionic states accessed depends on the nature of the ionizing pulse and interaction. For the dipolar case,</p>
<div class="math notranslate nohighlight" id="equation-eq-def-dipole-operator">
<span class="eqno">(3.7)<a class="headerlink" href="#equation-eq-def-dipole-operator" title="Permalink to this equation">#</a></span>\[\hat{\Gamma}(\boldsymbol{\mathbf{E}}) = \hat{\boldsymbol{\mu}}.\boldsymbol{\mathbf{E}}\]</div>
<p>Hence,</p>
<div class="math notranslate nohighlight" id="equation-eq-mate-dipole">
<span class="eqno">(3.8)<a class="headerlink" href="#equation-eq-mate-dipole" title="Permalink to this equation">#</a></span>\[\left&lt;\Psi_{+};\mathbf{k}|\Psi_f\right&gt; =\langle\Psi_{+};\,\mathbf{k}|\hat{\boldsymbol{\mu}}.\boldsymbol{\mathbf{E}}|\Psi_{i}\rangle
\]</div>
<p>Where the notation implies a perturbative photoionization event from an initial state <span class="math notranslate nohighlight">\(i\)</span> to a particular ion plus electron state following absorption of a photon <span class="math notranslate nohighlight">\(h\nu\)</span>, <span class="math notranslate nohighlight">\(|\Psi_{i}\rangle+h\nu{\rightarrow}|\Psi_{+};\boldsymbol{\mathbf{k}}\rangle\)</span>, and <span class="math notranslate nohighlight">\(\hat{\mu}.\boldsymbol{\mathbf{E}}\)</span> is the usual dipole interaction term <span id="id4">[<a class="reference internal" href="../backmatter/bibliography.html#id745" title="Christopher Gerry and Peter Knight. Introductory Quantum Optics. Cambridge University Press, 2005.">43</a>]</span>, which includes a sum over all electrons <span class="math notranslate nohighlight">\(s\)</span> defined in position space as <span class="math notranslate nohighlight">\(\mathbf{r_{s}}\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-dipole-operator">
<span class="eqno">(3.9)<a class="headerlink" href="#equation-eq-dipole-operator" title="Permalink to this equation">#</a></span>\[\hat{\mu}=-e\sum_{s}\mathbf{r_{s}}
\]</div>
<p>The position space photoelectron wavefunction is typically expressed in
the “partial wave” basis, expanded as (asymptotic) continuum
eignstates of orbital angular momentum, with angular momentum components
<span class="math notranslate nohighlight">\((l,m)\)</span> (note lower case notation for the partial wave components, distinct from upper-case for the similar terms <span class="math notranslate nohighlight">\((L,M)\)</span> in the observables),</p>
<div class="math notranslate nohighlight" id="equation-eq-elwf">
<span class="eqno">(3.10)<a class="headerlink" href="#equation-eq-elwf" title="Permalink to this equation">#</a></span>\[\Psi_\mathbf{k}(\boldsymbol{r})\equiv\left&lt;\boldsymbol{r}|\mathbf{k}\right&gt; = \sum_{lm}Y_{lm}(\mathbf{\hat{k}})\psi_{lm}(\boldsymbol{r},k)
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span> are MF electronic coordinates and
<span class="math notranslate nohighlight">\(Y_{lm}(\mathbf{\hat{k}})\)</span> are the spherical harmonics.</p>
<p>Similarly, the ionization dipole matrix elements can be separated
generally into radial (energy-dependent or ‘dynamical’ terms) and
geometric (angular momentum) parts (this separation is essentially the
Wigner-Eckart Theorem, see Ref. <span id="id5">[<a class="reference internal" href="../backmatter/bibliography.html#id882" title="Richard N Zare. Angular Momentum: Understanding Spatial Aspects in Chemistry and Physics. John Wiley &amp; Sons, 1988.">44</a>]</span> for general discussion),
and written generally as (using notation similar to <span id="id6">[<a class="reference internal" href="../backmatter/bibliography.html#id750" title="Katharine L. Reid, David J. Leahy, and Richard N. Zare. Effect of breaking cylindrical symmetry on photoelectron angular distributions resulting from resonance-enhanced two-photon ionization. The Journal of Chemical Physics, 95(3):1746, 1991. URL: http://scitation.aip.org/content/aip/journal/jcp/95/3/10.1063/1.461023, doi:10.1063/1.461023.">45</a>]</span>):</p>
<div class="math notranslate nohighlight" id="equation-eq-r-kllam">
<span class="eqno">(3.11)<a class="headerlink" href="#equation-eq-r-kllam" title="Permalink to this equation">#</a></span>\[\langle\Psi_{+};\,\mathbf{k}|\hat{\boldsymbol{\mu}}.\boldsymbol{\mathbf{E}}|\Psi_{i}\rangle = \sum_{lm}\gamma_{l,m}\mathbf{r}_{k,l,m}
\]</div>
<p>Provided that the geometric part of the matrix elements <span class="math notranslate nohighlight">\(\gamma_{l,m}\)</span> -
which includes the geometric rotations into the LF arising from the dot
product in Eq. <a class="reference internal" href="#equation-eq-r-kllam">(3.11)</a> and other angular-momentum coupling terms - are
know, knowledge of the so-called radial (or reduced) dipole matrix
elements, at a given <span class="math notranslate nohighlight">\(k\)</span> thus equates to a full description of the
system dynamics (and, hence, the observables).</p>
<p>For the simplest treatment, the radial matrix element can be
approximated as a 1-electron integral involving the initial electronic
state (orbital), and final continuum photoelectron wavefunction:</p>
<div class="math notranslate nohighlight" id="equation-eq-r-kllam-integral">
<span class="eqno">(3.12)<a class="headerlink" href="#equation-eq-r-kllam-integral" title="Permalink to this equation">#</a></span>\[\mathbf{r}_{k,l,m}=\int\psi_{lm}(\boldsymbol{r},k)\boldsymbol{r}\Psi_{i}(\boldsymbol{r})d\boldsymbol{r}
\]</div>
<p>As noted above, the geometric terms <span class="math notranslate nohighlight">\(\gamma_{l,m}\)</span> are analytical
functions which can be computed for a given case - minimally requiring
knowledge of the molecular symmetry and polarization geometry, although
other factors may also play a role (see <a class="reference internal" href="theory_tensor_formalism_201122.html#sec-full-tensor-expansion"><span class="std std-numref">Sect. 3.3.2</span></a> for details).</p>
<p>The photoelectron angular distribution (PAD) at a given <span class="math notranslate nohighlight">\((\epsilon,t)\)</span>
can then be determined by the squared projection of
<span class="math notranslate nohighlight">\(\left|\Psi_f\right&gt;\)</span> onto a specific state
<span class="math notranslate nohighlight">\(\left|\Psi_{+};\bf{k}\right&gt;\)</span>; very generally this can be written in terms of the energy and angle-resolved observable, which arises as the coherent square:</p>
<div class="math notranslate nohighlight" id="equation-eq-mate-sq-general">
<span class="eqno">(3.13)<a class="headerlink" href="#equation-eq-mate-sq-general" title="Permalink to this equation">#</a></span>\[
I(\epsilon,\theta,\phi)=\langle\Psi_{f}|\Psi_{f}\rangle
\]</div>
<p>Expansion in terms of the components of the matrix elements as detailed above then yields a separation into radial and angular components (see <em>Quantum Metrology</em> Vol. 1 <span id="id7">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span>, Sect. 2.1 for a full derivation), which can be written (at a single energy) as (following Eq. 2.45 of <em>Quantum Metrology</em> Vol. 1 <span id="id8">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span>):</p>
<div class="math notranslate nohighlight" id="equation-eq-i-reduced-lf-2-45-vol1">
<span class="eqno">(3.14)<a class="headerlink" href="#equation-eq-i-reduced-lf-2-45-vol1" title="Permalink to this equation">#</a></span>\[
I(\theta,\phi;\,k)=\sum_{ll'}\sum_{\lambda\lambda'}\sum_{mm'}\gamma_{\alpha\alpha_{+}l\lambda ml'\lambda'm'}\boldsymbol{r}_{kl\lambda}\boldsymbol{r}_{kl'\lambda'}e^{i(\eta_{l\lambda}(k)-\eta_{l'\lambda'}(k))}Y_{lm}(\hat{k})Y_{l'm'}^{*}(\hat{k})
\]</div>
<p>In this form <span class="math notranslate nohighlight">\(\alpha\)</span> denotes all other quantum numbers required to define the initial state, and <span class="math notranslate nohighlight">\(\alpha_{+}\)</span> the final state of the molecular ion. The radial matrix elements <span class="math notranslate nohighlight">\(\boldsymbol{r}_{kl\lambda}\)</span>, denote an integral over the radial part of the wavefunctions, in this case labelled by the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> quantum numbers, and the associated scattering phase is given by <span class="math notranslate nohighlight">\(\eta_{l\lambda}(k)\)</span> (i.e. the matrix elements are written in magnitude-phase form, rather than complex form).The <span class="math notranslate nohighlight">\(\gamma\)</span> terms denotes a general set of geometric paramters arising from the coherent square.  A tensor form is also given herein, see <a class="reference internal" href="theory_tensor_formalism_201122.html#sec-full-tensor-expansion"><span class="std std-numref">Sect. 3.3.2</span></a>, including a full breakdown of these terms and numerical implementation. Comparison with Eq. <a class="reference internal" href="theory_observables_intro_211122.html#equation-eq-af-pad-general">(3.1)</a> then indicates that the amplitudes
in Eq. <a class="reference internal" href="#equation-eq-r-kllam">(3.11)</a> also determine the observable anisotropy
parameters <span class="math notranslate nohighlight">\(\beta_{L,M}(\epsilon,t)\)</span> (Eqn.
<a class="reference internal" href="theory_observables_intro_211122.html#equation-eq-af-pad-general">(3.1)</a>), which basically collect all the terms in Eq. <a class="reference internal" href="#equation-eq-i-reduced-lf-2-45-vol1">(3.14)</a> and the product over spherical harmonics, into a result set of <span class="math notranslate nohighlight">\((L,M)\)</span>. (Note that the photoelectron energy
<span class="math notranslate nohighlight">\(\epsilon\)</span> and momentum <span class="math notranslate nohighlight">\(k\)</span> are used somewhat interchangeably herein,
with the former usually preferred in reference to observables.)</p>
<p>Note, also, that in the treatment above there is no time-dependence
incorporated in the notation; however, a time-dependent treatment
readily follows, and may be incorporated either as explicit
time-dependent modulations in the expansion of the wavefunctions for a
given case, or implicitly in the radial matrix elements. Examples of the
former include, e.g. a rotational or vibrational wavepacket, or a
time-dependent laser field. The rotational wavepacket case is discussed
herein (see <a class="reference internal" href="theory_tensor_formalism_201122.html#sec-full-tensor-expansion"><span class="std std-numref">Sect. 3.3.2</span></a>). The radial matrix elements are
a sensitive function of molecular geometry and electronic configuration
in general, hence may be considered to be responsive to molecular
dynamics, although they are formally time-independent in a
Born-Oppenheimer basis - for further general discussion and examples see
Ref. <span id="id9">[<a class="reference internal" href="../backmatter/bibliography.html#id867" title="Guorong Wu, Paul Hockett, and Albert Stolow. Time-resolved photoelectron spectroscopy: from wavepackets to observables. Physical chemistry chemical physics : PCCP, 13(41):18447–67, November 2011. URL: http://pubs.rsc.org/en/content/articlelanding/2011/cp/c1cp22031d, doi:10.1039/c1cp22031d.">46</a>]</span> and <em>Quantum Metrology</em> Vol. 1 <span id="id10">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span>; discussions of more
complex cases with electronic and nuclear dynamics can be found in Refs.
<span id="id11">[<a class="reference internal" href="../backmatter/bibliography.html#id791" title="Tamar Seideman. Time-resolved photoelectron angular distributions as a probe of coupled polyatomic dynamics. Physical Review A, 64(4):042504, September 2001. URL: http://link.aps.org/doi/10.1103/PhysRevA.64.042504 (visited on 2013-03-14), doi:10.1103/PhysRevA.64.042504.">42</a>, <a class="reference internal" href="../backmatter/bibliography.html#id457" title="Yasuki Arasaki, Kazuo Takatsuka, Kwanghsi Wang, and Vincent McKoy. Probing wavepacket dynamics with femtosecond energy- and angle-resolved photoelectron spectroscopy. Journal of Electron Spectroscopy and Related Phenomena, 108(1-3):89–98, 2000. URL: http://www.sciencedirect.com/science/article/B6TGC-40T9H2X-B/2/ea056307101b30df942fc8387a61867d, doi:DOI: 10.1016/S0368-2048(00)00148-1.">47</a>, <a class="reference internal" href="../backmatter/bibliography.html#id815" title="Toshinori Suzuki and Benjamin J. Whitaker. Non-adiabatic effects in chemistry revealed by time-resolved charged-particle imaging. International Reviews in Physical Chemistry, 20(3):313–356, July 2001. URL: http://www.tandfonline.com/doi/abs/10.1080/01442350110045046 (visited on 2012-07-17), doi:10.1080/01442350110045046.">48</a>, <a class="reference internal" href="../backmatter/bibliography.html#id812" title="Albert Stolow and Jonathan G. Underwood. Time-Resolved Photoelectron Spectroscopy of Non-Adiabatic Dynamics in Polyatomic Molecules. In Stuart A. Rice, editor, Advances in Chemical Physics, volume 139, pages 497–584. John Wiley &amp; Sons, Inc., Hoboken, NJ, USA, March 2008. URL: http://doi.wiley.com/10.1002/9780470259498 (visited on 2012-07-18), doi:10.1002/9780470259498.ch6.">49</a>]</span>.</p>
<p>Typically, for reconstruction experiments, a given measurement will be
selected to simplify this as much as possible by, e.g., populating only
a single ionic state (or states for which the corresponding observables
are experimentally energetically-resolvable), and with a bandwidth
<span class="math notranslate nohighlight">\(d\bf{k}\)</span> which is small enough such that the matrix elements can be
assumed constant over the observation window. Importantly, the angle-resolved observables are
sensitive to the magnitudes and (relative) phases of these matrix
elements - as emphasised in the magnitude-phase form of Eq. <a class="reference internal" href="#equation-eq-i-reduced-lf-2-45-vol1">(3.14)</a> - and can be considered as angular interferograms.</p>
</section>
<section id="symmetry-in-photoionization">
<span id="sec-theory-symmetry-intro"></span><h2><span class="section-number">3.2.2. </span>Symmetry in photoionization<a class="headerlink" href="#symmetry-in-photoionization" title="Permalink to this heading">#</a></h2>
<p>Symmetry in photoionization has briefly been suggested by the introduction of symmetrized harmonics (<a class="reference internal" href="theory_observables_intro_211122.html#sec-theory-sym-harm-into"><span class="std std-numref">Sect. 3.1.2</span></a>), and is discussed in detail in <em>Quantum Metrology</em> Vol. 1 <span id="id12">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span> (Sect. 2.2.3.3). Herein a brief review is given, with a focus on using symmetry in matrix element retrieval problems. For further details, see <em>Quantum Metrology</em> Vol. 1 <span id="id13">[<a class="reference internal" href="../backmatter/bibliography.html#id613" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">1</a>]</span>; for a more general discussion of symmetry in molecular spectroscopy see the textbook by  Bunker and Jensen <span id="id14">[<a class="reference internal" href="../backmatter/bibliography.html#id489" title="P R Bunker and P Jensen. Molecular Symmetry and Spectroscopy. NRC Research Press, Ottawa, second edition, 1998.">50</a>]</span>, and the specific case of photoionization is expanded on in the work of Signorell and Merkt <span id="id15">[<a class="reference internal" href="../backmatter/bibliography.html#id797" title="R Signorell and F Merkt. General symmetry selection rules for the photoionization of polyatomic molecules. Molecular Physics, 92(5):793–804, 1997. doi:10.1080/002689797169745.">51</a>]</span>.</p>
<p>In general, for the dipole matrix element to be non-zero the direct product of the initial state, final state and dipole operator symmetries must contain the totally symmetric representation of the molecular symmetry (<a class="reference internal" href="../backmatter/glossary.html#term-MS"><span class="xref std std-term">MS</span></a>) group, which is isomorphic to the point group (<a class="reference internal" href="../backmatter/glossary.html#term-PG"><span class="xref std std-term">PG</span></a>) in rigid molecules. This general case can be written as:</p>
<div class="math notranslate nohighlight" id="equation-eq-rovib-selection-symm">
<span class="eqno">(3.15)<a class="headerlink" href="#equation-eq-rovib-selection-symm" title="Permalink to this equation">#</a></span>\[
\Gamma_{rve}^{f}\otimes\Gamma_{dipole}\otimes\Gamma_{rve}^{i}\supset\Gamma^{s}
\]</div>
<p>Where <span class="math notranslate nohighlight">\(\Gamma_{rve}\)</span> is the rovibronic symmetry of the system (i.e. total symmetry excluding spin), with the <span class="math notranslate nohighlight">\(i/f\)</span> superscript denoting
initial and final states respectively. <span class="math notranslate nohighlight">\(\Gamma^{s}\)</span> is the totally symmetric representation in the appropriate molecular symmetry group,
and <span class="math notranslate nohighlight">\(\Gamma_{dipole}\)</span> is the symmetry of the dipole operator.</p>
<p>For the specific case of photoionization the final state is split into the symmetry species of the ion and the photoelectron <span id="id16">[<a class="reference internal" href="../backmatter/bibliography.html#id797" title="R Signorell and F Merkt. General symmetry selection rules for the photoionization of polyatomic molecules. Molecular Physics, 92(5):793–804, 1997. doi:10.1080/002689797169745.">51</a>]</span>:</p>
<div class="math notranslate nohighlight" id="equation-eq-ionization-symm">
<span class="eqno">(3.16)<a class="headerlink" href="#equation-eq-ionization-symm" title="Permalink to this equation">#</a></span>\[
\Gamma^{e}\otimes\Gamma_{rve}^{+}\otimes\Gamma_{dipole}\otimes\Gamma_{rve}^{i}\supset\Gamma^{s}
\]</div>
<p>This is, essentially, a statement of the limiting case of Eq. <a class="reference internal" href="#equation-eq-mate-dipole">(3.8)</a> (see also alternative forms of Eqs. <a class="reference internal" href="#equation-eq-r-kllam">(3.11)</a>, <a class="reference internal" href="#equation-eq-r-kllam-integral">(3.12)</a>), which defines the symmetry requirements for the overlap integral to be non-zero (although does not indicate that it will be non-zero for a given system).</p>
<p>In the reconstruction experiments discussed herein, this general form can be often be further simplified. In particular, assuming a full Born-Oppenheimer separation of dynamics, the problem can be treated within the static <a class="reference internal" href="../backmatter/glossary.html#term-PG"><span class="xref std std-term">PG</span></a> of the system, and only the electronic state symmetries need to be taken into account. In practice, this treatment is appropriate for cases with separable rotational wavepackets, and may also be a reasonable approximation for cases with vibronic wavepackets in cases where the nuclear excursions are relatively small and/or can be treated as linear combinations over a set of symmetrized basis functions. Within this approximation the general symmetry requirements can be written as:</p>
<div class="math notranslate nohighlight" id="equation-eq-ionization-symm-electronic">
<span class="eqno">(3.17)<a class="headerlink" href="#equation-eq-ionization-symm-electronic" title="Permalink to this equation">#</a></span>\[
\Gamma^{e(X)}\otimes\Gamma_{e}^{+}\otimes\Gamma_{dipole}\otimes\Gamma_{e}^{i}\supset\Gamma^{s}
\]</div>
<p>And <span class="math notranslate nohighlight">\(\Gamma^{e(X)}\)</span> indicates that the continuum symmetries are expressed in a basis of symmetrized harmonics (<a class="reference internal" href="theory_observables_intro_211122.html#sec-theory-sym-harm-into"><span class="std std-numref">Sect. 3.1.2</span></a>). From Eq. <a class="reference internal" href="#equation-eq-ionization-symm-electronic">(3.17)</a>, the set of allowed matrix elements for a given ionization event can be expressed, in terms of the allowed set of symmetrized harmonics <span class="math notranslate nohighlight">\(X_{hl}^{\Gamma\mu*}(\theta,\phi)\)</span>, or (equivalently) the usual partial wave basis expressed in spherical harmonics <span class="math notranslate nohighlight">\(Y_{l,\lambda}(\theta,\phi)\)</span>, and a set of associated symmetrization coefficients <span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span>.</p>
<p>A brief numerical example is given below, and a more detailed treatment for a range of photoionization cases forms the second half of the book, see <code class="xref std std-numref docutils literal notranslate"><span class="pre">Chapter</span> <span class="pre">%s:</span></code> <span class="xref std std-ref">sec:extracting-matrix-elements-overview</span> for details.</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run default config - may need to set full path here</span>
<span class="o">%</span><span class="k">run</span> &#39;../scripts/setup_notebook.py&#39;

<span class="c1"># Override plotters backend?</span>
<span class="c1"># plotBackend = &#39;pl&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Setting up notebook with standard Quantum Metrology Vol. 3 imports...
For more details see https://pemtk.readthedocs.io/en/latest/fitting/PEMtk_fitting_basic_demo_030621-full.html
To use local source code, pass the parent path to this script at run time, e.g. &quot;setup_fit_demo ~/github&quot;

*** Running: 2023-04-28 09:37:02
Working dir: /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part1
Build env: html

* Loading packages...
* sparse not found, sparse matrix forms not available. 
* natsort not found, some sorting functions not available. 
* Setting plotter defaults with epsproc.basicPlotters.setPlotters(). Run directly to modify, or change options in local env.
* Set Holoviews with bokeh.
* pyevtk not found, VTK export not available. 
* Set Holoviews with bokeh.
Jupyter Book      : 0.15.1
External ToC      : 0.3.1
MyST-Parser       : 0.18.1
MyST-NB           : 0.17.2
Sphinx Book Theme : 1.0.1
Jupyter-Cache     : 0.6.1
NbClient          : 0.5.4
</pre></div>
</div>
<script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@4.2.5/dist/gridstack-h5', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 3;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length;
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/0.14.4/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/0.14.4/dist/bundled/gridstack/gridstack@4.2.5/dist/gridstack-h5.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/0.14.4/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) >= 0) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) >= 0) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/0.14.4/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/0.14.4/dist/bundled/plotlyplot/plotly-2.18.0.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-2.4.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.4.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.4.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.4.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-mathjax-2.4.1.min.js", "https://unpkg.com/@holoviz/panel@0.14.4/dist/panel.min.js"];
  var js_modules = [];
  var css_urls = ["https://cdn.holoviz.org/panel/0.14.4/dist/css/alerts.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/card.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/dataframe.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/debugger.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/json.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/loading.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/markdown.css", "https://cdn.holoviz.org/panel/0.14.4/dist/css/widgets.css"];
  var inline_js = [    function(Bokeh) {
      inject_raw_css("\n    .bk.pn-loading.arc:before {\n      background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW46IGF1dG87IGJhY2tncm91bmQ6IG5vbmU7IGRpc3BsYXk6IGJsb2NrOyBzaGFwZS1yZW5kZXJpbmc6IGF1dG87IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiPiAgPGNpcmNsZSBjeD0iNTAiIGN5PSI1MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjYzNjM2MzIiBzdHJva2Utd2lkdGg9IjEwIiByPSIzNSIgc3Ryb2tlLWRhc2hhcnJheT0iMTY0LjkzMzYxNDMxMzQ2NDE1IDU2Ljk3Nzg3MTQzNzgyMTM4Ij4gICAgPGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBkdXI9IjFzIiB2YWx1ZXM9IjAgNTAgNTA7MzYwIDUwIDUwIiBrZXlUaW1lcz0iMDsxIj48L2FuaW1hdGVUcmFuc2Zvcm0+ICA8L2NpcmNsZT48L3N2Zz4=\");\n      background-size: auto calc(min(50%, 400px));\n    }\n    ");
    },    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, js_modules, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>.bk-root, .bk-root .bk:before, .bk-root .bk:after {
  font-family: var(--jp-ui-font-size1);
  font-size: var(--jp-ui-font-size1);
  color: var(--jp-ui-font-color1);
}
</style></div><div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OMP: Info #271: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example following symmetrized harmonics demo</span>

<span class="c1"># Import class</span>
<span class="kn">from</span> <span class="nn">pemtk.sym.symHarm</span> <span class="kn">import</span> <span class="n">symHarm</span>

<span class="c1"># Compute hamronics for Td, lmax=4</span>
<span class="n">sym</span> <span class="o">=</span> <span class="s1">&#39;D2h&#39;</span>
<span class="n">lmax</span><span class="o">=</span><span class="mi">4</span>

<span class="n">symObj</span> <span class="o">=</span> <span class="n">symHarm</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span><span class="n">lmax</span><span class="p">)</span>

<span class="c1"># Allowed terms and mappings are given in &#39;dipoleSyms&#39;</span>
<span class="n">symObj</span><span class="o">.</span><span class="n">dipole</span><span class="p">[</span><span class="s1">&#39;dipoleSyms&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;it&#39;}
Added dim Eke
Added dim Targ
Added dim Total
Added dim mu
Added dim Type
Found dipole symmetries: 
{&#39;B1u&#39;: {&#39;m&#39;: [0], &#39;pol&#39;: [&#39;z&#39;]}, &#39;B2u&#39;: {&#39;m&#39;: [-1, 1], &#39;pol&#39;: [&#39;y&#39;]}, &#39;B3u&#39;: {&#39;m&#39;: [-1, 1], &#39;pol&#39;: [&#39;x&#39;]}}
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;B1u&#39;: {&#39;m&#39;: [0], &#39;pol&#39;: [&#39;z&#39;]},
 &#39;B2u&#39;: {&#39;m&#39;: [-1, 1], &#39;pol&#39;: [&#39;y&#39;]},
 &#39;B3u&#39;: {&#39;m&#39;: [-1, 1], &#39;pol&#39;: [&#39;x&#39;]}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting the symmetry for the neutral and ion allows direct products to be computed, and allowed terms to be determined.</span>

<span class="n">sNeutral</span> <span class="o">=</span> <span class="s1">&#39;A1g&#39;</span>
<span class="n">sIon</span> <span class="o">=</span> <span class="s1">&#39;B2u&#39;</span>

<span class="n">symObj</span><span class="o">.</span><span class="n">directProductContinuum</span><span class="p">([</span><span class="n">sNeutral</span><span class="p">,</span> <span class="n">sIon</span><span class="p">])</span>

<span class="c1"># Results are pushed to self.continuum, in dictionary and Pandas DataFrame formats, and can be manipulated using standard functionality.</span>
<span class="c1"># The subset of allowed values are also set to a separate DataFrame and list.</span>
<span class="n">symObj</span><span class="o">.</span><span class="n">continuum</span><span class="p">[</span><span class="s1">&#39;allowed&#39;</span><span class="p">][</span><span class="s1">&#39;PD&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_9c9c0_row0_col0, #T_9c9c0_row0_col1, #T_9c9c0_row0_col2, #T_9c9c0_row0_col3, #T_9c9c0_row0_col4, #T_9c9c0_row1_col0, #T_9c9c0_row1_col1, #T_9c9c0_row1_col2, #T_9c9c0_row1_col3, #T_9c9c0_row1_col4, #T_9c9c0_row2_col0, #T_9c9c0_row2_col1, #T_9c9c0_row2_col2, #T_9c9c0_row2_col3, #T_9c9c0_row2_col4, #T_9c9c0_row3_col0, #T_9c9c0_row3_col1, #T_9c9c0_row3_col2, #T_9c9c0_row3_col3, #T_9c9c0_row3_col4, #T_9c9c0_row5_col0, #T_9c9c0_row5_col1, #T_9c9c0_row5_col2, #T_9c9c0_row5_col3, #T_9c9c0_row5_col4, #T_9c9c0_row6_col0, #T_9c9c0_row6_col1, #T_9c9c0_row6_col2, #T_9c9c0_row6_col3, #T_9c9c0_row6_col4, #T_9c9c0_row7_col0, #T_9c9c0_row7_col1, #T_9c9c0_row7_col2, #T_9c9c0_row7_col3, #T_9c9c0_row7_col4, #T_9c9c0_row9_col0, #T_9c9c0_row9_col1, #T_9c9c0_row9_col2, #T_9c9c0_row9_col3, #T_9c9c0_row9_col4, #T_9c9c0_row10_col0, #T_9c9c0_row10_col1, #T_9c9c0_row10_col2, #T_9c9c0_row10_col3, #T_9c9c0_row10_col4, #T_9c9c0_row11_col0, #T_9c9c0_row11_col1, #T_9c9c0_row11_col2, #T_9c9c0_row11_col3, #T_9c9c0_row11_col4, #T_9c9c0_row12_col0, #T_9c9c0_row12_col1, #T_9c9c0_row12_col2, #T_9c9c0_row12_col3, #T_9c9c0_row12_col4, #T_9c9c0_row13_col0, #T_9c9c0_row13_col1, #T_9c9c0_row13_col2, #T_9c9c0_row13_col3, #T_9c9c0_row13_col4, #T_9c9c0_row14_col0, #T_9c9c0_row14_col1, #T_9c9c0_row14_col2, #T_9c9c0_row14_col3, #T_9c9c0_row14_col4, #T_9c9c0_row15_col0, #T_9c9c0_row15_col1, #T_9c9c0_row15_col2, #T_9c9c0_row15_col3, #T_9c9c0_row15_col4, #T_9c9c0_row16_col0, #T_9c9c0_row16_col1, #T_9c9c0_row16_col2, #T_9c9c0_row16_col3, #T_9c9c0_row16_col4, #T_9c9c0_row18_col0, #T_9c9c0_row18_col1, #T_9c9c0_row18_col2, #T_9c9c0_row18_col3, #T_9c9c0_row18_col4, #T_9c9c0_row19_col0, #T_9c9c0_row19_col1, #T_9c9c0_row19_col2, #T_9c9c0_row19_col3, #T_9c9c0_row19_col4, #T_9c9c0_row20_col0, #T_9c9c0_row20_col1, #T_9c9c0_row20_col2, #T_9c9c0_row20_col3, #T_9c9c0_row20_col4, #T_9c9c0_row21_col0, #T_9c9c0_row21_col1, #T_9c9c0_row21_col2, #T_9c9c0_row21_col3, #T_9c9c0_row21_col4, #T_9c9c0_row22_col0, #T_9c9c0_row22_col1, #T_9c9c0_row22_col2, #T_9c9c0_row22_col3, #T_9c9c0_row22_col4, #T_9c9c0_row23_col0, #T_9c9c0_row23_col1, #T_9c9c0_row23_col2, #T_9c9c0_row23_col3, #T_9c9c0_row23_col4 {
  background-color: lightgrey;
}
#T_9c9c0_row4_col0, #T_9c9c0_row4_col1, #T_9c9c0_row4_col2, #T_9c9c0_row4_col3, #T_9c9c0_row4_col4, #T_9c9c0_row8_col0, #T_9c9c0_row8_col1, #T_9c9c0_row8_col2, #T_9c9c0_row8_col3, #T_9c9c0_row8_col4, #T_9c9c0_row17_col0, #T_9c9c0_row17_col1, #T_9c9c0_row17_col2, #T_9c9c0_row17_col3, #T_9c9c0_row17_col4 {
  background-color: yellow;
}
</style>
<table id="T_9c9c0_">
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th class="col_heading level0 col0" >allowed</th>
      <th class="col_heading level0 col1" >m</th>
      <th class="col_heading level0 col2" >pol</th>
      <th class="col_heading level0 col3" >result</th>
      <th class="col_heading level0 col4" >terms</th>
    </tr>
    <tr>
      <th class="index_name level0" >Dipole</th>
      <th class="index_name level1" >Target</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_9c9c0_level0_row0" class="row_heading level0 row0" rowspan="8">B1u</th>
      <th id="T_9c9c0_level1_row0" class="row_heading level1 row0" >A1g</th>
      <td id="T_9c9c0_row0_col0" class="data row0 col0" >False</td>
      <td id="T_9c9c0_row0_col1" class="data row0 col1" >[0]</td>
      <td id="T_9c9c0_row0_col2" class="data row0 col2" >['z']</td>
      <td id="T_9c9c0_row0_col3" class="data row0 col3" >['B3g']</td>
      <td id="T_9c9c0_row0_col4" class="data row0 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row1" class="row_heading level1 row1" >B1g</th>
      <td id="T_9c9c0_row1_col0" class="data row1 col0" >False</td>
      <td id="T_9c9c0_row1_col1" class="data row1 col1" >[0]</td>
      <td id="T_9c9c0_row1_col2" class="data row1 col2" >['z']</td>
      <td id="T_9c9c0_row1_col3" class="data row1 col3" >['B2g']</td>
      <td id="T_9c9c0_row1_col4" class="data row1 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row2" class="row_heading level1 row2" >A1u</th>
      <td id="T_9c9c0_row2_col0" class="data row2 col0" >False</td>
      <td id="T_9c9c0_row2_col1" class="data row2 col1" >[0]</td>
      <td id="T_9c9c0_row2_col2" class="data row2 col2" >['z']</td>
      <td id="T_9c9c0_row2_col3" class="data row2 col3" >['B3u']</td>
      <td id="T_9c9c0_row2_col4" class="data row2 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row3" class="row_heading level1 row3" >B1u</th>
      <td id="T_9c9c0_row3_col0" class="data row3 col0" >False</td>
      <td id="T_9c9c0_row3_col1" class="data row3 col1" >[0]</td>
      <td id="T_9c9c0_row3_col2" class="data row3 col2" >['z']</td>
      <td id="T_9c9c0_row3_col3" class="data row3 col3" >['B2u']</td>
      <td id="T_9c9c0_row3_col4" class="data row3 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row4" class="row_heading level1 row4" >B3g</th>
      <td id="T_9c9c0_row4_col0" class="data row4 col0" >True</td>
      <td id="T_9c9c0_row4_col1" class="data row4 col1" >[0]</td>
      <td id="T_9c9c0_row4_col2" class="data row4 col2" >['z']</td>
      <td id="T_9c9c0_row4_col3" class="data row4 col3" >['A1g']</td>
      <td id="T_9c9c0_row4_col4" class="data row4 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row5" class="row_heading level1 row5" >B3u</th>
      <td id="T_9c9c0_row5_col0" class="data row5 col0" >False</td>
      <td id="T_9c9c0_row5_col1" class="data row5 col1" >[0]</td>
      <td id="T_9c9c0_row5_col2" class="data row5 col2" >['z']</td>
      <td id="T_9c9c0_row5_col3" class="data row5 col3" >['A1u']</td>
      <td id="T_9c9c0_row5_col4" class="data row5 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row6" class="row_heading level1 row6" >B2g</th>
      <td id="T_9c9c0_row6_col0" class="data row6 col0" >False</td>
      <td id="T_9c9c0_row6_col1" class="data row6 col1" >[0]</td>
      <td id="T_9c9c0_row6_col2" class="data row6 col2" >['z']</td>
      <td id="T_9c9c0_row6_col3" class="data row6 col3" >['B1g']</td>
      <td id="T_9c9c0_row6_col4" class="data row6 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row7" class="row_heading level1 row7" >B2u</th>
      <td id="T_9c9c0_row7_col0" class="data row7 col0" >False</td>
      <td id="T_9c9c0_row7_col1" class="data row7 col1" >[0]</td>
      <td id="T_9c9c0_row7_col2" class="data row7 col2" >['z']</td>
      <td id="T_9c9c0_row7_col3" class="data row7 col3" >['B1u']</td>
      <td id="T_9c9c0_row7_col4" class="data row7 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level0_row8" class="row_heading level0 row8" rowspan="8">B2u</th>
      <th id="T_9c9c0_level1_row8" class="row_heading level1 row8" >A1g</th>
      <td id="T_9c9c0_row8_col0" class="data row8 col0" >True</td>
      <td id="T_9c9c0_row8_col1" class="data row8 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row8_col2" class="data row8 col2" >['y']</td>
      <td id="T_9c9c0_row8_col3" class="data row8 col3" >['A1g']</td>
      <td id="T_9c9c0_row8_col4" class="data row8 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row9" class="row_heading level1 row9" >B1g</th>
      <td id="T_9c9c0_row9_col0" class="data row9 col0" >False</td>
      <td id="T_9c9c0_row9_col1" class="data row9 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row9_col2" class="data row9 col2" >['y']</td>
      <td id="T_9c9c0_row9_col3" class="data row9 col3" >['B1g']</td>
      <td id="T_9c9c0_row9_col4" class="data row9 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row10" class="row_heading level1 row10" >A1u</th>
      <td id="T_9c9c0_row10_col0" class="data row10 col0" >False</td>
      <td id="T_9c9c0_row10_col1" class="data row10 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row10_col2" class="data row10 col2" >['y']</td>
      <td id="T_9c9c0_row10_col3" class="data row10 col3" >['A1u']</td>
      <td id="T_9c9c0_row10_col4" class="data row10 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row11" class="row_heading level1 row11" >B1u</th>
      <td id="T_9c9c0_row11_col0" class="data row11 col0" >False</td>
      <td id="T_9c9c0_row11_col1" class="data row11 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row11_col2" class="data row11 col2" >['y']</td>
      <td id="T_9c9c0_row11_col3" class="data row11 col3" >['B1u']</td>
      <td id="T_9c9c0_row11_col4" class="data row11 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row12" class="row_heading level1 row12" >B3g</th>
      <td id="T_9c9c0_row12_col0" class="data row12 col0" >False</td>
      <td id="T_9c9c0_row12_col1" class="data row12 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row12_col2" class="data row12 col2" >['y']</td>
      <td id="T_9c9c0_row12_col3" class="data row12 col3" >['B3g']</td>
      <td id="T_9c9c0_row12_col4" class="data row12 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row13" class="row_heading level1 row13" >B3u</th>
      <td id="T_9c9c0_row13_col0" class="data row13 col0" >False</td>
      <td id="T_9c9c0_row13_col1" class="data row13 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row13_col2" class="data row13 col2" >['y']</td>
      <td id="T_9c9c0_row13_col3" class="data row13 col3" >['B3u']</td>
      <td id="T_9c9c0_row13_col4" class="data row13 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row14" class="row_heading level1 row14" >B2g</th>
      <td id="T_9c9c0_row14_col0" class="data row14 col0" >False</td>
      <td id="T_9c9c0_row14_col1" class="data row14 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row14_col2" class="data row14 col2" >['y']</td>
      <td id="T_9c9c0_row14_col3" class="data row14 col3" >['B2g']</td>
      <td id="T_9c9c0_row14_col4" class="data row14 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row15" class="row_heading level1 row15" >B2u</th>
      <td id="T_9c9c0_row15_col0" class="data row15 col0" >False</td>
      <td id="T_9c9c0_row15_col1" class="data row15 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row15_col2" class="data row15 col2" >['y']</td>
      <td id="T_9c9c0_row15_col3" class="data row15 col3" >['B2u']</td>
      <td id="T_9c9c0_row15_col4" class="data row15 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level0_row16" class="row_heading level0 row16" rowspan="8">B3u</th>
      <th id="T_9c9c0_level1_row16" class="row_heading level1 row16" >A1g</th>
      <td id="T_9c9c0_row16_col0" class="data row16 col0" >False</td>
      <td id="T_9c9c0_row16_col1" class="data row16 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row16_col2" class="data row16 col2" >['x']</td>
      <td id="T_9c9c0_row16_col3" class="data row16 col3" >['B1g']</td>
      <td id="T_9c9c0_row16_col4" class="data row16 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row17" class="row_heading level1 row17" >B1g</th>
      <td id="T_9c9c0_row17_col0" class="data row17 col0" >True</td>
      <td id="T_9c9c0_row17_col1" class="data row17 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row17_col2" class="data row17 col2" >['x']</td>
      <td id="T_9c9c0_row17_col3" class="data row17 col3" >['A1g']</td>
      <td id="T_9c9c0_row17_col4" class="data row17 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row18" class="row_heading level1 row18" >A1u</th>
      <td id="T_9c9c0_row18_col0" class="data row18 col0" >False</td>
      <td id="T_9c9c0_row18_col1" class="data row18 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row18_col2" class="data row18 col2" >['x']</td>
      <td id="T_9c9c0_row18_col3" class="data row18 col3" >['B1u']</td>
      <td id="T_9c9c0_row18_col4" class="data row18 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row19" class="row_heading level1 row19" >B1u</th>
      <td id="T_9c9c0_row19_col0" class="data row19 col0" >False</td>
      <td id="T_9c9c0_row19_col1" class="data row19 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row19_col2" class="data row19 col2" >['x']</td>
      <td id="T_9c9c0_row19_col3" class="data row19 col3" >['A1u']</td>
      <td id="T_9c9c0_row19_col4" class="data row19 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row20" class="row_heading level1 row20" >B3g</th>
      <td id="T_9c9c0_row20_col0" class="data row20 col0" >False</td>
      <td id="T_9c9c0_row20_col1" class="data row20 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row20_col2" class="data row20 col2" >['x']</td>
      <td id="T_9c9c0_row20_col3" class="data row20 col3" >['B2g']</td>
      <td id="T_9c9c0_row20_col4" class="data row20 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row21" class="row_heading level1 row21" >B3u</th>
      <td id="T_9c9c0_row21_col0" class="data row21 col0" >False</td>
      <td id="T_9c9c0_row21_col1" class="data row21 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row21_col2" class="data row21 col2" >['x']</td>
      <td id="T_9c9c0_row21_col3" class="data row21 col3" >['B2u']</td>
      <td id="T_9c9c0_row21_col4" class="data row21 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row22" class="row_heading level1 row22" >B2g</th>
      <td id="T_9c9c0_row22_col0" class="data row22 col0" >False</td>
      <td id="T_9c9c0_row22_col1" class="data row22 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row22_col2" class="data row22 col2" >['x']</td>
      <td id="T_9c9c0_row22_col3" class="data row22 col3" >['B3g']</td>
      <td id="T_9c9c0_row22_col4" class="data row22 col4" >['A1g', 'B2u']</td>
    </tr>
    <tr>
      <th id="T_9c9c0_level1_row23" class="row_heading level1 row23" >B2u</th>
      <td id="T_9c9c0_row23_col0" class="data row23 col0" >False</td>
      <td id="T_9c9c0_row23_col1" class="data row23 col1" >[-1, 1]</td>
      <td id="T_9c9c0_row23_col2" class="data row23 col2" >['x']</td>
      <td id="T_9c9c0_row23_col3" class="data row23 col3" >['B3u']</td>
      <td id="T_9c9c0_row23_col4" class="data row23 col4" >['A1g', 'B2u']</td>
    </tr>
  </tbody>
</table>
</div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>allowed</th>
      <th>m</th>
      <th>pol</th>
      <th>result</th>
      <th>terms</th>
    </tr>
    <tr>
      <th>Dipole</th>
      <th>Target</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>B1u</th>
      <th>B3g</th>
      <td>True</td>
      <td>[0]</td>
      <td>[z]</td>
      <td>[A1g]</td>
      <td>[A1g, B2u]</td>
    </tr>
    <tr>
      <th>B2u</th>
      <th>A1g</th>
      <td>True</td>
      <td>[-1, 1]</td>
      <td>[y]</td>
      <td>[A1g]</td>
      <td>[A1g, B2u]</td>
    </tr>
    <tr>
      <th>B3u</th>
      <th>B1g</th>
      <td>True</td>
      <td>[-1, 1]</td>
      <td>[x]</td>
      <td>[A1g]</td>
      <td>[A1g, B2u]</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Ylm basis table with the Character values limited to those defined in self.continuum[&#39;allowed&#39;][&#39;PD&#39;] Target column</span>
<span class="n">symObj</span><span class="o">.</span><span class="n">displayXlm</span><span class="p">(</span><span class="n">symFilter</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>  
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="5" halign="left">b</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>l</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
    <tr>
      <th>Character ($\Gamma$)</th>
      <th>SALC (h)</th>
      <th>PFIX ($\mu$)</th>
      <th>m</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="6" valign="top">A1g</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <td>1.0</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <th>2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <th>0</th>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>5</th>
      <th>0</th>
      <th>4</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B1g</th>
      <th>0</th>
      <th>0</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>-4</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">B3g</th>
      <th>0</th>
      <th>0</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>1.0</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>-3</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>1.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part1"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="theory_observables_intro_211122.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">3.1. </span>Observables: photoelectron flux in the LF and MF</p>
      </div>
    </a>
    <a class="right-next"
       href="theory_tensor_formalism_201122.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">3.3. </span>Tensor formulation of photoionization</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#general-forms">3.2.1. General forms</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-in-photoionization">3.2.2. Symmetry in photoionization</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Hockett with Varun Makhija
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>