

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>6. Basis sets for fitting &#8212; Quantum Metrology with Photoelectrons Vol. 3 *Analysis methodologies*</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"bm": ["\\boldsymbol{#1}", 1]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'part2/sym-fitting-intro_240723';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. General fit setup and numerics" href="basic_fitting_numerics_intro_260723.html" />
    <link rel="prev" title="5. Extracting matrix elements overview" href="extracting_matrix_elements_overview_270423.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/ePSproc_logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/ePSproc_logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Quantum Metrology with Photoelectrons Vol. 3: Analysis methodologies
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Frontmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/about_the_authors.html">About the authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/abstract.html">Abstract</a></li>
<li class="toctree-l1"><a class="reference internal" href="../frontmatter/book_versions_note.html">A note on book versions, formats and conventions</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part I - Theory &amp; software</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../part1/main_intro_060723.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../part1/platform_intro_070723.html">2. Quantum metrology software platform/ecosystem overview</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../part1/theory_100723.html">3. Theory</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_photoionization_dynamics_140723.html">3.1. Photoionization dynamics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_symmetry_140723.html">3.2. Symmetry in photoionization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_tensor_formalism_160723.html">3.3. Tensor formulation of photoionization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_density_matrices_190723.html">3.4. Density matrix representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_molecular_alignment_170723.html">3.5. Molecular alignment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_observables_intro_100723.html">3.6. Observables: photoelectron flux in the LF and MF</a></li>
<li class="toctree-l2"><a class="reference internal" href="../part1/theory_info_content_200723.html">3.7. Information content &amp; sensitivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../part1/numerics_070723.html">4. Numerical methodologies for extracting matrix elements</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Part II - Extracting matrix elements - numerical methods &amp; case studies</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="extracting_matrix_elements_overview_270423.html">5. Extracting matrix elements overview</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6. Basis sets for fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="basic_fitting_numerics_intro_260723.html">7. General fit setup and numerics</a></li>
<li class="toctree-l1"><a class="reference internal" href="case-study-N2_290723.html">8. Case study: Generalised bootstrapping for a homonuclear diatomic scattering system, <span class="math notranslate nohighlight">\(N_2~(D_{\infty h})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="case-study-OCS_290723.html">9. Case study: Generalised bootstrapping for a linear heteronuclear scattering system, <span class="math notranslate nohighlight">\(OCS~(C_{\infty v})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="case-study-C2H4_290723.html">10. Case study: Generalised bootstrapping for a general asymmetric top scattering system, <span class="math notranslate nohighlight">\(C_2H_4~(D_{2h})\)</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="case-study-summaries_240723.html">11. Case studies: summaries, conclusions and outlook</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Backmatter</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../backmatter/bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../backmatter/glossary.html">Glossary</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Builds and versions</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../tests/build_versions_checks.html">Build versions and config tests</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/phockett/Quantum-Metrology-with-Photoelectrons-Vol3" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/phockett/Quantum-Metrology-with-Photoelectrons-Vol3/issues/new?title=Issue%20on%20page%20%2Fpart2/sym-fitting-intro_240723.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/part2/sym-fitting-intro_240723.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Basis sets for fitting</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-defined-basis-sets">6.1. Symmetry-defined basis sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computationally-defined-basis-sets">6.2. Computationally-defined basis sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-creation-worked-examples">6.3. Basis creation worked examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-case-n-2-3-sigma-g-1-ionization">6.3.1. Simple case: <span class="math notranslate nohighlight">\(N_2~3\sigma_g^{-1}\)</span> ionization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degenerate-case-example-n-2-3-pi-u-1-ionization">6.3.2. Degenerate case example: <span class="math notranslate nohighlight">\(N_2~3\pi_u^{-1}\)</span> ionization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-symmetrized-harmonics">6.3.3. Defining symmetrized harmonics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-symmetrized-harmonics-to-fit-parameters">6.3.4. Mapping symmetrized harmonics to fit parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#remapping-to-epolyscat-definitions">6.3.4.1. Remapping to ePolyScat definitions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-to-fitting-parameters-and-reduction">6.3.4.2. Mapping to fitting parameters (and reduction)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-symmetry-defined-and-computational-matrix-elements">6.4. Comparison with symmetry-defined and computational matrix elements</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="basis-sets-for-fitting">
<span id="sect-basis-sets-fitting-intro"></span><h1><span class="section-number">6. </span>Basis sets for fitting<a class="headerlink" href="#basis-sets-for-fitting" title="Permalink to this heading">#</a></h1>
<p>As outlined in Part I, particularly <a class="reference internal" href="../part1/theory_100723.html#chpt-theory"><span class="std std-numref">Chpt. 3</span></a>, in order to compute and/or retrieve a set of matrix elements from experimental results, various physical properties of the system at hand are required. In particular, the symmetry of the system, the ionizing channel(s) of interest, and the properties of the ionizing radiation are all required to define the basis set used for <a class="reference internal" href="../backmatter/glossary.html#term-radial-matrix-elements"><span class="xref std std-term">radial matrix elements</span></a> retrieval via fitting (<a class="reference internal" href="../part1/numerics_070723.html#chpt-numerical-details"><span class="std std-numref">Chpt. 4</span></a>).</p>
<p>Numerically, there are two main methods to do this demonstrated herein:</p>
<ol class="arabic simple">
<li><p>The use of symmetry to define the basis set, in terms of symmetry-allowed components.</p></li>
<li><p>The use of <em>ab initio</em> calculations to define the basis functions. In the work presented here, it is specifically <a class="reference external" href="https://epolyscat.droppages.com/">ePolyScat (ePS)</a> <span id="id1">[<a class="reference internal" href="../backmatter/bibliography.html#id764" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18), doi:10.1016/0370-1573(86)90147-X.">36</a>, <a class="reference internal" href="../backmatter/bibliography.html#id628" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13), doi:10.1063/1.467237.">37</a>, <a class="reference internal" href="../backmatter/bibliography.html#id805" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18), doi:10.1063/1.479794.">38</a>, <a class="reference internal" href="../backmatter/bibliography.html#id767" title="R R Lucchese. ePolyScat User's Manual. URL: https://epolyscat.droppages.com/ (visited on 2022-04-26).">39</a>]</span> matrix elements that are used, since these are also used to generate the synthetic data used to test the <a class="reference internal" href="../backmatter/glossary.html#term-bootstrap-retrieval-protocol"><span class="xref std std-term">bootstrap retrieval protocol</span></a>.</p></li>
</ol>
<p>Manual creation of basis sets is also possible, and may be useful in some cases, particularly when exploring limiting cases.</p>
<section id="symmetry-defined-basis-sets">
<h2><span class="section-number">6.1. </span>Symmetry-defined basis sets<a class="headerlink" href="#symmetry-defined-basis-sets" title="Permalink to this heading">#</a></h2>
<p>As illustrated in <a class="reference internal" href="../part1/theory_symmetry_140723.html#sec-theory-symmetry-intro"><span class="std std-numref">Sect. 3.2</span></a>, a set of symmetry-allowed continuum functions can be determined, corresponding to a given ionizing transition and specific dipole symmetries. Such a basis set defines the allowed matrix elements in terms of a set of symmetrized harmonics, and these can be used as a basis for fitting with only minimal knowledge of the system required.</p>
<p>The main advantage of a purely symmetry-defined approach is that no additional <em>ab initio</em> computations are required, and that the resulting basis set is general. As discussed and illustrated in <a class="reference internal" href="../part1/theory_tensor_formalism_160723.html#sec-tensor-formulation"><span class="std std-numref">Sect. 3.3</span></a>, the resulting <a class="reference internal" href="../backmatter/glossary.html#term-channel-functions"><span class="xref std std-term">channel functions</span></a> can also be used to guide analysis (and experiment if available prior to experimental work). The main disadvantage of such a blind approach is that initial data analysis may require significantly more effort than working from a computationally-defined basis, in particular the initial fitting space may be larger than required (leading to computationally more-demanding fitting runs), and testing for contributing/non-negligible terms by, e.g. using varying <span class="math notranslate nohighlight">\(l_{max}\)</span>, may be required in initial fitting runs. For further discussion, see <em>Quantum Metrology</em> Vols. 1 &amp; 2 <span id="id2">[<a class="reference internal" href="../backmatter/bibliography.html#id677" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 1: Foundations. IOP Publishing, 2018. ISBN 978-1-68174-684-5. URL: http://iopscience.iop.org/book/978-1-6817-4684-5, doi:10.1088/978-1-6817-4684-5.">4</a>, <a class="reference internal" href="../backmatter/bibliography.html#id678" title="Paul Hockett. Quantum Metrology with Photoelectrons, Volume 2: Applications and Advances. IOP Publishing, 2018. ISBN 978-1-68174-688-3. URL: http://iopscience.iop.org/book/978-1-6817-4688-3, doi:10.1088/978-1-6817-4688-3.">9</a>]</span>.</p>
</section>
<section id="computationally-defined-basis-sets">
<h2><span class="section-number">6.2. </span>Computationally-defined basis sets<a class="headerlink" href="#computationally-defined-basis-sets" title="Permalink to this heading">#</a></h2>
<p>In cases where photoionization calculations are available, the results can also be used to determine allowed basis components. Use of <em>ab initio</em> computational results is, of course, useful for simulation as well as direct analysis, and may lead to a reduced basis set relative to the symmetry-defined case, since some components may be small and can be ignored. However, it does also require that substantial calculations are performed (or results are available, e.g. from <a class="reference external" href="https://phockett.github.io/ePSdata/about.html">ePSdata</a> <span id="id3">[<a class="reference internal" href="../backmatter/bibliography.html#id679" title="Paul Hockett. ePS data: Photoionization calculations archive. 2019. URL: https://phockett.github.io/ePSdata/ (visited on 2022-02-16).">48</a>]</span>), and - potentially - may bias the matrix element analysis/retrieval in cases where the experimental results and computational results are significantly different.</p>
</section>
<section id="basis-creation-worked-examples">
<h2><span class="section-number">6.3. </span>Basis creation worked examples<a class="headerlink" href="#basis-creation-worked-examples" title="Permalink to this heading">#</a></h2>
<p>In the case study chapters, basis functions are created for each case at hand, typically starting from <em>ab initio</em> computational results (since these are required to simulate the sample data). Here a more detailed worked example is given to illustrate the basic methodology behind the assignments, the differences between the approaches, and highlight some issues of convention which may arise.</p>
<section id="simple-case-n-2-3-sigma-g-1-ionization">
<h3><span class="section-number">6.3.1. </span>Simple case: <span class="math notranslate nohighlight">\(N_2~3\sigma_g^{-1}\)</span> ionization<a class="headerlink" href="#simple-case-n-2-3-sigma-g-1-ionization" title="Permalink to this heading">#</a></h3>
<p>As a simple example, consider the case of a homonuclear diatomic (<span class="math notranslate nohighlight">\(D_{\infty h}\)</span> <a class="reference internal" href="../backmatter/glossary.html#term-PG"><span class="xref std std-term">PG</span></a>, cylindrically symmetric), and a totally symmetric ionizing orbital, e.g. the ionization of the <span class="math notranslate nohighlight">\(\Sigma_{g}^{+}\)</span> <a class="reference internal" href="../backmatter/glossary.html#term-HOMO"><span class="xref std std-term">HOMO</span></a> of <span class="math notranslate nohighlight">\(N_2\)</span>. For this example,</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\Gamma^{i} = \Gamma^{+} = \Gamma^{s} = \Sigma_{g}^{+}\)</span>. Note that, for single-electron ionization from a fully-occupied valence orbitals, the ion symmetry will correspond to the hole symmetry, hence the symmetry of the ionized orbital. This simple picture may break down for more complicated cases, e.g. if multi-electron effects or substantial nuclear motions are involved; for radical systems the overall symmetry of all partially-occupied orbitals must be accounted for.</p></li>
<li><p>The dipole symmetries correspond to the Cartesian axes/translations given in the character tables, hence <span class="math notranslate nohighlight">\(\Sigma_{u}^{+} = (z)\)</span> and <span class="math notranslate nohighlight">\(\Pi_{u} = (x,y)\)</span> for <span class="math notranslate nohighlight">\(D_{\infty h}\)</span>. Note that, in this cylindrically symmetric case, the Cartesian <span class="math notranslate nohighlight">\((x,y)\)</span> components are spanned by the doubly-degenerate <span class="math notranslate nohighlight">\(\Pi_{u}\)</span> irreducible representation - physically this corresponds to the arbitrary orientation of these axes in the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> (i.e. no preferred direction is defined).</p></li>
</ul>
<p>Following Eq. <a class="reference internal" href="../part1/theory_symmetry_140723.html#equation-eq-ionization-symm-electronic">(3.12)</a>, the allowed components (irreducible representations) can be determined by hand making use of character and direct product tables, and substituting in for the terms defined above:</p>
<div class="amsmath math notranslate nohighlight" id="equation-5628db5d-c522-4dbd-a566-f365f0d2636b">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-5628db5d-c522-4dbd-a566-f365f0d2636b" title="Permalink to this equation">#</a></span>\[\begin{eqnarray}
\Gamma^{+}\otimes\Gamma^{e}\otimes\Gamma_{\mathrm{dipole}}\otimes\Gamma^{i} &amp; \supseteq &amp; \Sigma_{g}^{+}\\
\Sigma_{g}^{+}\otimes\Gamma^{e}\otimes\begin{array}{c}
\Pi_{u}~(x,y)\\
\Sigma_{u}^{+}~(z)
\end{array}\otimes\Sigma_{g}^{+} &amp; \supseteq &amp; \Sigma_{g}^{+}\\
\Sigma_{g}^{+}\otimes\Gamma^{e}\otimes\begin{array}{c}
\Pi_{u}~(x,y)\\
\Sigma_{u}^{+}~(z)
\end{array} &amp; \supseteq &amp; \Sigma_{g}^{+}\\
\Gamma^{e}\otimes\begin{array}{c}
\Pi_{u}~(x,y)\\
\Sigma_{u}^{+}~(z)
\end{array} &amp; \supseteq &amp; \Sigma_{g}^{+}
\end{eqnarray}\]</div>
<div class="admonition-group-theory-character-tables-and-related admonition">
<p class="admonition-title">Group theory character tables and related</p>
<p>Character tables, direct product tables and related information can be found at various sources online, or in textbooks, e.g. Refs. <span id="id4">[<a class="reference internal" href="../backmatter/bibliography.html#id515" title="By P W Atkins, M S Child, and C S G Phillips. Tables for Group Theory. Oxford University Press, 2006. URL: https://global.oup.com/uk/orc/chemistry/qchem2e/student/tables/.">140</a>, <a class="reference internal" href="../backmatter/bibliography.html#id625" title="Achim Gelessus. Character tables for chemically important point groups. URL: http://symmetry.jacobs-university.de/ (visited on 2023-04-23).">141</a>, <a class="reference internal" href="../backmatter/bibliography.html#id718" title="Gernot Katzer. Character Tables for Point Groups Cn, Cnv, Cnh, Dn, Dnh, Dnd, S2n etc. URL: http://www.gernot-katzers-spice-pages.com/character_tables/index.html (visited on 2023-04-23).">142</a>]</span>. For <span class="math notranslate nohighlight">\(D_{\infty h}\)</span> the pages at <a class="reference external" href="http://symmetry.jacobs-university.de/cgi-bin/group.cgi?group=1001&amp;option=4">symmetry.jacobs-university.de</a> provide a good quick reference; for extended tables <a class="reference external" href="http://www.gernot-katzers-spice-pages.com/character_tables/index.html">including spherical harmonic symmetries and direct products the pages from G. Katzers are useful</a>.</p>
</div>
<p>Hence the allowed continuum components are given by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-f2fadeee-4a18-411b-af57-7da2dedd1b2b">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-f2fadeee-4a18-411b-af57-7da2dedd1b2b" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Gamma^{e}=\begin{array}{c}
\Pi_{u}~(x,y)\\
\Sigma_{u}^{+}~(z)
\end{array}
\end{equation}\]</div>
<p>As indicated above, this case is split by symmetry into a “parallel” and “perpendicular” continua, accessed by the <span class="math notranslate nohighlight">\(z\)</span> or <span class="math notranslate nohighlight">\((x,y)\)</span> dipole components in the <a class="reference internal" href="../backmatter/glossary.html#term-MF"><span class="xref std std-term">MF</span></a> respectively; these are often denote generically by appending <span class="math notranslate nohighlight">\(\perp\)</span> and <span class="math notranslate nohighlight">\(\parallel\)</span> symbols to derived quantities, e.g. <span class="math notranslate nohighlight">\(\sigma_{\parallel}\)</span> for the corresponding cross-section. In the <a class="reference internal" href="../backmatter/glossary.html#term-LF"><span class="xref std std-term">LF</span></a> or <a class="reference internal" href="../backmatter/glossary.html#term-AF"><span class="xref std std-term">AF</span></a> these continua can be mixed according to the polarization state and geometry of the ionizing radiation, and the molecular alignment (<a class="reference internal" href="../backmatter/glossary.html#term-ADMs"><span class="xref std std-term">ADMs</span></a>).</p>
<p>The total scattering state symmetry is often also used to label continuum states, and is given by <span class="math notranslate nohighlight">\(\Gamma_{\mathrm{scat}}=\Gamma^{+}\otimes\Gamma^{e}\)</span>:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6abb858b-8ca0-438f-98e9-ab1cf6368caf">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-6abb858b-8ca0-438f-98e9-ab1cf6368caf" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Gamma_{\mathrm{scat}}=\Sigma_{g}^{+}\otimes\begin{array}{c}
\Pi_{u}~(x,y)\\
\Sigma_{u}^{+}~(z)
\end{array}=\begin{array}{c}
\Pi_{u}~(x,y)\\
\Sigma_{u}^{+}~(z)
\end{array}
\end{equation}\]</div>
<p>This is identical to <span class="math notranslate nohighlight">\(\Gamma^{e}\)</span> in this simple case.</p>
</section>
<section id="degenerate-case-example-n-2-3-pi-u-1-ionization">
<h3><span class="section-number">6.3.2. </span>Degenerate case example: <span class="math notranslate nohighlight">\(N_2~3\pi_u^{-1}\)</span> ionization<a class="headerlink" href="#degenerate-case-example-n-2-3-pi-u-1-ionization" title="Permalink to this heading">#</a></h3>
<p>For more complicated cases, multiple symmetry components may be found. For example, the ionization from a <span class="math notranslate nohighlight">\(\Pi_u\)</span> orbital, e.g. <span class="math notranslate nohighlight">\(N_2\)</span> <a class="reference internal" href="../backmatter/glossary.html#term-HOMO"><span class="xref std std-term">HOMO</span></a>-1.</p>
<p>In this case, <span class="math notranslate nohighlight">\(\Gamma^{+} = \Pi_u\)</span>, and - working through the direct products as above - yields the allowed continuum components:</p>
<div class="amsmath math notranslate nohighlight" id="equation-10a86eef-13fe-4d22-89c9-e5ef0a5cd521">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-10a86eef-13fe-4d22-89c9-e5ef0a5cd521" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Gamma^{e}=\begin{array}{c}
\Sigma_{g}^{+} + \Delta_{g}~(x,y)\\
\Pi_{g}~(z)
\end{array}
\end{equation}\]</div>
<p>And total scattering state symmetries:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d8e39da0-e995-4b7e-8437-68f5b31bb9ee">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-d8e39da0-e995-4b7e-8437-68f5b31bb9ee" title="Permalink to this equation">#</a></span>\[\begin{equation}
\Gamma_{\mathrm{scat}}=\Pi_{u}\otimes\begin{array}{c}
\Sigma_{g}^{+} + \Delta_{g}~(x,y)\\
\Pi_{g}~(z)
\end{array}=\begin{array}{c}
\Pi_{u} + \Delta_{u} + \Phi_{u}~(x,y)\\
\Sigma_{u}^{+} + \Sigma_{u}^{-} + \Delta_{u}~(z)
\end{array}
\end{equation}\]</div>
<p>In this case, the direct product results give multiple components for each continua. However, since the continuum wavefunction is already defined for multiple components, as given by <span class="math notranslate nohighlight">\(\Gamma^{e}\)</span>, only the first <span class="math notranslate nohighlight">\(\Gamma_{\mathrm{scat}}\)</span> symmetry is required as a unique label here. In this case, therefore, <span class="math notranslate nohighlight">\(\Gamma_{\mathrm{scat}} = \Pi_{u}~(x,y)\)</span> and <span class="math notranslate nohighlight">\(\Gamma_{\mathrm{scat}} =\Sigma_{u}^{+}~(z)\)</span> suffice to label the total scattering states.</p>
</section>
<section id="defining-symmetrized-harmonics">
<h3><span class="section-number">6.3.3. </span>Defining symmetrized harmonics<a class="headerlink" href="#defining-symmetrized-harmonics" title="Permalink to this heading">#</a></h3>
<p>In the examples above, the allowed irreducible representations are defined by hand from direct product tables for illustrative purposes. But, in general, it is tedious to categorize/define the allowed spherical harmonics and linear combinations. With the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id5">[<a class="reference internal" href="../backmatter/bibliography.html#id682" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">5</a>]</span>, both the direct products illustrated above, and the determination of associated spherical harmonics, can be automated and the full basis set rapidly defined numerically. This was illustrated briefly in <a class="reference internal" href="../part1/theory_symmetry_140723.html#sec-theory-symmetry-intro"><span class="std std-numref">Sect. 3.2</span></a>, and is extended here for the example cases above.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Full tabulations of the parameters available in HTML or notebook formats only.</p>
</div>
</aside>
<p>Computationally, the cylindrically-symmetric <span class="math notranslate nohighlight">\(\infty\)</span> groups can be approximated by a high-order group, e.g. <span class="math notranslate nohighlight">\(D_{\infty h} \approx D_{10h}\)</span>. (For a cross-check, see the <a class="reference external" href="http://www.gernot-katzers-spice-pages.com/character_tables/D10h.html">full tables and direct products online</a>.)  Here the notational convention is <span class="math notranslate nohighlight">\(A1 = \Sigma^{+}\)</span>, <span class="math notranslate nohighlight">\(A2 = \Sigma^{-}\)</span>, <span class="math notranslate nohighlight">\(E1 = \Pi\)</span>, <span class="math notranslate nohighlight">\(E2 = \Delta\)</span> and so forth (see the <a class="reference external" href="http://symmetry.jacobs-university.de/cgi-bin/group.cgi?group=1001&amp;option=4"><span class="math notranslate nohighlight">\(D_{\infty h}\)</span> character table</a> for more details).</p>
<div class="cell tag_hide-cell docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run default config - may need to set full path here</span>
<span class="o">%</span><span class="k">run</span> &#39;../scripts/setup_notebook.py&#39;

<span class="c1"># Override plotters backend?</span>
<span class="c1"># plotBackend = &#39;pl&#39;</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Setting up notebook with standard Quantum Metrology Vol. 3 imports...
For more details see https://pemtk.readthedocs.io/en/latest/fitting/PEMtk_fitting_basic_demo_030621-full.html
To use local source code, pass the parent path to this script at run time, e.g. &quot;setup_fit_demo ~/github&quot;

*** Running: 2023-10-26 05:42:20
Working dir: /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2
Build env: html
None

* Loading packages...
* sparse not found, sparse matrix forms not available. 
* natsort not found, some sorting functions not available. 
* Setting plotter defaults with epsproc.basicPlotters.setPlotters(). Run directly to modify, or change options in local env.
* Set Holoviews with bokeh.
* pyevtk not found, VTK export not available. 
* Set Holoviews with bokeh.
Jupyter Book      : 0.15.1
External ToC      : 0.3.1
MyST-Parser       : 0.18.1
MyST-NB           : 0.17.2
Sphinx Book Theme : 1.0.1
Jupyter-Cache     : 0.6.1
NbClient          : 0.7.4
</pre></div>
</div>
<script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = false;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.1.1.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/panel.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><div class="output text_html"><div id='c00c6651-be33-4e64-a425-955043d1a665'>
  <div id="e1c5a478-6042-4a42-8ffb-45039d9659e4" data-root-id="c00c6651-be33-4e64-a425-955043d1a665" style="display: contents;"></div>
</div>
<script type="application/javascript">(function(root) {
  var docs_json = {"6e61e9f4-412a-4bb6-b469-264deb322307":{"version":"3.1.1","title":"Bokeh Application","defs":[{"type":"model","name":"ReactiveHTML1"},{"type":"model","name":"FlexBox1","properties":[{"name":"align_content","kind":"Any","default":"flex-start"},{"name":"align_items","kind":"Any","default":"flex-start"},{"name":"flex_direction","kind":"Any","default":"row"},{"name":"flex_wrap","kind":"Any","default":"wrap"},{"name":"justify_content","kind":"Any","default":"flex-start"}]},{"type":"model","name":"FloatPanel1","properties":[{"name":"config","kind":"Any","default":{"type":"map"}},{"name":"contained","kind":"Any","default":true},{"name":"position","kind":"Any","default":"right-top"},{"name":"offsetx","kind":"Any","default":null},{"name":"offsety","kind":"Any","default":null},{"name":"theme","kind":"Any","default":"primary"},{"name":"status","kind":"Any","default":"normalized"}]},{"type":"model","name":"GridStack1","properties":[{"name":"mode","kind":"Any","default":"warn"},{"name":"ncols","kind":"Any","default":null},{"name":"nrows","kind":"Any","default":null},{"name":"allow_resize","kind":"Any","default":true},{"name":"allow_drag","kind":"Any","default":true},{"name":"state","kind":"Any","default":[]}]},{"type":"model","name":"drag1","properties":[{"name":"slider_width","kind":"Any","default":5},{"name":"slider_color","kind":"Any","default":"black"},{"name":"value","kind":"Any","default":50}]},{"type":"model","name":"click1","properties":[{"name":"terminal_output","kind":"Any","default":""},{"name":"debug_name","kind":"Any","default":""},{"name":"clears","kind":"Any","default":0}]},{"type":"model","name":"FastWrapper1","properties":[{"name":"object","kind":"Any","default":null},{"name":"style","kind":"Any","default":null}]},{"type":"model","name":"NotificationAreaBase1","properties":[{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0}]},{"type":"model","name":"NotificationArea1","properties":[{"name":"notifications","kind":"Any","default":[]},{"name":"position","kind":"Any","default":"bottom-right"},{"name":"_clear","kind":"Any","default":0},{"name":"types","kind":"Any","default":[{"type":"map","entries":[["type","warning"],["background","#ffc107"],["icon",{"type":"map","entries":[["className","fas fa-exclamation-triangle"],["tagName","i"],["color","white"]]}]]},{"type":"map","entries":[["type","info"],["background","#007bff"],["icon",{"type":"map","entries":[["className","fas fa-info-circle"],["tagName","i"],["color","white"]]}]]}]}]},{"type":"model","name":"Notification","properties":[{"name":"background","kind":"Any","default":null},{"name":"duration","kind":"Any","default":3000},{"name":"icon","kind":"Any","default":null},{"name":"message","kind":"Any","default":""},{"name":"notification_type","kind":"Any","default":null},{"name":"_destroyed","kind":"Any","default":false}]},{"type":"model","name":"TemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"BootstrapTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]},{"type":"model","name":"MaterialTemplateActions1","properties":[{"name":"open_modal","kind":"Any","default":0},{"name":"close_modal","kind":"Any","default":0}]}],"roots":[{"type":"object","name":"panel.models.browser.BrowserInfo","id":"c00c6651-be33-4e64-a425-955043d1a665"},{"type":"object","name":"panel.models.comm_manager.CommManager","id":"b2567e77-d494-4de6-ab1d-1b54c200796f","attributes":{"plot_id":"c00c6651-be33-4e64-a425-955043d1a665","comm_id":"1ea2957958ce4fb78f27ab10f6c076d0","client_comm_id":"0f8e848733314fe49da5249b7d50544c"}}],"callbacks":{"type":"map"}}};
  var render_items = [{"docid":"6e61e9f4-412a-4bb6-b469-264deb322307","roots":{"c00c6651-be33-4e64-a425-955043d1a665":"e1c5a478-6042-4a42-8ffb-45039d9659e4"},"root_ids":["c00c6651-be33-4e64-a425-955043d1a665"]}];
  var docs = Object.values(docs_json)
  if (!docs) {
    return
  }
  const py_version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')
  const is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1
  function embed_document(root) {
    var Bokeh = get_bokeh(root)
    Bokeh.embed.embed_items_notebook(docs_json, render_items);
    for (const render_item of render_items) {
      for (const root_id of render_item.root_ids) {
	const id_el = document.getElementById(root_id)
	if (id_el.children.length && (id_el.children[0].className === 'bk-root')) {
	  const root_el = id_el.children[0]
	  root_el.id = root_el.id + '-rendered'
	}
      }
    }
  }
  function get_bokeh(root) {
    if (root.Bokeh === undefined) {
      return null
    } else if (root.Bokeh.version !== py_version && !is_dev) {
      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(py_version)) {
	return null
      }
      return root.Bokeh.versions.get(py_version);
    } else if (root.Bokeh.version === py_version) {
      return root.Bokeh
    }
    return null
  }
  function is_loaded(root) {
    var Bokeh = get_bokeh(root)
    return (Bokeh != null && Bokeh.Panel !== undefined && ( root['Plotly'] !== undefined) && ( root['Plotly'] !== undefined))
  }
  if (is_loaded(root)) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (is_loaded(root)) {
        clearInterval(timer);
        embed_document(root);
      } else if (document.readyState == "complete") {
        attempts++;
        if (attempts > 200) {
          clearInterval(timer);
	  var Bokeh = get_bokeh(root)
	  if (Bokeh == null || Bokeh.Panel == null) {
            console.warn("Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing");
	  } else {
	    console.warn("Panel: WARNING: Attempting to render but not all required libraries could be resolved.")
	    embed_document(root)
	  }
        }
      }
    }, 25, root)
  }
})(window);</script></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div><script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.').replace('.dev', '-dev.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = true;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'plotly': 'https://cdn.plot.ly/plotly-2.18.0.min', 'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["plotly"], function(Plotly) {
	window.Plotly = Plotly
	on_load()
      })
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 10;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['Plotly'] !== undefined) && (!(window['Plotly'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.2.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.2.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.holoviz.org/panel/1.2.0/dist/bundled/jquery/jquery.slim.min.js", "https://cdn.holoviz.org/panel/1.2.0/dist/bundled/plotlyplot/plotly-2.18.0.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(
    > .cell-output-ipywidget-background > .lm-Widget > *[data-root-id]
  ),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div></div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example following symmetrized harmonics demo</span>

<span class="c1"># Import class</span>
<span class="kn">from</span> <span class="nn">pemtk.sym.symHarm</span> <span class="kn">import</span> <span class="n">symHarm</span>

<span class="c1"># Compute hamronics for D10h, lmax=4</span>
<span class="n">sym</span> <span class="o">=</span> <span class="s1">&#39;D10h&#39;</span>
<span class="n">lmax</span><span class="o">=</span><span class="mi">4</span>

<span class="n">symObjA1g</span> <span class="o">=</span> <span class="n">symHarm</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span><span class="n">lmax</span><span class="p">)</span>

<span class="c1"># Allowed terms and mappings are given in &#39;dipoleSyms&#39;</span>
<span class="c1"># symObj.dipole[&#39;dipoleSyms&#39;]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;it&#39;}
Added dim Eke
Added dim Targ
Added dim Total
Added dim mu
Added dim Type
Found dipole symmetries: 
{&#39;A2u&#39;: {&#39;m&#39;: [0], &#39;pol&#39;: [&#39;z&#39;]}, &#39;E1u&#39;: {&#39;m&#39;: [-1, 1, -1, 1], &#39;pol&#39;: [&#39;x&#39;, &#39;y&#39;]}}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting the symmetry for the neutral and ion allows direct products to be computed, </span>
<span class="c1"># and allowed terms to be determined.</span>

<span class="n">sNeutral</span> <span class="o">=</span> <span class="s1">&#39;A1g&#39;</span>
<span class="n">sIonSG</span> <span class="o">=</span> <span class="s1">&#39;A1g&#39;</span>

<span class="n">symObjA1g</span><span class="o">.</span><span class="n">directProductContinuum</span><span class="p">([</span><span class="n">sNeutral</span><span class="p">,</span> <span class="n">sIonSG</span><span class="p">])</span>

<span class="c1"># Results are pushed to self.continuum, in dictionary and Pandas DataFrame formats, </span>
<span class="c1"># and can be manipulated using standard functionality.</span>
<span class="c1"># The subset of allowed values are also set to a separate DataFrame and list.</span>

<span class="c1"># Glue figure for later - real part only in this case</span>
<span class="c1"># Also clean up axis labels from default state labels (&#39;LM&#39; and &#39;LM_p&#39; in this case).</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;dipoleTermsD10hA1g&quot;</span><span class="p">,</span> <span class="n">symObjA1g</span><span class="o">.</span><span class="n">continuum</span><span class="p">[</span><span class="s1">&#39;allowed&#39;</span><span class="p">][</span><span class="s1">&#39;PD&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_c124e_row0_col0, #T_c124e_row0_col1, #T_c124e_row0_col2, #T_c124e_row0_col3, #T_c124e_row0_col4, #T_c124e_row1_col0, #T_c124e_row1_col1, #T_c124e_row1_col2, #T_c124e_row1_col3, #T_c124e_row1_col4, #T_c124e_row2_col0, #T_c124e_row2_col1, #T_c124e_row2_col2, #T_c124e_row2_col3, #T_c124e_row2_col4, #T_c124e_row4_col0, #T_c124e_row4_col1, #T_c124e_row4_col2, #T_c124e_row4_col3, #T_c124e_row4_col4, #T_c124e_row5_col0, #T_c124e_row5_col1, #T_c124e_row5_col2, #T_c124e_row5_col3, #T_c124e_row5_col4, #T_c124e_row6_col0, #T_c124e_row6_col1, #T_c124e_row6_col2, #T_c124e_row6_col3, #T_c124e_row6_col4, #T_c124e_row7_col0, #T_c124e_row7_col1, #T_c124e_row7_col2, #T_c124e_row7_col3, #T_c124e_row7_col4, #T_c124e_row8_col0, #T_c124e_row8_col1, #T_c124e_row8_col2, #T_c124e_row8_col3, #T_c124e_row8_col4, #T_c124e_row9_col0, #T_c124e_row9_col1, #T_c124e_row9_col2, #T_c124e_row9_col3, #T_c124e_row9_col4, #T_c124e_row10_col0, #T_c124e_row10_col1, #T_c124e_row10_col2, #T_c124e_row10_col3, #T_c124e_row10_col4, #T_c124e_row11_col0, #T_c124e_row11_col1, #T_c124e_row11_col2, #T_c124e_row11_col3, #T_c124e_row11_col4, #T_c124e_row12_col0, #T_c124e_row12_col1, #T_c124e_row12_col2, #T_c124e_row12_col3, #T_c124e_row12_col4, #T_c124e_row13_col0, #T_c124e_row13_col1, #T_c124e_row13_col2, #T_c124e_row13_col3, #T_c124e_row13_col4, #T_c124e_row14_col0, #T_c124e_row14_col1, #T_c124e_row14_col2, #T_c124e_row14_col3, #T_c124e_row14_col4, #T_c124e_row15_col0, #T_c124e_row15_col1, #T_c124e_row15_col2, #T_c124e_row15_col3, #T_c124e_row15_col4, #T_c124e_row16_col0, #T_c124e_row16_col1, #T_c124e_row16_col2, #T_c124e_row16_col3, #T_c124e_row16_col4, #T_c124e_row17_col0, #T_c124e_row17_col1, #T_c124e_row17_col2, #T_c124e_row17_col3, #T_c124e_row17_col4, #T_c124e_row18_col0, #T_c124e_row18_col1, #T_c124e_row18_col2, #T_c124e_row18_col3, #T_c124e_row18_col4, #T_c124e_row19_col0, #T_c124e_row19_col1, #T_c124e_row19_col2, #T_c124e_row19_col3, #T_c124e_row19_col4, #T_c124e_row20_col0, #T_c124e_row20_col1, #T_c124e_row20_col2, #T_c124e_row20_col3, #T_c124e_row20_col4, #T_c124e_row21_col0, #T_c124e_row21_col1, #T_c124e_row21_col2, #T_c124e_row21_col3, #T_c124e_row21_col4, #T_c124e_row22_col0, #T_c124e_row22_col1, #T_c124e_row22_col2, #T_c124e_row22_col3, #T_c124e_row22_col4, #T_c124e_row23_col0, #T_c124e_row23_col1, #T_c124e_row23_col2, #T_c124e_row23_col3, #T_c124e_row23_col4, #T_c124e_row25_col0, #T_c124e_row25_col1, #T_c124e_row25_col2, #T_c124e_row25_col3, #T_c124e_row25_col4, #T_c124e_row26_col0, #T_c124e_row26_col1, #T_c124e_row26_col2, #T_c124e_row26_col3, #T_c124e_row26_col4, #T_c124e_row27_col0, #T_c124e_row27_col1, #T_c124e_row27_col2, #T_c124e_row27_col3, #T_c124e_row27_col4, #T_c124e_row28_col0, #T_c124e_row28_col1, #T_c124e_row28_col2, #T_c124e_row28_col3, #T_c124e_row28_col4, #T_c124e_row29_col0, #T_c124e_row29_col1, #T_c124e_row29_col2, #T_c124e_row29_col3, #T_c124e_row29_col4, #T_c124e_row30_col0, #T_c124e_row30_col1, #T_c124e_row30_col2, #T_c124e_row30_col3, #T_c124e_row30_col4, #T_c124e_row31_col0, #T_c124e_row31_col1, #T_c124e_row31_col2, #T_c124e_row31_col3, #T_c124e_row31_col4 {
  background-color: lightgrey;
}
#T_c124e_row3_col0, #T_c124e_row3_col1, #T_c124e_row3_col2, #T_c124e_row3_col3, #T_c124e_row3_col4, #T_c124e_row24_col0, #T_c124e_row24_col1, #T_c124e_row24_col2, #T_c124e_row24_col3, #T_c124e_row24_col4 {
  background-color: yellow;
}
</style>
<table id="T_c124e">
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_c124e_level0_col0" class="col_heading level0 col0" >allowed</th>
      <th id="T_c124e_level0_col1" class="col_heading level0 col1" >m</th>
      <th id="T_c124e_level0_col2" class="col_heading level0 col2" >pol</th>
      <th id="T_c124e_level0_col3" class="col_heading level0 col3" >result</th>
      <th id="T_c124e_level0_col4" class="col_heading level0 col4" >terms</th>
    </tr>
    <tr>
      <th class="index_name level0" >Dipole</th>
      <th class="index_name level1" >Target</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_c124e_level0_row0" class="row_heading level0 row0" rowspan="16">A2u</th>
      <th id="T_c124e_level1_row0" class="row_heading level1 row0" >A1g</th>
      <td id="T_c124e_row0_col0" class="data row0 col0" >False</td>
      <td id="T_c124e_row0_col1" class="data row0 col1" >[0]</td>
      <td id="T_c124e_row0_col2" class="data row0 col2" >['z']</td>
      <td id="T_c124e_row0_col3" class="data row0 col3" >['A2u']</td>
      <td id="T_c124e_row0_col4" class="data row0 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row1" class="row_heading level1 row1" >A2g</th>
      <td id="T_c124e_row1_col0" class="data row1 col0" >False</td>
      <td id="T_c124e_row1_col1" class="data row1 col1" >[0]</td>
      <td id="T_c124e_row1_col2" class="data row1 col2" >['z']</td>
      <td id="T_c124e_row1_col3" class="data row1 col3" >['A1u']</td>
      <td id="T_c124e_row1_col4" class="data row1 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row2" class="row_heading level1 row2" >A1u</th>
      <td id="T_c124e_row2_col0" class="data row2 col0" >False</td>
      <td id="T_c124e_row2_col1" class="data row2 col1" >[0]</td>
      <td id="T_c124e_row2_col2" class="data row2 col2" >['z']</td>
      <td id="T_c124e_row2_col3" class="data row2 col3" >['A2g']</td>
      <td id="T_c124e_row2_col4" class="data row2 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row3" class="row_heading level1 row3" >A2u</th>
      <td id="T_c124e_row3_col0" class="data row3 col0" >True</td>
      <td id="T_c124e_row3_col1" class="data row3 col1" >[0]</td>
      <td id="T_c124e_row3_col2" class="data row3 col2" >['z']</td>
      <td id="T_c124e_row3_col3" class="data row3 col3" >['A1g']</td>
      <td id="T_c124e_row3_col4" class="data row3 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row4" class="row_heading level1 row4" >B1g</th>
      <td id="T_c124e_row4_col0" class="data row4 col0" >False</td>
      <td id="T_c124e_row4_col1" class="data row4 col1" >[0]</td>
      <td id="T_c124e_row4_col2" class="data row4 col2" >['z']</td>
      <td id="T_c124e_row4_col3" class="data row4 col3" >['B2u']</td>
      <td id="T_c124e_row4_col4" class="data row4 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row5" class="row_heading level1 row5" >B1u</th>
      <td id="T_c124e_row5_col0" class="data row5 col0" >False</td>
      <td id="T_c124e_row5_col1" class="data row5 col1" >[0]</td>
      <td id="T_c124e_row5_col2" class="data row5 col2" >['z']</td>
      <td id="T_c124e_row5_col3" class="data row5 col3" >['B2g']</td>
      <td id="T_c124e_row5_col4" class="data row5 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row6" class="row_heading level1 row6" >B2g</th>
      <td id="T_c124e_row6_col0" class="data row6 col0" >False</td>
      <td id="T_c124e_row6_col1" class="data row6 col1" >[0]</td>
      <td id="T_c124e_row6_col2" class="data row6 col2" >['z']</td>
      <td id="T_c124e_row6_col3" class="data row6 col3" >['B1u']</td>
      <td id="T_c124e_row6_col4" class="data row6 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row7" class="row_heading level1 row7" >B2u</th>
      <td id="T_c124e_row7_col0" class="data row7 col0" >False</td>
      <td id="T_c124e_row7_col1" class="data row7 col1" >[0]</td>
      <td id="T_c124e_row7_col2" class="data row7 col2" >['z']</td>
      <td id="T_c124e_row7_col3" class="data row7 col3" >['B1g']</td>
      <td id="T_c124e_row7_col4" class="data row7 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row8" class="row_heading level1 row8" >E1u</th>
      <td id="T_c124e_row8_col0" class="data row8 col0" >False</td>
      <td id="T_c124e_row8_col1" class="data row8 col1" >[0]</td>
      <td id="T_c124e_row8_col2" class="data row8 col2" >['z']</td>
      <td id="T_c124e_row8_col3" class="data row8 col3" >['E1g']</td>
      <td id="T_c124e_row8_col4" class="data row8 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row9" class="row_heading level1 row9" >E1g</th>
      <td id="T_c124e_row9_col0" class="data row9 col0" >False</td>
      <td id="T_c124e_row9_col1" class="data row9 col1" >[0]</td>
      <td id="T_c124e_row9_col2" class="data row9 col2" >['z']</td>
      <td id="T_c124e_row9_col3" class="data row9 col3" >['E1u']</td>
      <td id="T_c124e_row9_col4" class="data row9 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row10" class="row_heading level1 row10" >E2g</th>
      <td id="T_c124e_row10_col0" class="data row10 col0" >False</td>
      <td id="T_c124e_row10_col1" class="data row10 col1" >[0]</td>
      <td id="T_c124e_row10_col2" class="data row10 col2" >['z']</td>
      <td id="T_c124e_row10_col3" class="data row10 col3" >['E2u']</td>
      <td id="T_c124e_row10_col4" class="data row10 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row11" class="row_heading level1 row11" >E2u</th>
      <td id="T_c124e_row11_col0" class="data row11 col0" >False</td>
      <td id="T_c124e_row11_col1" class="data row11 col1" >[0]</td>
      <td id="T_c124e_row11_col2" class="data row11 col2" >['z']</td>
      <td id="T_c124e_row11_col3" class="data row11 col3" >['E2g']</td>
      <td id="T_c124e_row11_col4" class="data row11 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row12" class="row_heading level1 row12" >E3u</th>
      <td id="T_c124e_row12_col0" class="data row12 col0" >False</td>
      <td id="T_c124e_row12_col1" class="data row12 col1" >[0]</td>
      <td id="T_c124e_row12_col2" class="data row12 col2" >['z']</td>
      <td id="T_c124e_row12_col3" class="data row12 col3" >['E3g']</td>
      <td id="T_c124e_row12_col4" class="data row12 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row13" class="row_heading level1 row13" >E3g</th>
      <td id="T_c124e_row13_col0" class="data row13 col0" >False</td>
      <td id="T_c124e_row13_col1" class="data row13 col1" >[0]</td>
      <td id="T_c124e_row13_col2" class="data row13 col2" >['z']</td>
      <td id="T_c124e_row13_col3" class="data row13 col3" >['E3u']</td>
      <td id="T_c124e_row13_col4" class="data row13 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row14" class="row_heading level1 row14" >E4g</th>
      <td id="T_c124e_row14_col0" class="data row14 col0" >False</td>
      <td id="T_c124e_row14_col1" class="data row14 col1" >[0]</td>
      <td id="T_c124e_row14_col2" class="data row14 col2" >['z']</td>
      <td id="T_c124e_row14_col3" class="data row14 col3" >['E4u']</td>
      <td id="T_c124e_row14_col4" class="data row14 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row15" class="row_heading level1 row15" >E4u</th>
      <td id="T_c124e_row15_col0" class="data row15 col0" >False</td>
      <td id="T_c124e_row15_col1" class="data row15 col1" >[0]</td>
      <td id="T_c124e_row15_col2" class="data row15 col2" >['z']</td>
      <td id="T_c124e_row15_col3" class="data row15 col3" >['E4g']</td>
      <td id="T_c124e_row15_col4" class="data row15 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level0_row16" class="row_heading level0 row16" rowspan="16">E1u</th>
      <th id="T_c124e_level1_row16" class="row_heading level1 row16" >A1g</th>
      <td id="T_c124e_row16_col0" class="data row16 col0" >False</td>
      <td id="T_c124e_row16_col1" class="data row16 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row16_col2" class="data row16 col2" >['x', 'y']</td>
      <td id="T_c124e_row16_col3" class="data row16 col3" >['E1u']</td>
      <td id="T_c124e_row16_col4" class="data row16 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row17" class="row_heading level1 row17" >A2g</th>
      <td id="T_c124e_row17_col0" class="data row17 col0" >False</td>
      <td id="T_c124e_row17_col1" class="data row17 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row17_col2" class="data row17 col2" >['x', 'y']</td>
      <td id="T_c124e_row17_col3" class="data row17 col3" >['E1u']</td>
      <td id="T_c124e_row17_col4" class="data row17 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row18" class="row_heading level1 row18" >A1u</th>
      <td id="T_c124e_row18_col0" class="data row18 col0" >False</td>
      <td id="T_c124e_row18_col1" class="data row18 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row18_col2" class="data row18 col2" >['x', 'y']</td>
      <td id="T_c124e_row18_col3" class="data row18 col3" >['E1g']</td>
      <td id="T_c124e_row18_col4" class="data row18 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row19" class="row_heading level1 row19" >A2u</th>
      <td id="T_c124e_row19_col0" class="data row19 col0" >False</td>
      <td id="T_c124e_row19_col1" class="data row19 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row19_col2" class="data row19 col2" >['x', 'y']</td>
      <td id="T_c124e_row19_col3" class="data row19 col3" >['E1g']</td>
      <td id="T_c124e_row19_col4" class="data row19 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row20" class="row_heading level1 row20" >B1g</th>
      <td id="T_c124e_row20_col0" class="data row20 col0" >False</td>
      <td id="T_c124e_row20_col1" class="data row20 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row20_col2" class="data row20 col2" >['x', 'y']</td>
      <td id="T_c124e_row20_col3" class="data row20 col3" >['E4u']</td>
      <td id="T_c124e_row20_col4" class="data row20 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row21" class="row_heading level1 row21" >B1u</th>
      <td id="T_c124e_row21_col0" class="data row21 col0" >False</td>
      <td id="T_c124e_row21_col1" class="data row21 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row21_col2" class="data row21 col2" >['x', 'y']</td>
      <td id="T_c124e_row21_col3" class="data row21 col3" >['E4g']</td>
      <td id="T_c124e_row21_col4" class="data row21 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row22" class="row_heading level1 row22" >B2g</th>
      <td id="T_c124e_row22_col0" class="data row22 col0" >False</td>
      <td id="T_c124e_row22_col1" class="data row22 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row22_col2" class="data row22 col2" >['x', 'y']</td>
      <td id="T_c124e_row22_col3" class="data row22 col3" >['E4u']</td>
      <td id="T_c124e_row22_col4" class="data row22 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row23" class="row_heading level1 row23" >B2u</th>
      <td id="T_c124e_row23_col0" class="data row23 col0" >False</td>
      <td id="T_c124e_row23_col1" class="data row23 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row23_col2" class="data row23 col2" >['x', 'y']</td>
      <td id="T_c124e_row23_col3" class="data row23 col3" >['E4g']</td>
      <td id="T_c124e_row23_col4" class="data row23 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row24" class="row_heading level1 row24" >E1u</th>
      <td id="T_c124e_row24_col0" class="data row24 col0" >True</td>
      <td id="T_c124e_row24_col1" class="data row24 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row24_col2" class="data row24 col2" >['x', 'y']</td>
      <td id="T_c124e_row24_col3" class="data row24 col3" >['A1g', 'A2g', 'E2g']</td>
      <td id="T_c124e_row24_col4" class="data row24 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row25" class="row_heading level1 row25" >E1g</th>
      <td id="T_c124e_row25_col0" class="data row25 col0" >False</td>
      <td id="T_c124e_row25_col1" class="data row25 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row25_col2" class="data row25 col2" >['x', 'y']</td>
      <td id="T_c124e_row25_col3" class="data row25 col3" >['A1u', 'A2u', 'E2u']</td>
      <td id="T_c124e_row25_col4" class="data row25 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row26" class="row_heading level1 row26" >E2g</th>
      <td id="T_c124e_row26_col0" class="data row26 col0" >False</td>
      <td id="T_c124e_row26_col1" class="data row26 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row26_col2" class="data row26 col2" >['x', 'y']</td>
      <td id="T_c124e_row26_col3" class="data row26 col3" >['E1u', 'E3u']</td>
      <td id="T_c124e_row26_col4" class="data row26 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row27" class="row_heading level1 row27" >E2u</th>
      <td id="T_c124e_row27_col0" class="data row27 col0" >False</td>
      <td id="T_c124e_row27_col1" class="data row27 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row27_col2" class="data row27 col2" >['x', 'y']</td>
      <td id="T_c124e_row27_col3" class="data row27 col3" >['E1g', 'E3g']</td>
      <td id="T_c124e_row27_col4" class="data row27 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row28" class="row_heading level1 row28" >E3u</th>
      <td id="T_c124e_row28_col0" class="data row28 col0" >False</td>
      <td id="T_c124e_row28_col1" class="data row28 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row28_col2" class="data row28 col2" >['x', 'y']</td>
      <td id="T_c124e_row28_col3" class="data row28 col3" >['E2g', 'E4g']</td>
      <td id="T_c124e_row28_col4" class="data row28 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row29" class="row_heading level1 row29" >E3g</th>
      <td id="T_c124e_row29_col0" class="data row29 col0" >False</td>
      <td id="T_c124e_row29_col1" class="data row29 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row29_col2" class="data row29 col2" >['x', 'y']</td>
      <td id="T_c124e_row29_col3" class="data row29 col3" >['E2u', 'E4u']</td>
      <td id="T_c124e_row29_col4" class="data row29 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row30" class="row_heading level1 row30" >E4g</th>
      <td id="T_c124e_row30_col0" class="data row30 col0" >False</td>
      <td id="T_c124e_row30_col1" class="data row30 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row30_col2" class="data row30 col2" >['x', 'y']</td>
      <td id="T_c124e_row30_col3" class="data row30 col3" >['B1u', 'B2u', 'E3u']</td>
      <td id="T_c124e_row30_col4" class="data row30 col4" >['A1g', 'A1g']</td>
    </tr>
    <tr>
      <th id="T_c124e_level1_row31" class="row_heading level1 row31" >E4u</th>
      <td id="T_c124e_row31_col0" class="data row31 col0" >False</td>
      <td id="T_c124e_row31_col1" class="data row31 col1" >[-1, 1, -1, 1]</td>
      <td id="T_c124e_row31_col2" class="data row31 col2" >['x', 'y']</td>
      <td id="T_c124e_row31_col3" class="data row31 col3" >['B1g', 'B2g', 'E3g']</td>
      <td id="T_c124e_row31_col4" class="data row31 col4" >['A1g', 'A1g']</td>
    </tr>
  </tbody>
</table>
</div></div>
</details>
</div>
<figure class="align-default" id="fig-dipoletermsd10ha1g">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>allowed</th>
      <th>m</th>
      <th>pol</th>
      <th>result</th>
      <th>terms</th>
    </tr>
    <tr>
      <th>Dipole</th>
      <th>Target</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A2u</th>
      <th>A2u</th>
      <td>True</td>
      <td>[0]</td>
      <td>[z]</td>
      <td>[A1g]</td>
      <td>[A1g, A1g]</td>
    </tr>
    <tr>
      <th>E1u</th>
      <th>E1u</th>
      <td>True</td>
      <td>[-1, 1, -1, 1]</td>
      <td>[x, y]</td>
      <td>[A1g, A2g, E2g]</td>
      <td>[A1g, A1g]</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 6.1 </span><span class="caption-text">Dipole-allowed continuum symmetries (“Target”) for <span class="math notranslate nohighlight">\(D_{10h}\)</span>, <span class="math notranslate nohighlight">\(A_{1g}\)</span> ionization.</span><a class="headerlink" href="#fig-dipoletermsd10ha1g" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Setting the symmetry for the neutral and ion allows direct products to be computed, </span>
<span class="c1"># and allowed terms to be determined.</span>

<span class="n">sNeutral</span> <span class="o">=</span> <span class="s1">&#39;A1g&#39;</span>
<span class="n">sIonPU</span> <span class="o">=</span> <span class="s1">&#39;E1u&#39;</span>

<span class="c1"># Define new object for E1u case</span>
<span class="n">symObjE1u</span> <span class="o">=</span> <span class="n">symHarm</span><span class="p">(</span><span class="n">sym</span><span class="p">,</span><span class="n">lmax</span><span class="p">)</span>
<span class="n">symObjE1u</span><span class="o">.</span><span class="n">directProductContinuum</span><span class="p">([</span><span class="n">sNeutral</span><span class="p">,</span> <span class="n">sIonPU</span><span class="p">])</span>

<span class="c1"># Results are pushed to self.continuum, in dictionary and Pandas DataFrame formats, </span>
<span class="c1"># and can be manipulated using standard functionality.</span>
<span class="c1"># The subset of allowed values are also set to a separate DataFrame and list.</span>

<span class="c1"># Glue table for later</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;dipoleTermsD10hE1u&quot;</span><span class="p">,</span> <span class="n">symObjE1u</span><span class="o">.</span><span class="n">continuum</span><span class="p">[</span><span class="s1">&#39;allowed&#39;</span><span class="p">][</span><span class="s1">&#39;PD&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;it&#39;}
Added dim Eke
Added dim Targ
Added dim Total
Added dim mu
Added dim Type
Found dipole symmetries: 
{&#39;A2u&#39;: {&#39;m&#39;: [0], &#39;pol&#39;: [&#39;z&#39;]}, &#39;E1u&#39;: {&#39;m&#39;: [-1, 1, -1, 1], &#39;pol&#39;: [&#39;x&#39;, &#39;y&#39;]}}
</pre></div>
</div>
<div class="output text_html"><style type="text/css">
#T_e32b1_row0_col0, #T_e32b1_row0_col1, #T_e32b1_row0_col2, #T_e32b1_row0_col3, #T_e32b1_row0_col4, #T_e32b1_row1_col0, #T_e32b1_row1_col1, #T_e32b1_row1_col2, #T_e32b1_row1_col3, #T_e32b1_row1_col4, #T_e32b1_row2_col0, #T_e32b1_row2_col1, #T_e32b1_row2_col2, #T_e32b1_row2_col3, #T_e32b1_row2_col4, #T_e32b1_row3_col0, #T_e32b1_row3_col1, #T_e32b1_row3_col2, #T_e32b1_row3_col3, #T_e32b1_row3_col4, #T_e32b1_row4_col0, #T_e32b1_row4_col1, #T_e32b1_row4_col2, #T_e32b1_row4_col3, #T_e32b1_row4_col4, #T_e32b1_row5_col0, #T_e32b1_row5_col1, #T_e32b1_row5_col2, #T_e32b1_row5_col3, #T_e32b1_row5_col4, #T_e32b1_row6_col0, #T_e32b1_row6_col1, #T_e32b1_row6_col2, #T_e32b1_row6_col3, #T_e32b1_row6_col4, #T_e32b1_row7_col0, #T_e32b1_row7_col1, #T_e32b1_row7_col2, #T_e32b1_row7_col3, #T_e32b1_row7_col4, #T_e32b1_row8_col0, #T_e32b1_row8_col1, #T_e32b1_row8_col2, #T_e32b1_row8_col3, #T_e32b1_row8_col4, #T_e32b1_row10_col0, #T_e32b1_row10_col1, #T_e32b1_row10_col2, #T_e32b1_row10_col3, #T_e32b1_row10_col4, #T_e32b1_row11_col0, #T_e32b1_row11_col1, #T_e32b1_row11_col2, #T_e32b1_row11_col3, #T_e32b1_row11_col4, #T_e32b1_row12_col0, #T_e32b1_row12_col1, #T_e32b1_row12_col2, #T_e32b1_row12_col3, #T_e32b1_row12_col4, #T_e32b1_row13_col0, #T_e32b1_row13_col1, #T_e32b1_row13_col2, #T_e32b1_row13_col3, #T_e32b1_row13_col4, #T_e32b1_row14_col0, #T_e32b1_row14_col1, #T_e32b1_row14_col2, #T_e32b1_row14_col3, #T_e32b1_row14_col4, #T_e32b1_row15_col0, #T_e32b1_row15_col1, #T_e32b1_row15_col2, #T_e32b1_row15_col3, #T_e32b1_row15_col4, #T_e32b1_row18_col0, #T_e32b1_row18_col1, #T_e32b1_row18_col2, #T_e32b1_row18_col3, #T_e32b1_row18_col4, #T_e32b1_row19_col0, #T_e32b1_row19_col1, #T_e32b1_row19_col2, #T_e32b1_row19_col3, #T_e32b1_row19_col4, #T_e32b1_row20_col0, #T_e32b1_row20_col1, #T_e32b1_row20_col2, #T_e32b1_row20_col3, #T_e32b1_row20_col4, #T_e32b1_row21_col0, #T_e32b1_row21_col1, #T_e32b1_row21_col2, #T_e32b1_row21_col3, #T_e32b1_row21_col4, #T_e32b1_row22_col0, #T_e32b1_row22_col1, #T_e32b1_row22_col2, #T_e32b1_row22_col3, #T_e32b1_row22_col4, #T_e32b1_row23_col0, #T_e32b1_row23_col1, #T_e32b1_row23_col2, #T_e32b1_row23_col3, #T_e32b1_row23_col4, #T_e32b1_row24_col0, #T_e32b1_row24_col1, #T_e32b1_row24_col2, #T_e32b1_row24_col3, #T_e32b1_row24_col4, #T_e32b1_row25_col0, #T_e32b1_row25_col1, #T_e32b1_row25_col2, #T_e32b1_row25_col3, #T_e32b1_row25_col4, #T_e32b1_row27_col0, #T_e32b1_row27_col1, #T_e32b1_row27_col2, #T_e32b1_row27_col3, #T_e32b1_row27_col4, #T_e32b1_row28_col0, #T_e32b1_row28_col1, #T_e32b1_row28_col2, #T_e32b1_row28_col3, #T_e32b1_row28_col4, #T_e32b1_row29_col0, #T_e32b1_row29_col1, #T_e32b1_row29_col2, #T_e32b1_row29_col3, #T_e32b1_row29_col4, #T_e32b1_row30_col0, #T_e32b1_row30_col1, #T_e32b1_row30_col2, #T_e32b1_row30_col3, #T_e32b1_row30_col4, #T_e32b1_row31_col0, #T_e32b1_row31_col1, #T_e32b1_row31_col2, #T_e32b1_row31_col3, #T_e32b1_row31_col4 {
  background-color: lightgrey;
}
#T_e32b1_row9_col0, #T_e32b1_row9_col1, #T_e32b1_row9_col2, #T_e32b1_row9_col3, #T_e32b1_row9_col4, #T_e32b1_row16_col0, #T_e32b1_row16_col1, #T_e32b1_row16_col2, #T_e32b1_row16_col3, #T_e32b1_row16_col4, #T_e32b1_row17_col0, #T_e32b1_row17_col1, #T_e32b1_row17_col2, #T_e32b1_row17_col3, #T_e32b1_row17_col4, #T_e32b1_row26_col0, #T_e32b1_row26_col1, #T_e32b1_row26_col2, #T_e32b1_row26_col3, #T_e32b1_row26_col4 {
  background-color: yellow;
}
</style>
<table id="T_e32b1">
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_e32b1_level0_col0" class="col_heading level0 col0" >allowed</th>
      <th id="T_e32b1_level0_col1" class="col_heading level0 col1" >m</th>
      <th id="T_e32b1_level0_col2" class="col_heading level0 col2" >pol</th>
      <th id="T_e32b1_level0_col3" class="col_heading level0 col3" >result</th>
      <th id="T_e32b1_level0_col4" class="col_heading level0 col4" >terms</th>
    </tr>
    <tr>
      <th class="index_name level0" >Dipole</th>
      <th class="index_name level1" >Target</th>
      <th class="blank col0" >&nbsp;</th>
      <th class="blank col1" >&nbsp;</th>
      <th class="blank col2" >&nbsp;</th>
      <th class="blank col3" >&nbsp;</th>
      <th class="blank col4" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e32b1_level0_row0" class="row_heading level0 row0" rowspan="16">A2u</th>
      <th id="T_e32b1_level1_row0" class="row_heading level1 row0" >A1g</th>
      <td id="T_e32b1_row0_col0" class="data row0 col0" >False</td>
      <td id="T_e32b1_row0_col1" class="data row0 col1" >[0]</td>
      <td id="T_e32b1_row0_col2" class="data row0 col2" >['z']</td>
      <td id="T_e32b1_row0_col3" class="data row0 col3" >['E1g']</td>
      <td id="T_e32b1_row0_col4" class="data row0 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row1" class="row_heading level1 row1" >A2g</th>
      <td id="T_e32b1_row1_col0" class="data row1 col0" >False</td>
      <td id="T_e32b1_row1_col1" class="data row1 col1" >[0]</td>
      <td id="T_e32b1_row1_col2" class="data row1 col2" >['z']</td>
      <td id="T_e32b1_row1_col3" class="data row1 col3" >['E1g']</td>
      <td id="T_e32b1_row1_col4" class="data row1 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row2" class="row_heading level1 row2" >A1u</th>
      <td id="T_e32b1_row2_col0" class="data row2 col0" >False</td>
      <td id="T_e32b1_row2_col1" class="data row2 col1" >[0]</td>
      <td id="T_e32b1_row2_col2" class="data row2 col2" >['z']</td>
      <td id="T_e32b1_row2_col3" class="data row2 col3" >['E1u']</td>
      <td id="T_e32b1_row2_col4" class="data row2 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row3" class="row_heading level1 row3" >A2u</th>
      <td id="T_e32b1_row3_col0" class="data row3 col0" >False</td>
      <td id="T_e32b1_row3_col1" class="data row3 col1" >[0]</td>
      <td id="T_e32b1_row3_col2" class="data row3 col2" >['z']</td>
      <td id="T_e32b1_row3_col3" class="data row3 col3" >['E1u']</td>
      <td id="T_e32b1_row3_col4" class="data row3 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row4" class="row_heading level1 row4" >B1g</th>
      <td id="T_e32b1_row4_col0" class="data row4 col0" >False</td>
      <td id="T_e32b1_row4_col1" class="data row4 col1" >[0]</td>
      <td id="T_e32b1_row4_col2" class="data row4 col2" >['z']</td>
      <td id="T_e32b1_row4_col3" class="data row4 col3" >['E4g']</td>
      <td id="T_e32b1_row4_col4" class="data row4 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row5" class="row_heading level1 row5" >B1u</th>
      <td id="T_e32b1_row5_col0" class="data row5 col0" >False</td>
      <td id="T_e32b1_row5_col1" class="data row5 col1" >[0]</td>
      <td id="T_e32b1_row5_col2" class="data row5 col2" >['z']</td>
      <td id="T_e32b1_row5_col3" class="data row5 col3" >['E4u']</td>
      <td id="T_e32b1_row5_col4" class="data row5 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row6" class="row_heading level1 row6" >B2g</th>
      <td id="T_e32b1_row6_col0" class="data row6 col0" >False</td>
      <td id="T_e32b1_row6_col1" class="data row6 col1" >[0]</td>
      <td id="T_e32b1_row6_col2" class="data row6 col2" >['z']</td>
      <td id="T_e32b1_row6_col3" class="data row6 col3" >['E4g']</td>
      <td id="T_e32b1_row6_col4" class="data row6 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row7" class="row_heading level1 row7" >B2u</th>
      <td id="T_e32b1_row7_col0" class="data row7 col0" >False</td>
      <td id="T_e32b1_row7_col1" class="data row7 col1" >[0]</td>
      <td id="T_e32b1_row7_col2" class="data row7 col2" >['z']</td>
      <td id="T_e32b1_row7_col3" class="data row7 col3" >['E4u']</td>
      <td id="T_e32b1_row7_col4" class="data row7 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row8" class="row_heading level1 row8" >E1u</th>
      <td id="T_e32b1_row8_col0" class="data row8 col0" >False</td>
      <td id="T_e32b1_row8_col1" class="data row8 col1" >[0]</td>
      <td id="T_e32b1_row8_col2" class="data row8 col2" >['z']</td>
      <td id="T_e32b1_row8_col3" class="data row8 col3" >['A1u', 'A2u', 'E2u']</td>
      <td id="T_e32b1_row8_col4" class="data row8 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row9" class="row_heading level1 row9" >E1g</th>
      <td id="T_e32b1_row9_col0" class="data row9 col0" >True</td>
      <td id="T_e32b1_row9_col1" class="data row9 col1" >[0]</td>
      <td id="T_e32b1_row9_col2" class="data row9 col2" >['z']</td>
      <td id="T_e32b1_row9_col3" class="data row9 col3" >['A1g', 'A2g', 'E2g']</td>
      <td id="T_e32b1_row9_col4" class="data row9 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row10" class="row_heading level1 row10" >E2g</th>
      <td id="T_e32b1_row10_col0" class="data row10 col0" >False</td>
      <td id="T_e32b1_row10_col1" class="data row10 col1" >[0]</td>
      <td id="T_e32b1_row10_col2" class="data row10 col2" >['z']</td>
      <td id="T_e32b1_row10_col3" class="data row10 col3" >['E1g', 'E3g']</td>
      <td id="T_e32b1_row10_col4" class="data row10 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row11" class="row_heading level1 row11" >E2u</th>
      <td id="T_e32b1_row11_col0" class="data row11 col0" >False</td>
      <td id="T_e32b1_row11_col1" class="data row11 col1" >[0]</td>
      <td id="T_e32b1_row11_col2" class="data row11 col2" >['z']</td>
      <td id="T_e32b1_row11_col3" class="data row11 col3" >['E1u', 'E3u']</td>
      <td id="T_e32b1_row11_col4" class="data row11 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row12" class="row_heading level1 row12" >E3u</th>
      <td id="T_e32b1_row12_col0" class="data row12 col0" >False</td>
      <td id="T_e32b1_row12_col1" class="data row12 col1" >[0]</td>
      <td id="T_e32b1_row12_col2" class="data row12 col2" >['z']</td>
      <td id="T_e32b1_row12_col3" class="data row12 col3" >['E2u', 'E4u']</td>
      <td id="T_e32b1_row12_col4" class="data row12 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row13" class="row_heading level1 row13" >E3g</th>
      <td id="T_e32b1_row13_col0" class="data row13 col0" >False</td>
      <td id="T_e32b1_row13_col1" class="data row13 col1" >[0]</td>
      <td id="T_e32b1_row13_col2" class="data row13 col2" >['z']</td>
      <td id="T_e32b1_row13_col3" class="data row13 col3" >['E2g', 'E4g']</td>
      <td id="T_e32b1_row13_col4" class="data row13 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row14" class="row_heading level1 row14" >E4g</th>
      <td id="T_e32b1_row14_col0" class="data row14 col0" >False</td>
      <td id="T_e32b1_row14_col1" class="data row14 col1" >[0]</td>
      <td id="T_e32b1_row14_col2" class="data row14 col2" >['z']</td>
      <td id="T_e32b1_row14_col3" class="data row14 col3" >['B1g', 'B2g', 'E3g']</td>
      <td id="T_e32b1_row14_col4" class="data row14 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row15" class="row_heading level1 row15" >E4u</th>
      <td id="T_e32b1_row15_col0" class="data row15 col0" >False</td>
      <td id="T_e32b1_row15_col1" class="data row15 col1" >[0]</td>
      <td id="T_e32b1_row15_col2" class="data row15 col2" >['z']</td>
      <td id="T_e32b1_row15_col3" class="data row15 col3" >['B1u', 'B2u', 'E3u']</td>
      <td id="T_e32b1_row15_col4" class="data row15 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level0_row16" class="row_heading level0 row16" rowspan="16">E1u</th>
      <th id="T_e32b1_level1_row16" class="row_heading level1 row16" >A1g</th>
      <td id="T_e32b1_row16_col0" class="data row16 col0" >True</td>
      <td id="T_e32b1_row16_col1" class="data row16 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row16_col2" class="data row16 col2" >['x', 'y']</td>
      <td id="T_e32b1_row16_col3" class="data row16 col3" >['A1g', 'A2g', 'E2g']</td>
      <td id="T_e32b1_row16_col4" class="data row16 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row17" class="row_heading level1 row17" >A2g</th>
      <td id="T_e32b1_row17_col0" class="data row17 col0" >True</td>
      <td id="T_e32b1_row17_col1" class="data row17 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row17_col2" class="data row17 col2" >['x', 'y']</td>
      <td id="T_e32b1_row17_col3" class="data row17 col3" >['A1g', 'A2g', 'E2g']</td>
      <td id="T_e32b1_row17_col4" class="data row17 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row18" class="row_heading level1 row18" >A1u</th>
      <td id="T_e32b1_row18_col0" class="data row18 col0" >False</td>
      <td id="T_e32b1_row18_col1" class="data row18 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row18_col2" class="data row18 col2" >['x', 'y']</td>
      <td id="T_e32b1_row18_col3" class="data row18 col3" >['A1u', 'A2u', 'E2u']</td>
      <td id="T_e32b1_row18_col4" class="data row18 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row19" class="row_heading level1 row19" >A2u</th>
      <td id="T_e32b1_row19_col0" class="data row19 col0" >False</td>
      <td id="T_e32b1_row19_col1" class="data row19 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row19_col2" class="data row19 col2" >['x', 'y']</td>
      <td id="T_e32b1_row19_col3" class="data row19 col3" >['A1u', 'A2u', 'E2u']</td>
      <td id="T_e32b1_row19_col4" class="data row19 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row20" class="row_heading level1 row20" >B1g</th>
      <td id="T_e32b1_row20_col0" class="data row20 col0" >False</td>
      <td id="T_e32b1_row20_col1" class="data row20 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row20_col2" class="data row20 col2" >['x', 'y']</td>
      <td id="T_e32b1_row20_col3" class="data row20 col3" >['B1g', 'B2g', 'E3g']</td>
      <td id="T_e32b1_row20_col4" class="data row20 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row21" class="row_heading level1 row21" >B1u</th>
      <td id="T_e32b1_row21_col0" class="data row21 col0" >False</td>
      <td id="T_e32b1_row21_col1" class="data row21 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row21_col2" class="data row21 col2" >['x', 'y']</td>
      <td id="T_e32b1_row21_col3" class="data row21 col3" >['B1u', 'B2u', 'E3u']</td>
      <td id="T_e32b1_row21_col4" class="data row21 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row22" class="row_heading level1 row22" >B2g</th>
      <td id="T_e32b1_row22_col0" class="data row22 col0" >False</td>
      <td id="T_e32b1_row22_col1" class="data row22 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row22_col2" class="data row22 col2" >['x', 'y']</td>
      <td id="T_e32b1_row22_col3" class="data row22 col3" >['B1g', 'B2g', 'E3g']</td>
      <td id="T_e32b1_row22_col4" class="data row22 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row23" class="row_heading level1 row23" >B2u</th>
      <td id="T_e32b1_row23_col0" class="data row23 col0" >False</td>
      <td id="T_e32b1_row23_col1" class="data row23 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row23_col2" class="data row23 col2" >['x', 'y']</td>
      <td id="T_e32b1_row23_col3" class="data row23 col3" >['B1u', 'B2u', 'E3u']</td>
      <td id="T_e32b1_row23_col4" class="data row23 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row24" class="row_heading level1 row24" >E1u</th>
      <td id="T_e32b1_row24_col0" class="data row24 col0" >False</td>
      <td id="T_e32b1_row24_col1" class="data row24 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row24_col2" class="data row24 col2" >['x', 'y']</td>
      <td id="T_e32b1_row24_col3" class="data row24 col3" >['E1u', 'E3u']</td>
      <td id="T_e32b1_row24_col4" class="data row24 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row25" class="row_heading level1 row25" >E1g</th>
      <td id="T_e32b1_row25_col0" class="data row25 col0" >False</td>
      <td id="T_e32b1_row25_col1" class="data row25 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row25_col2" class="data row25 col2" >['x', 'y']</td>
      <td id="T_e32b1_row25_col3" class="data row25 col3" >['E1g', 'E3g']</td>
      <td id="T_e32b1_row25_col4" class="data row25 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row26" class="row_heading level1 row26" >E2g</th>
      <td id="T_e32b1_row26_col0" class="data row26 col0" >True</td>
      <td id="T_e32b1_row26_col1" class="data row26 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row26_col2" class="data row26 col2" >['x', 'y']</td>
      <td id="T_e32b1_row26_col3" class="data row26 col3" >['A1g', 'A2g', 'E2g', 'E4g']</td>
      <td id="T_e32b1_row26_col4" class="data row26 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row27" class="row_heading level1 row27" >E2u</th>
      <td id="T_e32b1_row27_col0" class="data row27 col0" >False</td>
      <td id="T_e32b1_row27_col1" class="data row27 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row27_col2" class="data row27 col2" >['x', 'y']</td>
      <td id="T_e32b1_row27_col3" class="data row27 col3" >['A1u', 'A2u', 'E2u', 'E4u']</td>
      <td id="T_e32b1_row27_col4" class="data row27 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row28" class="row_heading level1 row28" >E3u</th>
      <td id="T_e32b1_row28_col0" class="data row28 col0" >False</td>
      <td id="T_e32b1_row28_col1" class="data row28 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row28_col2" class="data row28 col2" >['x', 'y']</td>
      <td id="T_e32b1_row28_col3" class="data row28 col3" >['B1u', 'B2u', 'E1u', 'E3u']</td>
      <td id="T_e32b1_row28_col4" class="data row28 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row29" class="row_heading level1 row29" >E3g</th>
      <td id="T_e32b1_row29_col0" class="data row29 col0" >False</td>
      <td id="T_e32b1_row29_col1" class="data row29 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row29_col2" class="data row29 col2" >['x', 'y']</td>
      <td id="T_e32b1_row29_col3" class="data row29 col3" >['B1g', 'B2g', 'E1g', 'E3g']</td>
      <td id="T_e32b1_row29_col4" class="data row29 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row30" class="row_heading level1 row30" >E4g</th>
      <td id="T_e32b1_row30_col0" class="data row30 col0" >False</td>
      <td id="T_e32b1_row30_col1" class="data row30 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row30_col2" class="data row30 col2" >['x', 'y']</td>
      <td id="T_e32b1_row30_col3" class="data row30 col3" >['E2g', 'E4g']</td>
      <td id="T_e32b1_row30_col4" class="data row30 col4" >['A1g', 'E1u']</td>
    </tr>
    <tr>
      <th id="T_e32b1_level1_row31" class="row_heading level1 row31" >E4u</th>
      <td id="T_e32b1_row31_col0" class="data row31 col0" >False</td>
      <td id="T_e32b1_row31_col1" class="data row31 col1" >[-1, 1, -1, 1]</td>
      <td id="T_e32b1_row31_col2" class="data row31 col2" >['x', 'y']</td>
      <td id="T_e32b1_row31_col3" class="data row31 col3" >['E2u', 'E4u']</td>
      <td id="T_e32b1_row31_col4" class="data row31 col4" >['A1g', 'E1u']</td>
    </tr>
  </tbody>
</table>
</div></div>
</details>
</div>
<figure class="align-default" id="fig-dipoletermsd10he1u">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>allowed</th>
      <th>m</th>
      <th>pol</th>
      <th>result</th>
      <th>terms</th>
    </tr>
    <tr>
      <th>Dipole</th>
      <th>Target</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>A2u</th>
      <th>E1g</th>
      <td>True</td>
      <td>[0]</td>
      <td>[z]</td>
      <td>[A1g, A2g, E2g]</td>
      <td>[A1g, E1u]</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">E1u</th>
      <th>A1g</th>
      <td>True</td>
      <td>[-1, 1, -1, 1]</td>
      <td>[x, y]</td>
      <td>[A1g, A2g, E2g]</td>
      <td>[A1g, E1u]</td>
    </tr>
    <tr>
      <th>A2g</th>
      <td>True</td>
      <td>[-1, 1, -1, 1]</td>
      <td>[x, y]</td>
      <td>[A1g, A2g, E2g]</td>
      <td>[A1g, E1u]</td>
    </tr>
    <tr>
      <th>E2g</th>
      <td>True</td>
      <td>[-1, 1, -1, 1]</td>
      <td>[x, y]</td>
      <td>[A1g, A2g, E2g, E4g]</td>
      <td>[A1g, E1u]</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 6.2 </span><span class="caption-text">Dipole-allowed continuum symmetries (“Target”) for <span class="math notranslate nohighlight">\(D_{10h}\)</span>, <span class="math notranslate nohighlight">\(E_{1u}\)</span> ionization.</span><a class="headerlink" href="#fig-dipoletermsd10he1u" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The allowed terms can be further expressed in terms of the spherical harmonic components.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Basis table with the Character values limited to those defined in </span>
<span class="c1"># self.continuum[&#39;allowed&#39;][&#39;PD&#39;] Target column</span>
<span class="n">symObjE1u</span><span class="o">.</span><span class="n">displayXlm</span><span class="p">(</span><span class="n">symFilter</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">YlmType</span><span class="o">=</span><span class="s1">&#39;comp&#39;</span><span class="p">)</span> 

<span class="c1"># Glue table for later</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;dipoleTermsD10hBasis&quot;</span><span class="p">,</span> <span class="n">symObjE1u</span><span class="o">.</span><span class="n">displayXlm</span><span class="p">(</span><span class="n">symFilter</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
                                                  <span class="n">YlmType</span><span class="o">=</span><span class="s1">&#39;comp&#39;</span><span class="p">,</span> <span class="n">returnPD</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="5" halign="left">b</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>l</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
    <tr>
      <th>Character ($\Gamma$)</th>
      <th>SALC (h)</th>
      <th>PFIX ($\mu$)</th>
      <th>m</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">A1g</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <td>(1+0j)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td>(1+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(1+0j)</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">E1g</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="2" valign="top">0</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="2" valign="top">0</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">E2g</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="2" valign="top">0</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="2" valign="top">0</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<figure class="align-default" id="fig-dipoletermsd10hbasis">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th colspan="5" halign="left">b</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th></th>
      <th>l</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
    <tr>
      <th>Character ($\Gamma$)</th>
      <th>SALC (h)</th>
      <th>PFIX ($\mu$)</th>
      <th>m</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">A1g</th>
      <th>0</th>
      <th>0</th>
      <th>0</th>
      <td>(1+0j)</td>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td>(1+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <th>0</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(1+0j)</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">E1g</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="2" valign="top">0</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="2" valign="top">0</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">E2g</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="2" valign="top">0</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
      <td></td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="2" valign="top">0</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>2</th>
      <td></td>
      <td></td>
      <td></td>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 6.3 </span><span class="caption-text">Dipole-allowed basis set for <span class="math notranslate nohighlight">\(D_{10h}\)</span>, <span class="math notranslate nohighlight">\(E_{1u}\)</span> ionization.</span><a class="headerlink" href="#fig-dipoletermsd10hbasis" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="mapping-symmetrized-harmonics-to-fit-parameters">
<span id="sec-basis-sets-mapping-params"></span><h3><span class="section-number">6.3.4. </span>Mapping symmetrized harmonics to fit parameters<a class="headerlink" href="#mapping-symmetrized-harmonics-to-fit-parameters" title="Permalink to this heading">#</a></h3>
<p>The final preparatory steps for tackling a specific retrieval problem is to map the allowed channels to photoionization matrix elements - including the assignment of any missing terms - and from these to fitting paramters. The matrix elements are currently defined in the <a class="reference external" href="https://github.com/phockett/PEMtk">Photoelectron Metrology Toolkit</a> <span id="id6">[<a class="reference internal" href="../backmatter/bibliography.html#id682" title="Paul Hockett. Photoelectron Metrology Toolkit (PEMtk) Github repository. 2021. URL: https://github.com/phockett/PEMtk (visited on 2022-02-18).">5</a>]</span> and the <a class="reference external" href="https://epsproc.readthedocs.io">ePSproc codebase</a> <span id="id7">[<a class="reference internal" href="../backmatter/bibliography.html#id666" title="Paul Hockett. ePSproc: Post-processing suite for ePolyScat electron-molecule scattering calculations. Authorea, 2016. URL: https://www.authorea.com/users/71114/articles/122402/_show_article, doi:10.6084/m9.figshare.3545639.">33</a>, <a class="reference internal" href="../backmatter/bibliography.html#id608" title="Paul Hockett. ePSproc: Post-processing for ePolyScat (Github repository). Github, 2016. URL: https://github.com/phockett/ePSproc, doi:10.6084/m9.figshare.3545639.">34</a>, <a class="reference internal" href="../backmatter/bibliography.html#id606" title="Paul Hockett. ePSproc: Post-processing for ePolyScat documentation. 2020. URL: https://epsproc.readthedocs.io (visited on 2022-02-18).">35</a>]</span> following the definitions in <a class="reference external" href="https://epolyscat.droppages.com/">ePolyScat (ePS)</a> <span id="id8">[<a class="reference internal" href="../backmatter/bibliography.html#id764" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18), doi:10.1016/0370-1573(86)90147-X.">36</a>, <a class="reference internal" href="../backmatter/bibliography.html#id628" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13), doi:10.1063/1.467237.">37</a>, <a class="reference internal" href="../backmatter/bibliography.html#id805" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18), doi:10.1063/1.479794.">38</a>, <a class="reference internal" href="../backmatter/bibliography.html#id767" title="R R Lucchese. ePolyScat User's Manual. URL: https://epolyscat.droppages.com/ (visited on 2022-04-26).">39</a>]</span>, and the symmetry-defined cases can be remapped to this format. (Further information can be found in the <a class="reference external" href="https://pemtk.readthedocs.io">PEMtk documentation</a> <span id="id9">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Paul Hockett. PEMtk - the Photoelectron Metrology Toolkit - documentation. 2021. URL: https://pemtk.readthedocs.io (visited on 2022-02-18).">20</a>]</span>.) For a comparison with <em>ab initio</em> matrix elements, see <a class="reference internal" href="#sec-basis-sets-comparison-with-abinitio"><span class="std std-numref">Sect. 6.4</span></a>.</p>
<ol class="arabic simple">
<li><p>For symmetry-defined basis sets, these must first be mapped to an ePSproc data structure, although this step is not necessary when working from <em>ab initio</em> basis sets. This is explored in <a class="reference internal" href="#sec-basis-sets-remapping-to-eps"><span class="std std-numref">Sect. 6.3.4.1</span></a>.</p></li>
<li><p>From a given basis set, the parameters used for fitting data are determined. This converts the parameters to <a class="reference external" href="https://lmfit.github.io/lmfit-py/intro.html"><code class="docutils literal notranslate"><span class="pre">lmfit</span></code> library</a> <span id="id10">[<a class="reference internal" href="../backmatter/bibliography.html#id758" title="LMFIT documentation. URL: https://lmfit.github.io/lmfit-py/intro.html (visited on 2022-08-03).">66</a>, <a class="reference internal" href="../backmatter/bibliography.html#id806" title="Matthew Newville, Till Stensitzki, Daniel B. Allen, and Antonino Ingargiola. LMFIT: Non-Linear Least-Square Minimization and Curve-Fitting for Python. Zenodo, September 2014. URL: https://zenodo.org/record/11813 (visited on 2022-08-03), doi:10.5281/zenodo.11813.">67</a>]</span> objects in magnitude-phase form, and (optionally) sets various symmetry relations and constraints. This is explored in <a class="reference internal" href="#sec-basis-sets-remapping-to-fittingparams"><span class="std std-numref">Sect. 6.3.4.2</span></a>.</p></li>
</ol>
<p>Further examples can be found in the remainder of this text, and also in the <a class="reference external" href="https://pemtk.readthedocs.io">PEMtk documentation</a> <span id="id11">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Paul Hockett. PEMtk - the Photoelectron Metrology Toolkit - documentation. 2021. URL: https://pemtk.readthedocs.io (visited on 2022-02-18).">20</a>]</span>.</p>
<section id="remapping-to-epolyscat-definitions">
<span id="sec-basis-sets-remapping-to-eps"></span><h4><span class="section-number">6.3.4.1. </span>Remapping to ePolyScat definitions<a class="headerlink" href="#remapping-to-epolyscat-definitions" title="Permalink to this heading">#</a></h4>
<p>In the remapping, the code attempts to assign all the symmetries matching ePolyScat definitions from the direct products. A worked example is given in the code blocks in this section, including a full output table and graphical illustration (<a class="reference internal" href="#fig-materemapd10ha1g"><span class="std std-numref">Fig. 6.4</span></a>).</p>
<p>The terms are:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Cont</span></code> is the continuum (free electron) symmetry, <span class="math notranslate nohighlight">\(\Gamma^{e}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Targ</span></code> is the target state symmetry, <span class="math notranslate nohighlight">\(\Gamma^{+}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Total</span></code> is the overall symmetry of the scattering state, <span class="math notranslate nohighlight">\(\Gamma_{\mathrm{scat}}=\Gamma^{+}\otimes\Gamma^{e}\)</span>.</p></li>
</ol>
<p>Additionally, the current default remapping changes some of the terms defined by the symmetrized harmonics routines and conventions:</p>
<ul class="simple">
<li><p>Symmetry <code class="docutils literal notranslate"><span class="pre">C</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Cont</span></code> (continuum symmetry label in ePSproc)</p></li>
<li><p>Index <code class="docutils literal notranslate"><span class="pre">h</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">it</span></code> (degeneracy index in ePSproc)</p></li>
<li><p>Index <code class="docutils literal notranslate"><span class="pre">mu</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">muX</span></code> (to avoid confusion with photon index <code class="docutils literal notranslate"><span class="pre">mu</span></code> in ePSproc)</p></li>
</ul>
<p>Note, in particular, that <span class="math notranslate nohighlight">\(\mu\)</span> is - unfortunately - the photon polarization term in the conventional photoionization equations, but also used in the standard definition of the symmetrized harmonics as a degeneracy index. In some cases, the symmetrization indicies <span class="math notranslate nohighlight">\(\mu\)</span> or <span class="math notranslate nohighlight">\(h\)</span> may be redundant, and can be dropped or summed over, but care must be taken here to avoid breaking the symmetry of the simplified basis set.</p>
<p>Finally, the remapping adds additional labels used by <a class="reference external" href="https://epolyscat.droppages.com/">ePolyScat (ePS)</a> <span id="id12">[<a class="reference internal" href="../backmatter/bibliography.html#id764" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18), doi:10.1016/0370-1573(86)90147-X.">36</a>, <a class="reference internal" href="../backmatter/bibliography.html#id628" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13), doi:10.1063/1.467237.">37</a>, <a class="reference internal" href="../backmatter/bibliography.html#id805" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18), doi:10.1063/1.479794.">38</a>, <a class="reference internal" href="../backmatter/bibliography.html#id767" title="R R Lucchese. ePolyScat User's Manual. URL: https://epolyscat.droppages.com/ (visited on 2022-04-26).">39</a>]</span>, but which are not necessarily required in general:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Type</span></code>: for ePolyScat results, this labels length or velocity gauge results; this is assigned as <code class="docutils literal notranslate"><span class="pre">U</span></code> (unassigned) in the conversion.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Eke</span></code>: the photoelectron kinetic energy, for the basis states this is just set to 0.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mu</span></code>: this is set to NaN by the main routine; if the ionizing channel symmetries are defined these values (the photon polarization) can be determined from the dipole-allowed terms, and this is done by the <code class="docutils literal notranslate"><span class="pre">assignSymMuTerms()</span></code> method, as illustrated below.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run conversion with a different dimMap &amp; dataType - note this includes all symmetries, </span>
<span class="c1"># and both real and complex harmonic basis sets</span>
<span class="n">dataType</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span>

<span class="c1"># With custom dim mapping (optional)...</span>
<span class="n">dimMap</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span><span class="s1">&#39;Cont&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">:</span><span class="s1">&#39;it&#39;</span><span class="p">}</span>   <span class="c1"># Default dimMap = {&#39;C&#39;:&#39;Cont&#39;,&#39;h&#39;:&#39;it&#39;, &#39;mu&#39;:&#39;muX&#39;}  </span>
<span class="c1"># dimMap = {&#39;C&#39;:&#39;Cont&#39;,&#39;h&#39;:&#39;it&#39;, &#39;mu&#39;:&#39;muX&#39;}  # Default case</span>

<span class="c1"># Map to ePSproc definitions</span>
<span class="n">symObjA1g</span><span class="o">.</span><span class="n">toePSproc</span><span class="p">(</span><span class="n">dataType</span><span class="o">=</span><span class="n">dataType</span><span class="p">,</span> <span class="n">dimMap</span><span class="o">=</span><span class="n">dimMap</span><span class="p">)</span>

<span class="c1"># To assign specific terms, use self.assignMissingSym</span>
<span class="c1"># Note this can take a single value, or a list which must match the size of the </span>
<span class="c1"># Sym multiindex defined in the Xarray dataset.</span>
<span class="n">symObjA1g</span><span class="o">.</span><span class="n">assignMissingSym</span><span class="p">(</span><span class="s1">&#39;Targ&#39;</span><span class="p">,</span> <span class="n">sIonSG</span><span class="p">)</span>

<span class="c1"># To define terms from produts, use self.assignMissingSymProd</span>
<span class="n">symObjA1g</span><span class="o">.</span><span class="n">assignMissingSymProd</span><span class="p">()</span>

<span class="c1"># To attempt to assign mu values (by symmetry), use self.assignSymMuTerms()</span>
<span class="n">symObjA1g</span><span class="o">.</span><span class="n">assignSymMuTerms</span><span class="p">()</span>

<span class="c1"># Show Pandas table of results</span>
<span class="n">symObjA1g</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;symAllowed&#39;</span><span class="p">][</span><span class="s1">&#39;PD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {&#39;C&#39;: &#39;Cont&#39;, &#39;mu&#39;: &#39;it&#39;}
Added dim Eke
Added dim Targ
Added dim Total
Added dim mu
Added dim Type
*** Updated self.coeffs[&#39;matE&#39;] with new coords.
Assigned &#39;Total&#39; from A1g x A1g = [&#39;A1g&#39;]
Assigned &#39;Total&#39; from A1g x A2u = [&#39;A2u&#39;]
Assigned &#39;Total&#39; from A1g x E1g = [&#39;E1g&#39;]
Assigned &#39;Total&#39; from A1g x E1u = [&#39;E1u&#39;]
Assigned &#39;Total&#39; from A1g x E2g = [&#39;E2g&#39;]
Assigned &#39;Total&#39; from A1g x E2u = [&#39;E2u&#39;]
Assigned &#39;Total&#39; from A1g x E3g = [&#39;E3g&#39;]
Assigned &#39;Total&#39; from A1g x E3u = [&#39;E3u&#39;]
Assigned &#39;Total&#39; from A1g x E4g = [&#39;E4g&#39;]
*** Updated self.coeffs[&#39;matE&#39;] with new coords.
Assigned dipole-allowed terms for dim = &#39;Cont&#39; to self.coeffs[&#39;symAllowed&#39;]
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>Cont</th>
      <th>A2u</th>
      <th>E1u</th>
    </tr>
    <tr>
      <th>Eke</th>
      <th>Targ</th>
      <th>Total</th>
      <th>Type</th>
      <th>h</th>
      <th>it</th>
      <th>l</th>
      <th>m</th>
      <th>mu</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="18" valign="top">0</th>
      <th rowspan="18" valign="top">A1g</th>
      <th rowspan="2" valign="top">A2u</th>
      <th rowspan="2" valign="top">U</th>
      <th>0</th>
      <th>0</th>
      <th>1</th>
      <th>0</th>
      <th>0</th>
      <td>(1+0j)</td>
      <td></td>
    </tr>
    <tr>
      <th>1</th>
      <th>0</th>
      <th>3</th>
      <th>0</th>
      <th>0</th>
      <td>(1+0j)</td>
      <td></td>
    </tr>
    <tr>
      <th rowspan="16" valign="top">E1u</th>
      <th rowspan="16" valign="top">U</th>
      <th rowspan="8" valign="top">0</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="2" valign="top">-1</th>
      <th>-1</th>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="2" valign="top">-1</th>
      <th>-1</th>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">1</th>
      <th rowspan="4" valign="top">0</th>
      <th rowspan="4" valign="top">3</th>
      <th rowspan="2" valign="top">-1</th>
      <th>-1</th>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">1</th>
      <th rowspan="4" valign="top">3</th>
      <th rowspan="2" valign="top">-1</th>
      <th>-1</th>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(-0.7071067811865475+0j)</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">1</th>
      <th>-1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
    <tr>
      <th>1</th>
      <td></td>
      <td>(-0.7071067811865475-0j)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot values</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="n">titleString</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Symmetrized matrix elements defined for </span><span class="si">{</span><span class="n">sym</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="n">sNeutral</span><span class="si">}</span><span class="s1">$^</span><span class="se">{{</span><span class="s1">-1</span><span class="se">}}</span><span class="s1">$ ionization&#39;</span>

<span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">gFig</span> <span class="o">=</span>  <span class="n">ep</span><span class="o">.</span><span class="n">lmPlot</span><span class="p">(</span><span class="n">symObjA1g</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;symAllowed&#39;</span><span class="p">][</span><span class="s1">&#39;XR&#39;</span><span class="p">][</span><span class="s1">&#39;b (comp)&#39;</span><span class="p">],</span> 
                      <span class="n">titleString</span><span class="o">=</span><span class="n">titleString</span><span class="p">,</span> <span class="n">xDim</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;LM&#39;</span><span class="p">:[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">]},</span> <span class="n">sumDims</span><span class="o">=</span><span class="s1">&#39;h&#39;</span><span class="p">,</span>
                      <span class="n">labelCols</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># Glue figure for later</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;matEremapD10hA1g&quot;</span><span class="p">,</span> <span class="n">gFig</span><span class="o">.</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set dataType (No dataType)
Set dataType (No dataType)
Plotting data (No filename), pType=a, thres=0.01, with Seaborn
</pre></div>
</div>
<img alt="../_images/8896575d1a3ed143693e38b575aa962f59770d2327eeb5043f112986f894ae0b.png" src="../_images/8896575d1a3ed143693e38b575aa962f59770d2327eeb5043f112986f894ae0b.png" />
</div>
</details>
</div>
<figure class="align-default" id="fig-materemapd10ha1g">
<img alt="../_images/8896575d1a3ed143693e38b575aa962f59770d2327eeb5043f112986f894ae0b.png" src="../_images/8896575d1a3ed143693e38b575aa962f59770d2327eeb5043f112986f894ae0b.png" />
<figcaption>
<p><span class="caption-number">Fig. 6.4 </span><span class="caption-text">Dipole-allowed continuum matrix elements for <span class="math notranslate nohighlight">\(D_{10h}\)</span>, <span class="math notranslate nohighlight">\(A_{1g}\)</span> ionization, arranged by <span class="math notranslate nohighlight">\((l,m)\)</span>.</span><a class="headerlink" href="#fig-materemapd10ha1g" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="mapping-to-fitting-parameters-and-reduction">
<span id="sec-basis-sets-remapping-to-fittingparams"></span><h4><span class="section-number">6.3.4.2. </span>Mapping to fitting parameters (and reduction)<a class="headerlink" href="#mapping-to-fitting-parameters-and-reduction" title="Permalink to this heading">#</a></h4>
<p>Finally, the basis set of matrix elements can be assigned to a set of fitting parameters. In this case, as per Eq. <a class="reference internal" href="../part1/theory_tensor_formalism_160723.html#equation-eqn-i-zeta-mag-phase">(3.15)</a>, the parameters are mapped to magnitude-phase form; additionally, the fitting routine allows for the definition of relationships between the parameters. This provides a way to reduce the effective size of the basis set to only the unique values, with other terms defined purely by their symmetry relations. Consequently, degenerate cases, as detailed above, as well as cases with defined phase relations, can be efficiently reduced to a smaller basis set for fitting. Note that the default routine labels parameters by the full set of quantum numbers, with an <code class="docutils literal notranslate"><span class="pre">m</span></code> or <code class="docutils literal notranslate"><span class="pre">p</span></code> prefix to denote the magnitude and phase terms corresponding to the partial-wave channel; this ensures a unique naming scheme, but is also rather unwieldy (as can be seen below). In cases where fewer quantum numbers are required these can be defined and the parameter names remapped, see the <a class="reference external" href="https://pemtk.readthedocs.io">PEMtk documentation</a> <span id="id13">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Paul Hockett. PEMtk - the Photoelectron Metrology Toolkit - documentation. 2021. URL: https://pemtk.readthedocs.io (visited on 2022-02-18).">20</a>]</span> for further details.</p>
<p>For quick setup, there is an automated routine to set relations if applicable. The automated routine currently checks for the following relationships: identity (equal complex values), magnitude and phase equality, complex rotations by <span class="math notranslate nohighlight">\(\pm\pi\)</span>, where matrix elements are grouped by symmetry (specifically <code class="docutils literal notranslate"><span class="pre">Cont</span></code>) and <code class="docutils literal notranslate"><span class="pre">l</span></code> prior to pair-wise testing. For more control, additional functions can be passed. Alternatively, the automatic setting can be skipped and/or relationships redefined or set manually. This provides a way to test if the symmetry-definitions are manifest in experimental data, rather than imposing them during fitting, or to explore other possible correlations between fitted parameters. Note, however, that in some cases the number of unique parameters in an unsymmetrized case may be large, so care should also be taken to ensure that fit results are meaningful in such cases (e.g. by employing a sufficiently large dataset, and testing for reproducibility).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Default matrix element relationship tests are set by symCheckDefns</span>
<span class="kn">from</span> <span class="nn">pemtk.fit._sym</span> <span class="kn">import</span> <span class="n">symCheckDefns</span>

<span class="n">symCheckDefns</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;i&#39;: {&#39;name&#39;: &#39;identity&#39;,
  &#39;lam&#39;: &lt;function pemtk.fit._sym.symCheckDefns.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;,
  &#39;transform&#39;: False,
  &#39;constraint&#39;: &#39;x&#39;},
 &#39;abs&#39;: {&#39;name&#39;: &#39;abs&#39;,
  &#39;lam&#39;: &lt;function pemtk.fit._sym.symCheckDefns.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;,
  &#39;transform&#39;: True,
  &#39;constraint&#39;: &#39;m_x&#39;},
 &#39;phase&#39;: {&#39;name&#39;: &#39;phase&#39;,
  &#39;lam&#39;: &lt;function pemtk.fit._sym.symCheckDefns.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;,
  &#39;transform&#39;: True,
  &#39;constraint&#39;: &#39;p_x&#39;},
 &#39;crot_p&#39;: {&#39;name&#39;: &#39;Complex rotation +pi/2&#39;,
  &#39;lam&#39;: &lt;function pemtk.fit._sym.symCheckDefns.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;,
  &#39;transform&#39;: False,
  &#39;constraint&#39;: &#39;arctan2(sin(p_x+pi/2), cos(p_x+pi/2))&#39;},
 &#39;crot_m&#39;: {&#39;name&#39;: &#39;Complex rotation -pi/2&#39;,
  &#39;lam&#39;: &lt;function pemtk.fit._sym.symCheckDefns.&lt;locals&gt;.&lt;lambda&gt;(x)&gt;,
  &#39;transform&#39;: False,
  &#39;constraint&#39;: &#39;arctan2(sin(p_x-pi/2), cos(p_x-pi/2))&#39;}}
</pre></div>
</div>
</div>
</div>
<p><strong>Automated assignment from defined matrix elements</strong></p>
<p>The code blocks below illustrate the automated routine, and results are tabulated in <a class="reference internal" href="#fig-fittingparamsd10ha1g"><span class="std std-numref">Fig. 6.5</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pemtk.fit.fitClass</span> <span class="kn">import</span> <span class="n">pemtkFit</span>

<span class="c1"># Example using data class (setup in init script)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pemtkFit</span><span class="p">()</span>

<span class="c1"># Set to new key in data class</span>
<span class="n">dataKey</span> <span class="o">=</span> <span class="n">sym</span>
<span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dataKey</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># Assign allowed matrix elements to fit object</span>
<span class="n">dataType</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span>
<span class="c1"># General case - just use complex coeffs directly</span>
<span class="c1"># data.data[dataKey][dataType] = symObj.coeffs[dataType][&#39;b (comp)&#39;]</span>

<span class="c1"># Specific case - e.g. sum over &#39;h&#39;</span>
<span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dataKey</span><span class="p">][</span><span class="n">dataType</span><span class="p">]</span> <span class="o">=</span> <span class="n">symObjA1g</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;symAllowed&#39;</span><span class="p">][</span><span class="s1">&#39;XR&#39;</span><span class="p">][</span><span class="s1">&#39;b (comp)&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span>

<span class="c1"># Propagate attrs</span>
<span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">dataKey</span><span class="p">][</span><span class="n">dataType</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="n">symObjA1g</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;symAllowed&#39;</span><span class="p">][</span><span class="s1">&#39;XR&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Update selection with options</span>
<span class="c1"># E.g. Matrix element sub-selection</span>
<span class="c1"># data.selOpts[&#39;matE&#39;] = {&#39;thres&#39;: 0.01, &#39;inds&#39;: {&#39;Type&#39;:&#39;U&#39;,&#39;Cont&#39;:&#39;A1&#39;}}</span>
<span class="n">data</span><span class="o">.</span><span class="n">selOpts</span><span class="p">[</span><span class="s1">&#39;matE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;thres&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Type&#39;</span><span class="p">:</span><span class="s1">&#39;U&#39;</span><span class="p">}}</span>
<span class="n">data</span><span class="o">.</span><span class="n">setSubset</span><span class="p">(</span><span class="n">dataKey</span> <span class="o">=</span> <span class="n">sym</span><span class="p">,</span> <span class="n">dataType</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span><span class="p">)</span>  <span class="c1">#, resetSelectors=True)  # Subselect from &#39;orb5&#39; dataset, matrix elements</span>

<span class="c1"># And for the polarisation geometries...</span>
<span class="c1"># data.selOpts[&#39;pol&#39;] = {&#39;inds&#39;: {&#39;Labels&#39;: &#39;z&#39;}}</span>
<span class="c1"># data.setSubset(dataKey = &#39;pol&#39;, dataType = &#39;pol&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Subselected from dataset &#39;D10h&#39;, dataType &#39;matE&#39;: 72 from 540 points (13.33%)
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set matrix elements to fitting parameters</span>
<span class="c1"># Running for the default case will attempt to automatically set the relations between </span>
<span class="c1"># matrix elements according to symmetry.</span>
<span class="n">data</span><span class="o">.</span><span class="n">setMatEFit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set 18 complex matrix elements to 36 fitting params, see self.params for details.
Auto-setting parameters.
</pre></div>
</div>
<div class="output text_html"><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:left'>vary</th><th style='text-align:right'>expression</th></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 1.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 1.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>m_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_1_n1_n1_0</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_1_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_1_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_1_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_1_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_1_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_3_n1_n1_0</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_3_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_3_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_3_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_3_n1_n1_1</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'>p_E1u_0_A1g_E1u_3_n1_n1_1</td></tr></table></div></div>
</details>
</div>
<div class="cell tag_hide-cell tag_hide-output docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell content</span>
<span class="expanded">Hide code cell content</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Glue table for later</span>
<span class="c1"># Need wrapper here otherwise get plain text in current HTML builds, and print(data.params) in PDF version (no data.params._repr_latex_())</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;fittingParamsD10hA1g&quot;</span><span class="p">,</span> <span class="n">params_to_dataframe</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">))</span>

<span class="c1"># display(data.params)</span>
</pre></div>
</div>
</div>
</details>
</div>
<figure class="align-default" id="fig-fittingparamsd10ha1g">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>value</th>
      <th>stderr</th>
      <th>vary</th>
      <th>expr</th>
      <th>init_value</th>
      <th>min</th>
      <th>max</th>
      <th>brute_step</th>
      <th>correl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>m_A2u_0_A1g_A2u_1_0_0_0</td>
      <td>1.000</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>1.000</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>1</th>
      <td>m_A2u_0_A1g_A2u_3_0_0_0</td>
      <td>1.000</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>1.000</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>2</th>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>3</th>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>4</th>
      <td>m_E1u_0_A1g_E1u_1_n1_1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>5</th>
      <td>m_E1u_0_A1g_E1u_1_n1_1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>6</th>
      <td>m_E1u_0_A1g_E1u_1_1_n1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>7</th>
      <td>m_E1u_0_A1g_E1u_1_1_n1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>8</th>
      <td>m_E1u_0_A1g_E1u_1_1_1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>9</th>
      <td>m_E1u_0_A1g_E1u_1_1_1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>10</th>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>11</th>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>12</th>
      <td>m_E1u_0_A1g_E1u_3_n1_1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>13</th>
      <td>m_E1u_0_A1g_E1u_3_n1_1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>14</th>
      <td>m_E1u_0_A1g_E1u_3_1_n1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>15</th>
      <td>m_E1u_0_A1g_E1u_3_1_n1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>16</th>
      <td>m_E1u_0_A1g_E1u_3_1_1_0</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>17</th>
      <td>m_E1u_0_A1g_E1u_3_1_1_1</td>
      <td>0.707</td>
      <td>None</td>
      <td>False</td>
      <td>m_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.707</td>
      <td>1.000e-04</td>
      <td>5.000</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>18</th>
      <td>p_A2u_0_A1g_A2u_1_0_0_0</td>
      <td>0.000</td>
      <td>None</td>
      <td>False</td>
      <td>None</td>
      <td>0.000</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>19</th>
      <td>p_A2u_0_A1g_A2u_3_0_0_0</td>
      <td>0.000</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.000</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>20</th>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.000</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.000</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>21</th>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>22</th>
      <td>p_E1u_0_A1g_E1u_1_n1_1_0</td>
      <td>0.000</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_0</td>
      <td>0.000</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>23</th>
      <td>p_E1u_0_A1g_E1u_1_n1_1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>24</th>
      <td>p_E1u_0_A1g_E1u_1_1_n1_0</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>25</th>
      <td>p_E1u_0_A1g_E1u_1_1_n1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>26</th>
      <td>p_E1u_0_A1g_E1u_1_1_1_0</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>27</th>
      <td>p_E1u_0_A1g_E1u_1_1_1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_1_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>28</th>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.000</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>0.000</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>29</th>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>True</td>
      <td>None</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>30</th>
      <td>p_E1u_0_A1g_E1u_3_n1_1_0</td>
      <td>0.000</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_0</td>
      <td>0.000</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>31</th>
      <td>p_E1u_0_A1g_E1u_3_n1_1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>32</th>
      <td>p_E1u_0_A1g_E1u_3_1_n1_0</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>33</th>
      <td>p_E1u_0_A1g_E1u_3_1_n1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>34</th>
      <td>p_E1u_0_A1g_E1u_3_1_1_0</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
    <tr>
      <th>35</th>
      <td>p_E1u_0_A1g_E1u_3_1_1_1</td>
      <td>3.142</td>
      <td>None</td>
      <td>False</td>
      <td>p_E1u_0_A1g_E1u_3_n1_n1_1</td>
      <td>3.142</td>
      <td>-3.142e+00</td>
      <td>3.142</td>
      <td>None</td>
      <td>None</td>
    </tr>
  </tbody>
</table>
</div></div><figcaption>
<p><span class="caption-number">Fig. 6.5 </span><span class="caption-text">Fitting parameters as assigned for <span class="math notranslate nohighlight">\(D_{10h}\)</span>, <span class="math notranslate nohighlight">\(A_{1g}\)</span> ionization. Note the <code class="docutils literal notranslate"><span class="pre">vary</span></code> column, which defines the symmetry-unique values for fitting, whilst the <code class="docutils literal notranslate"><span class="pre">expression</span></code> column indicates the relationships of the non-unique values to the floated parameters.</span><a class="headerlink" href="#fig-fittingparamsd10ha1g" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><strong>Modifying fitting basis parameters</strong></p>
<p>A brief illustration of defining constraints is given below, for more details see the <a class="reference external" href="https://pemtk.readthedocs.io">PEMtk documentation</a> <span id="id14">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Paul Hockett. PEMtk - the Photoelectron Metrology Toolkit - documentation. 2021. URL: https://pemtk.readthedocs.io (visited on 2022-02-18).">20</a>]</span>, particularly the <a class="reference external" href="https://pemtk.readthedocs.io/en/latest/fitting/PEMtk_fitting_basic_demo_030621-full_010922.html#Setting-parameter-relations/constraints">basic fitting guide</a>. For more details on the base lmfit parameters class that is used here, see <a class="reference external" href="https://lmfit.github.io/lmfit-py/intro.html"><code class="docutils literal notranslate"><span class="pre">lmfit</span></code> library</a> <span id="id15">[<a class="reference internal" href="../backmatter/bibliography.html#id758" title="LMFIT documentation. URL: https://lmfit.github.io/lmfit-py/intro.html (visited on 2022-08-03).">66</a>, <a class="reference internal" href="../backmatter/bibliography.html#id806" title="Matthew Newville, Till Stensitzki, Daniel B. Allen, and Antonino Ingargiola. LMFIT: Non-Linear Least-Square Minimization and Curve-Fitting for Python. Zenodo, September 2014. URL: https://zenodo.org/record/11813 (visited on 2022-08-03), doi:10.5281/zenodo.11813.">67</a>]</span>, particularly the documentation on <a class="reference external" href="https://lmfit.github.io/lmfit-py/parameters.html">parameters</a> and <a class="reference external" href="https://lmfit.github.io/lmfit-py/constraints.html">constraints</a>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Full tabulations of the parameters available in HTML or notebook formats only.</p>
</div>
</aside>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set parameters with NO constraints set (except a reference phase)</span>
<span class="n">data</span><span class="o">.</span><span class="n">setMatEFit</span><span class="p">(</span><span class="n">paramsCons</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set 18 complex matrix elements to 36 fitting params, see self.params for details.
</pre></div>
</div>
<div class="output text_html"><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:right'>vary</th></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 1.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 1.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>False</td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr></table></div></div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To add manual constraints</span>
<span class="c1"># Set param constraints as dict</span>
<span class="c1"># Any basic mathematical relations can be set here, </span>
<span class="c1"># see https://lmfit.github.io/lmfit-py/constraints.html</span>
<span class="n">paramsCons</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">paramsCons</span><span class="p">[</span><span class="s1">&#39;m_A2u_0_A1g_A2u_1_0_0_0&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;5*m_A2u_0_A1g_A2u_3_0_0_0&#39;</span>

<span class="c1"># Missing settings will generate an error message</span>
<span class="n">paramsCons</span><span class="p">[</span><span class="s1">&#39;test&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;p_PU_SG_PU_3_1_n1_1&#39;</span>

<span class="c1"># Init parameters with specified constraints</span>
<span class="n">data</span><span class="o">.</span><span class="n">setMatEFit</span><span class="p">(</span><span class="n">paramsCons</span> <span class="o">=</span> <span class="n">paramsCons</span><span class="p">)</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Set 18 complex matrix elements to 36 fitting params, see self.params for details.
*** Warning, parameter test not present, skipping constraint test = p_PU_SG_PU_3_1_n1_1
</pre></div>
</div>
<div class="output text_html"><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:left'>vary</th><th style='text-align:right'>expression</th></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>5*m_A2u_0_A1g_A2u_3_0_0_0</td></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 1.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr></table></div></div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Individual parameters can be addressed by name, </span>

<span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Parameter &#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;, value=0.7071067811865475, bounds=[0.0001:5.0]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Properties can be modified directly... </span>
<span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;m_A2u_0_A1g_A2u_3_0_0_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.777</span>

<span class="c1"># ...or by using lmfit&#39;s `.set()` method.</span>
<span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span> <span class="o">=</span> <span class="mf">1.36</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">vary</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">data</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Parameter &#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;, value=1.36 (fixed), bounds=[0.0001:5.0]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The full set can always be checked via self.params</span>
<span class="n">data</span><span class="o">.</span><span class="n">params</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:left'>vary</th><th style='text-align:right'>expression</th></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'>5*m_A2u_0_A1g_A2u_3_0_0_0</td></tr><tr><td style='text-align:left'>m_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 1.77700000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 1.36000000</td><td style='text-align:left'>1.36</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>False</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>m_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 0.70710678</td><td style='text-align:left'>0.7071067811865475</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_1_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>False</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_A2u_0_A1g_A2u_3_0_0_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_1_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_0</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_n1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_n1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_0</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr><tr><td style='text-align:left'>p_E1u_0_A1g_E1u_3_1_1_1</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>3.141592653589793</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:left'>True</td><td style='text-align:right'></td></tr></table></div></div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The full mapping of parameter names and indexes is given in self.lmmu</span>
<span class="n">data</span><span class="o">.</span><span class="n">lmmu</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Index&#39;: MultiIndex([(&#39;A2u&#39;, 0, &#39;A1g&#39;, &#39;A2u&#39;, 1,  0,  0, 0),
             (&#39;A2u&#39;, 0, &#39;A1g&#39;, &#39;A2u&#39;, 3,  0,  0, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1, -1, -1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1, -1, -1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1, -1,  1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1, -1,  1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1,  1, -1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1,  1, -1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1,  1,  1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 1,  1,  1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3, -1, -1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3, -1, -1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3, -1,  1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3, -1,  1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3,  1, -1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3,  1, -1, 1),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3,  1,  1, 0),
             (&#39;E1u&#39;, 0, &#39;A1g&#39;, &#39;E1u&#39;, 3,  1,  1, 1)],
            names=[&#39;Cont&#39;, &#39;Eke&#39;, &#39;Targ&#39;, &#39;Total&#39;, &#39;l&#39;, &#39;m&#39;, &#39;mu&#39;, &#39;it&#39;]),
 &#39;Str&#39;: [&#39;A2u_0_A1g_A2u_1_0_0_0&#39;,
  &#39;A2u_0_A1g_A2u_3_0_0_0&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_n1_0&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_n1_1&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_1_0&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_1_1&#39;,
  &#39;E1u_0_A1g_E1u_1_1_n1_0&#39;,
  &#39;E1u_0_A1g_E1u_1_1_n1_1&#39;,
  &#39;E1u_0_A1g_E1u_1_1_1_0&#39;,
  &#39;E1u_0_A1g_E1u_1_1_1_1&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_n1_0&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_n1_1&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_1_0&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_1_1&#39;,
  &#39;E1u_0_A1g_E1u_3_1_n1_0&#39;,
  &#39;E1u_0_A1g_E1u_3_1_n1_1&#39;,
  &#39;E1u_0_A1g_E1u_3_1_1_0&#39;,
  &#39;E1u_0_A1g_E1u_3_1_1_1&#39;],
 &#39;lmMap&#39;: {&#39;A2u_0_A1g_A2u_1_0_0_0&#39;: &#39;0,1,0&#39;,
  &#39;A2u_0_A1g_A2u_3_0_0_0&#39;: &#39;0,3,0&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_n1_0&#39;: &#39;0,1,-1&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_n1_1&#39;: &#39;0,1,-1&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_1_0&#39;: &#39;0,1,-1&#39;,
  &#39;E1u_0_A1g_E1u_1_n1_1_1&#39;: &#39;0,1,-1&#39;,
  &#39;E1u_0_A1g_E1u_1_1_n1_0&#39;: &#39;0,1,1&#39;,
  &#39;E1u_0_A1g_E1u_1_1_n1_1&#39;: &#39;0,1,1&#39;,
  &#39;E1u_0_A1g_E1u_1_1_1_0&#39;: &#39;0,1,1&#39;,
  &#39;E1u_0_A1g_E1u_1_1_1_1&#39;: &#39;0,1,1&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_n1_0&#39;: &#39;0,3,-1&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_n1_1&#39;: &#39;0,3,-1&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_1_0&#39;: &#39;0,3,-1&#39;,
  &#39;E1u_0_A1g_E1u_3_n1_1_1&#39;: &#39;0,3,-1&#39;,
  &#39;E1u_0_A1g_E1u_3_1_n1_0&#39;: &#39;0,3,1&#39;,
  &#39;E1u_0_A1g_E1u_3_1_n1_1&#39;: &#39;0,3,1&#39;,
  &#39;E1u_0_A1g_E1u_3_1_1_0&#39;: &#39;0,3,1&#39;,
  &#39;E1u_0_A1g_E1u_3_1_1_1&#39;: &#39;0,3,1&#39;},
 &#39;map&#39;: [(&#39;A2u_0_A1g_A2u_1_0_0_0&#39;,
   [0, 18],
   &#39;m_A2u_0_A1g_A2u_1_0_0_0&#39;,
   &#39;p_A2u_0_A1g_A2u_1_0_0_0&#39;),
  (&#39;A2u_0_A1g_A2u_3_0_0_0&#39;,
   [1, 19],
   &#39;m_A2u_0_A1g_A2u_3_0_0_0&#39;,
   &#39;p_A2u_0_A1g_A2u_3_0_0_0&#39;),
  (&#39;E1u_0_A1g_E1u_1_n1_n1_0&#39;,
   [2, 20],
   &#39;m_E1u_0_A1g_E1u_1_n1_n1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_1_n1_n1_0&#39;),
  (&#39;E1u_0_A1g_E1u_1_n1_n1_1&#39;,
   [3, 21],
   &#39;m_E1u_0_A1g_E1u_1_n1_n1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_1_n1_n1_1&#39;),
  (&#39;E1u_0_A1g_E1u_1_n1_1_0&#39;,
   [4, 22],
   &#39;m_E1u_0_A1g_E1u_1_n1_1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_1_n1_1_0&#39;),
  (&#39;E1u_0_A1g_E1u_1_n1_1_1&#39;,
   [5, 23],
   &#39;m_E1u_0_A1g_E1u_1_n1_1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_1_n1_1_1&#39;),
  (&#39;E1u_0_A1g_E1u_1_1_n1_0&#39;,
   [6, 24],
   &#39;m_E1u_0_A1g_E1u_1_1_n1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_1_1_n1_0&#39;),
  (&#39;E1u_0_A1g_E1u_1_1_n1_1&#39;,
   [7, 25],
   &#39;m_E1u_0_A1g_E1u_1_1_n1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_1_1_n1_1&#39;),
  (&#39;E1u_0_A1g_E1u_1_1_1_0&#39;,
   [8, 26],
   &#39;m_E1u_0_A1g_E1u_1_1_1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_1_1_1_0&#39;),
  (&#39;E1u_0_A1g_E1u_1_1_1_1&#39;,
   [9, 27],
   &#39;m_E1u_0_A1g_E1u_1_1_1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_1_1_1_1&#39;),
  (&#39;E1u_0_A1g_E1u_3_n1_n1_0&#39;,
   [10, 28],
   &#39;m_E1u_0_A1g_E1u_3_n1_n1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_3_n1_n1_0&#39;),
  (&#39;E1u_0_A1g_E1u_3_n1_n1_1&#39;,
   [11, 29],
   &#39;m_E1u_0_A1g_E1u_3_n1_n1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_3_n1_n1_1&#39;),
  (&#39;E1u_0_A1g_E1u_3_n1_1_0&#39;,
   [12, 30],
   &#39;m_E1u_0_A1g_E1u_3_n1_1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_3_n1_1_0&#39;),
  (&#39;E1u_0_A1g_E1u_3_n1_1_1&#39;,
   [13, 31],
   &#39;m_E1u_0_A1g_E1u_3_n1_1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_3_n1_1_1&#39;),
  (&#39;E1u_0_A1g_E1u_3_1_n1_0&#39;,
   [14, 32],
   &#39;m_E1u_0_A1g_E1u_3_1_n1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_3_1_n1_0&#39;),
  (&#39;E1u_0_A1g_E1u_3_1_n1_1&#39;,
   [15, 33],
   &#39;m_E1u_0_A1g_E1u_3_1_n1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_3_1_n1_1&#39;),
  (&#39;E1u_0_A1g_E1u_3_1_1_0&#39;,
   [16, 34],
   &#39;m_E1u_0_A1g_E1u_3_1_1_0&#39;,
   &#39;p_E1u_0_A1g_E1u_3_1_1_0&#39;),
  (&#39;E1u_0_A1g_E1u_3_1_1_1&#39;,
   [17, 35],
   &#39;m_E1u_0_A1g_E1u_3_1_1_1&#39;,
   &#39;p_E1u_0_A1g_E1u_3_1_1_1&#39;)]}
</pre></div>
</div>
</div>
</details>
</div>
<p><strong>Manually setting fitting basis</strong></p>
<p>To modify and/or set a basis set manually, the same functions can be used with different inputs and/or options. A few examples are given here, see the <a class="reference external" href="https://pemtk.readthedocs.io">PEMtk documentation</a> <span id="id16">[<a class="reference internal" href="../backmatter/bibliography.html#id681" title="Paul Hockett. PEMtk - the Photoelectron Metrology Toolkit - documentation. 2021. URL: https://pemtk.readthedocs.io (visited on 2022-02-18).">20</a>]</span> for more information.</p>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Manual configuration of matrix elements</span>
<span class="c1"># Example using data class</span>
<span class="n">dataManual</span> <span class="o">=</span> <span class="n">pemtkFit</span><span class="p">()</span>

<span class="c1"># Manual setting for matrix elements</span>
<span class="c1"># See API docs at https://epsproc.readthedocs.io/en/dev/modules/epsproc.util.setMatE.html</span>
<span class="n">EPoints</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">setMatE</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">EPoints</span><span class="p">)],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">EPoints</span><span class="p">)],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">EPoints</span><span class="p">)]],</span> 
             <span class="n">dataNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">])</span>

<span class="c1"># Matrix elements are set to Xarray and Pandas formats, under the &#39;matE&#39; key</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;matE&#39;</span><span class="p">][</span><span class="s1">&#39;matE&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pd</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Eke</th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
    </tr>
    <tr>
      <th>l</th>
      <th>m</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>1.0</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.000</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <th>0</th>
      <td>0.0</td>
      <td>0.111</td>
      <td>0.222</td>
      <td>0.333</td>
      <td>0.444</td>
      <td>0.556</td>
      <td>0.667</td>
      <td>0.778</td>
      <td>0.889</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>4</th>
      <th>0</th>
      <td>0.0</td>
      <td>0.056</td>
      <td>0.111</td>
      <td>0.167</td>
      <td>0.222</td>
      <td>0.278</td>
      <td>0.333</td>
      <td>0.389</td>
      <td>0.444</td>
      <td>0.5</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</details>
</div>
<div class="cell tag_hide-output docutils container">
<div class="cell_input above-output-prompt docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To use manual settings for fitting, set `conformDims=True` to ensure ePSproc labelling</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">setMatE</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">EPoints</span><span class="p">)],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">EPoints</span><span class="p">)],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span><span class="n">EPoints</span><span class="p">)]],</span> 
             <span class="n">dataNames</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">],</span> <span class="n">conformDims</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Then use as normal</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">selOpts</span><span class="p">[</span><span class="s1">&#39;matE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;thres&#39;</span><span class="p">:</span> <span class="mf">0.01</span><span class="p">,</span> <span class="s1">&#39;inds&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;Type&#39;</span><span class="p">:</span><span class="s1">&#39;U&#39;</span><span class="p">,</span> <span class="s1">&#39;Eke&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span> <span class="p">}</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">setSubset</span><span class="p">(</span><span class="n">dataKey</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span><span class="p">,</span> <span class="n">dataType</span> <span class="o">=</span> <span class="s1">&#39;matE&#39;</span><span class="p">)</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">subKey</span><span class="p">][</span><span class="s1">&#39;matE&#39;</span><span class="p">][</span><span class="s1">&#39;it&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>   <span class="c1"># In some cases NaN values may need to be set for setMatEFit.</span>
<span class="n">dataManual</span><span class="o">.</span><span class="n">setMatEFit</span><span class="p">()</span>
</pre></div>
</div>
</div>
<details class="hide below-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell output</span>
<span class="expanded">Hide code cell output</span>
</summary>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Mapping coeffs to ePSproc dataType = matE
Remapped dims: {}
Added dim Cont
Added dim Targ
Added dim Total
Added dim mu
Added dim it
Added dim Type
Subselected from dataset &#39;matE&#39;, dataType &#39;matE&#39;: 3 from 30 points (10.00%)
Set 3 complex matrix elements to 6 fitting params, see self.params for details.
Auto-setting parameters.
</pre></div>
</div>
<div class="output text_html"><table class="jp-toc-ignore"><caption>Parameters</caption><tr><th style='text-align:left'>name</th><th style='text-align:left'>value</th><th style='text-align:left'>initial value</th><th style='text-align:left'>min</th><th style='text-align:left'>max</th><th style='text-align:right'>vary</th></tr><tr><td style='text-align:left'>m_U_U_U_0_0_nan_1</td><td style='text-align:left'> 1.00000000</td><td style='text-align:left'>1.0</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_U_U_U_2_0_nan_1</td><td style='text-align:left'> 0.11111111</td><td style='text-align:left'>0.1111111111111111</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>m_U_U_U_4_0_nan_1</td><td style='text-align:left'> 0.05555556</td><td style='text-align:left'>0.05555555555555555</td><td style='text-align:left'> 1.0000e-04</td><td style='text-align:left'> 5.00000000</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_U_U_U_0_0_nan_1</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>False</td></tr><tr><td style='text-align:left'>p_U_U_U_2_0_nan_1</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr><tr><td style='text-align:left'>p_U_U_U_4_0_nan_1</td><td style='text-align:left'> 0.00000000</td><td style='text-align:left'>0.0</td><td style='text-align:left'>-3.14159265</td><td style='text-align:left'> 3.14159265</td><td style='text-align:right'>True</td></tr></table></div></div>
</details>
</div>
</section>
</section>
</section>
<section id="comparison-with-symmetry-defined-and-computational-matrix-elements">
<span id="sec-basis-sets-comparison-with-abinitio"></span><h2><span class="section-number">6.4. </span>Comparison with symmetry-defined and computational matrix elements<a class="headerlink" href="#comparison-with-symmetry-defined-and-computational-matrix-elements" title="Permalink to this heading">#</a></h2>
<p>For comparison of a given symmetry-defined basis set with sample <em>ab initio</em> calculations using <a class="reference external" href="https://epolyscat.droppages.com/">ePolyScat (ePS)</a> <span id="id17">[<a class="reference internal" href="../backmatter/bibliography.html#id764" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18), doi:10.1016/0370-1573(86)90147-X.">36</a>, <a class="reference internal" href="../backmatter/bibliography.html#id628" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13), doi:10.1063/1.467237.">37</a>, <a class="reference internal" href="../backmatter/bibliography.html#id805" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18), doi:10.1063/1.479794.">38</a>, <a class="reference internal" href="../backmatter/bibliography.html#id767" title="R R Lucchese. ePolyScat User's Manual. URL: https://epolyscat.droppages.com/ (visited on 2022-04-26).">39</a>]</span> calculations, results can be computed locally or pulled from the web. Some sample/test datasets can be found as part of the <a class="reference external" href="https://github.com/phockett/ePSproc/tree/master/data">ePSproc repo</a>, which includes the case study examples herein. Further <a class="reference external" href="https://epolyscat.droppages.com/">ePolyScat (ePS)</a> <span id="id18">[<a class="reference internal" href="../backmatter/bibliography.html#id764" title="Robert R. Lucchese, Kazuo Takatsuka, and Vincent McKoy. Applications of the Schwinger variational principle to electron-molecule collisions and molecular photoionization. Physics Reports, 131(3):147–221, January 1986. URL: http://www.sciencedirect.com/science/article/pii/037015738690147X (visited on 2012-07-18), doi:10.1016/0370-1573(86)90147-X.">36</a>, <a class="reference internal" href="../backmatter/bibliography.html#id628" title="F. A. Gianturco, R. R. Lucchese, and N. Sanna. Calculation of low-energy elastic cross sections for electron-CF4 scattering. The Journal of Chemical Physics, 100(9):6464, May 1994. URL: http://scitation.aip.org/content/aip/journal/jcp/100/9/10.1063/1.467237 (visited on 2015-08-13), doi:10.1063/1.467237.">37</a>, <a class="reference internal" href="../backmatter/bibliography.html#id805" title="Alexandra P P Natalense and Robert R Lucchese. Cross section and asymmetry parameter calculation for sulfur 1s photoionization of SF[sub 6]. The Journal of Chemical Physics, 111(12):5344, 1999. URL: http://link.aip.org/link/JCPSA6/v111/i12/p5344/s1&amp;Agg=doi (visited on 2012-07-18), doi:10.1063/1.479794.">38</a>, <a class="reference internal" href="../backmatter/bibliography.html#id767" title="R R Lucchese. ePolyScat User's Manual. URL: https://epolyscat.droppages.com/ (visited on 2022-04-26).">39</a>]</span> datasets are available from <a class="reference external" href="https://github.com/phockett/ePSdata/">ePSdata</a> <span id="id19">[<a class="reference internal" href="../backmatter/bibliography.html#id679" title="Paul Hockett. ePS data: Photoionization calculations archive. 2019. URL: https://phockett.github.io/ePSdata/ (visited on 2022-02-16).">48</a>]</span>, and <a class="reference external" href="https://epsproc.readthedocs.io/en/dev/demos/ePSdata_download_demo_300720.html">data can be pulled using the python ePSdata interface</a>.</p>
<p>In the following, the test case above for <span class="math notranslate nohighlight">\(N_2~3\sigma_g^{-1}\)</span> ionization is illustrated. Note that this comparison shows the results of a full <em>ab initio</em> computation of the matrix elements (Eq. <a class="reference internal" href="../part1/theory_photoionization_dynamics_140723.html#equation-eq-mate-dipole">(3.3)</a>) versus the symmetry-allowed harmonics and associated <span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span> parameters (Eq. <a class="reference internal" href="../part1/theory_observables_intro_100723.html#equation-eq-symharm-defn">(3.38)</a>). In the former case, the <span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span> are incorporated into the numerical results, but the full angular momentum selection rules and dipole integrals are also included; in the latter case the <span class="math notranslate nohighlight">\(b_{hl\lambda}^{\Gamma\mu}\)</span> parameters serve to define the allowed matrix elements, and symmetry relations (e.g. phase, rotations and degeneracy), but <em>do not</em> include any other effects. Hence the comparison here indicates whether the symmetry-defined basis set is sufficient for a matrix element reconstruction, but it may contain terms which are zero in practice, or otherwise drop out from the complete photoionization treatment. Some conventions may also be different.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pull N2 data from ePSproc Github repo</span>
<span class="n">dataName</span> <span class="o">=</span> <span class="s1">&#39;n2Data&#39;</span>

<span class="c1"># Set data dir</span>
<span class="n">dataPath</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">Path</span><span class="o">.</span><span class="n">cwd</span><span class="p">(),</span> <span class="n">dataName</span><span class="p">)</span>

<span class="c1"># For pulling data from Github, a utility function is available</span>
<span class="c1"># This requires the repo subpath, and optionally branch</span>
<span class="n">fDictMatE</span><span class="p">,</span> <span class="n">fAllMatE</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">getFilesFromGithub</span><span class="p">(</span><span class="n">subpath</span><span class="o">=</span><span class="s1">&#39;data/photoionization/n2_multiorb&#39;</span><span class="p">,</span> 
                                                    <span class="n">dataName</span><span class="o">=</span><span class="n">dataName</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;dev&#39;</span><span class="p">)</span>  <span class="c1"># Optional settings</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Querying URL: https://api.github.com/repos/phockett/epsproc/contents/data/photoionization/n2_multiorb?ref=dev
*** Created output dir /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data
Downloading from https://raw.githubusercontent.com/phockett/ePSproc/dev/data/photoionization/n2_multiorb/n2_1pu_0.1-50.1eV_A2.inp.out to /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data/n2_1pu_0.1-50.1eV_A2.inp.out.
Pulled to file: /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data/n2_1pu_0.1-50.1eV_A2.inp.out
Downloading from https://raw.githubusercontent.com/phockett/ePSproc/dev/data/photoionization/n2_multiorb/n2_3sg_0.1-50.1eV_A2.inp.out to /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data/n2_3sg_0.1-50.1eV_A2.inp.out.
Pulled to file: /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data/n2_3sg_0.1-50.1eV_A2.inp.out
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import data with PEMtk class</span>
<span class="c1"># For more details on ePSproc usage see </span>
<span class="c1"># https://epsproc.readthedocs.io/en/dev/demos/ePSproc_class_demo_161020.html</span>

<span class="c1"># Instantiate class object.</span>
<span class="c1"># Minimally this needs just the dataPath, if verbose = 1 is set </span>
<span class="c1"># then some useful output will also be printed.</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pemtkFit</span><span class="p">(</span><span class="n">fileBase</span><span class="o">=</span><span class="n">dataPath</span><span class="p">,</span> <span class="n">verbose</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># ScanFiles() - this will look for data files on the path provided, and read from them.</span>
<span class="n">data</span><span class="o">.</span><span class="n">scanFiles</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>*** Job subset details
Key: subset
No &#39;job&#39; info set for self.data[subset].

*** Job orb6 details
Key: orb6
Dir /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data, 1 file(s).
{   &#39;batch&#39;: &#39;ePS n2, batch n2_1pu_0.1-50.1eV, orbital A2&#39;,
    &#39;event&#39;: &#39; N2 A-state (1piu-1)&#39;,
    &#39;orbE&#39;: -17.09691397835426,
    &#39;orbLabel&#39;: &#39;1piu-1&#39;}

*** Job orb5 details
Key: orb5
Dir /home/jovyan/jake-home/buildTmp/_latest_build/html/doc-source/part2/n2Data, 1 file(s).
{   &#39;batch&#39;: &#39;ePS n2, batch n2_3sg_0.1-50.1eV, orbital A2&#39;,
    &#39;event&#39;: &#39; N2 X-state (3sg-1)&#39;,
    &#39;orbE&#39;: -17.34181645456815,
    &#39;orbLabel&#39;: &#39;3sg-1&#39;}
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tabulate some demo matrix elements</span>
<span class="n">singleEdata</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">matEleSelector</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;orb5&#39;</span><span class="p">][</span><span class="s1">&#39;matE&#39;</span><span class="p">],</span> <span class="n">inds</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;Eke&#39;</span><span class="p">:</span><span class="nb">slice</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="s1">&#39;Type&#39;</span><span class="p">:</span><span class="s1">&#39;L&#39;</span><span class="p">},</span> <span class="n">thres</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="n">matEPD</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ep</span><span class="o">.</span><span class="n">multiDimXrToPD</span><span class="p">(</span><span class="n">singleEdata</span><span class="p">,</span> <span class="n">colDims</span> <span class="o">=</span> <span class="s1">&#39;Cont&#39;</span><span class="p">,</span> <span class="n">thres</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span> 


<span class="c1"># Compare results</span>
<span class="c1"># For side-by-side tables, code adapted from https://stackoverflow.com/a/50899244</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display_html</span> 

<span class="c1"># Check specific symmetry sets</span>
<span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A2u&#39;</span><span class="p">,</span><span class="s1">&#39;SU&#39;</span><span class="p">]</span>  <span class="c1"># Set for [manual, ePS] symmetry label selections</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">symObjA1g</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;symAllowed&#39;</span><span class="p">][</span><span class="s1">&#39;PD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="n">syms</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">matEPD</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">syms</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="n">df1_styler</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s2">&quot;style=&#39;display:inline&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;Symmetry basis&lt;/b&gt;&#39;</span><span class="p">)</span>
<span class="n">df2_styler</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s2">&quot;style=&#39;display:inline&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;ePS basis&lt;/b&gt;&#39;</span><span class="p">)</span>

<span class="c1"># display_html(df1_styler._repr_html_()+df2_styler._repr_html_(), raw=True)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Format and display results from previous cell (hidden in some formats)</span>
<span class="n">display_html</span><span class="p">(</span><span class="n">df1_styler</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">()</span><span class="o">+</span><span class="n">df2_styler</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">(),</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_609e0" style='display:inline'>
  <caption><b>Symmetry basis</b></caption>
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_609e0_level0_col0" class="col_heading level0 col0" >A2u</th>
    </tr>
    <tr>
      <th class="index_name level0" >Eke</th>
      <th class="index_name level1" >Targ</th>
      <th class="index_name level2" >Total</th>
      <th class="index_name level3" >it</th>
      <th class="index_name level4" >l</th>
      <th class="index_name level5" >m</th>
      <th class="index_name level6" >mu</th>
      <th class="blank col0" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_609e0_level0_row0" class="row_heading level0 row0" rowspan="2">0</th>
      <th id="T_609e0_level1_row0" class="row_heading level1 row0" rowspan="2">A1g</th>
      <th id="T_609e0_level2_row0" class="row_heading level2 row0" rowspan="2">A2u</th>
      <th id="T_609e0_level3_row0" class="row_heading level3 row0" rowspan="2">0</th>
      <th id="T_609e0_level4_row0" class="row_heading level4 row0" >1</th>
      <th id="T_609e0_level5_row0" class="row_heading level5 row0" >0</th>
      <th id="T_609e0_level6_row0" class="row_heading level6 row0" >0</th>
      <td id="T_609e0_row0_col0" class="data row0 col0" >1.000000+0.000000j</td>
    </tr>
    <tr>
      <th id="T_609e0_level4_row1" class="row_heading level4 row1" >3</th>
      <th id="T_609e0_level5_row1" class="row_heading level5 row1" >0</th>
      <th id="T_609e0_level6_row1" class="row_heading level6 row1" >0</th>
      <td id="T_609e0_row1_col0" class="data row1 col0" >1.000000+0.000000j</td>
    </tr>
  </tbody>
</table>
<style type="text/css">
</style>
<table id="T_e983b" style='display:inline'>
  <caption><b>ePS basis</b></caption>
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_e983b_level0_col0" class="col_heading level0 col0" >SU</th>
    </tr>
    <tr>
      <th class="index_name level0" >Eke</th>
      <th class="index_name level1" >Targ</th>
      <th class="index_name level2" >Total</th>
      <th class="index_name level3" >it</th>
      <th class="index_name level4" >l</th>
      <th class="index_name level5" >m</th>
      <th class="index_name level6" >mu</th>
      <th class="blank col0" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_e983b_level0_row0" class="row_heading level0 row0" rowspan="3">0.100000</th>
      <th id="T_e983b_level1_row0" class="row_heading level1 row0" rowspan="3">SG</th>
      <th id="T_e983b_level2_row0" class="row_heading level2 row0" rowspan="3">SU</th>
      <th id="T_e983b_level3_row0" class="row_heading level3 row0" rowspan="3">1</th>
      <th id="T_e983b_level4_row0" class="row_heading level4 row0" >1</th>
      <th id="T_e983b_level5_row0" class="row_heading level5 row0" >0</th>
      <th id="T_e983b_level6_row0" class="row_heading level6 row0" >0</th>
      <td id="T_e983b_row0_col0" class="data row0 col0" >2.736321-0.092697j</td>
    </tr>
    <tr>
      <th id="T_e983b_level4_row1" class="row_heading level4 row1" >3</th>
      <th id="T_e983b_level5_row1" class="row_heading level5 row1" >0</th>
      <th id="T_e983b_level6_row1" class="row_heading level6 row1" >0</th>
      <td id="T_e983b_row1_col0" class="data row1 col0" >-0.171588-0.795292j</td>
    </tr>
    <tr>
      <th id="T_e983b_level4_row2" class="row_heading level4 row2" >5</th>
      <th id="T_e983b_level5_row2" class="row_heading level5 row2" >0</th>
      <th id="T_e983b_level6_row2" class="row_heading level6 row2" >0</th>
      <td id="T_e983b_row2_col0" class="data row2 col0" >-0.000034+0.001499j</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Here (<span class="math notranslate nohighlight">\(\Sigma_u\)</span> case) the basis sets are identical, aside from the difference in <span class="math notranslate nohighlight">\(l_{max}\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check specific sets</span>
<span class="n">syms</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;E1u&#39;</span><span class="p">,</span><span class="s1">&#39;PU&#39;</span><span class="p">]</span>   <span class="c1"># Set for [manual, ePS] symmetry label selections</span>
<span class="n">df1</span> <span class="o">=</span> <span class="n">symObjA1g</span><span class="o">.</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;symAllowed&#39;</span><span class="p">][</span><span class="s1">&#39;PD&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;h&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">droplevel</span><span class="p">(</span><span class="s1">&#39;Type&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="n">syms</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">matEPD</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Total&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">False</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="n">syms</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">to_frame</span><span class="p">()</span>

<span class="n">df1_styler</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s2">&quot;style=&#39;display:inline&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;Symmetry basis&lt;/b&gt;&#39;</span><span class="p">)</span>
<span class="n">df2_styler</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_attributes</span><span class="p">(</span><span class="s2">&quot;style=&#39;display:inline&#39;&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_caption</span><span class="p">(</span><span class="s1">&#39;&lt;b&gt;ePS basis&lt;/b&gt;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Format and display results from previous cell (hidden in some formats)</span>
<span class="n">display_html</span><span class="p">(</span><span class="n">df1_styler</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">()</span><span class="o">+</span><span class="n">df2_styler</span><span class="o">.</span><span class="n">_repr_html_</span><span class="p">(),</span> <span class="n">raw</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
</style>
<table id="T_3d300" style='display:inline'>
  <caption><b>Symmetry basis</b></caption>
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_3d300_level0_col0" class="col_heading level0 col0" >E1u</th>
    </tr>
    <tr>
      <th class="index_name level0" >Eke</th>
      <th class="index_name level1" >Targ</th>
      <th class="index_name level2" >Total</th>
      <th class="index_name level3" >it</th>
      <th class="index_name level4" >l</th>
      <th class="index_name level5" >m</th>
      <th class="index_name level6" >mu</th>
      <th class="blank col0" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_3d300_level0_row0" class="row_heading level0 row0" rowspan="16">0</th>
      <th id="T_3d300_level1_row0" class="row_heading level1 row0" rowspan="16">A1g</th>
      <th id="T_3d300_level2_row0" class="row_heading level2 row0" rowspan="16">E1u</th>
      <th id="T_3d300_level3_row0" class="row_heading level3 row0" rowspan="8">0</th>
      <th id="T_3d300_level4_row0" class="row_heading level4 row0" rowspan="4">1</th>
      <th id="T_3d300_level5_row0" class="row_heading level5 row0" rowspan="2">-1</th>
      <th id="T_3d300_level6_row0" class="row_heading level6 row0" >-1</th>
      <td id="T_3d300_row0_col0" class="data row0 col0" >0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row1" class="row_heading level6 row1" >1</th>
      <td id="T_3d300_row1_col0" class="data row1 col0" >0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level5_row2" class="row_heading level5 row2" rowspan="2">1</th>
      <th id="T_3d300_level6_row2" class="row_heading level6 row2" >-1</th>
      <td id="T_3d300_row2_col0" class="data row2 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row3" class="row_heading level6 row3" >1</th>
      <td id="T_3d300_row3_col0" class="data row3 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level4_row4" class="row_heading level4 row4" rowspan="4">3</th>
      <th id="T_3d300_level5_row4" class="row_heading level5 row4" rowspan="2">-1</th>
      <th id="T_3d300_level6_row4" class="row_heading level6 row4" >-1</th>
      <td id="T_3d300_row4_col0" class="data row4 col0" >0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row5" class="row_heading level6 row5" >1</th>
      <td id="T_3d300_row5_col0" class="data row5 col0" >0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level5_row6" class="row_heading level5 row6" rowspan="2">1</th>
      <th id="T_3d300_level6_row6" class="row_heading level6 row6" >-1</th>
      <td id="T_3d300_row6_col0" class="data row6 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row7" class="row_heading level6 row7" >1</th>
      <td id="T_3d300_row7_col0" class="data row7 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level3_row8" class="row_heading level3 row8" rowspan="8">1</th>
      <th id="T_3d300_level4_row8" class="row_heading level4 row8" rowspan="4">1</th>
      <th id="T_3d300_level5_row8" class="row_heading level5 row8" rowspan="2">-1</th>
      <th id="T_3d300_level6_row8" class="row_heading level6 row8" >-1</th>
      <td id="T_3d300_row8_col0" class="data row8 col0" >-0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row9" class="row_heading level6 row9" >1</th>
      <td id="T_3d300_row9_col0" class="data row9 col0" >-0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level5_row10" class="row_heading level5 row10" rowspan="2">1</th>
      <th id="T_3d300_level6_row10" class="row_heading level6 row10" >-1</th>
      <td id="T_3d300_row10_col0" class="data row10 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row11" class="row_heading level6 row11" >1</th>
      <td id="T_3d300_row11_col0" class="data row11 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level4_row12" class="row_heading level4 row12" rowspan="4">3</th>
      <th id="T_3d300_level5_row12" class="row_heading level5 row12" rowspan="2">-1</th>
      <th id="T_3d300_level6_row12" class="row_heading level6 row12" >-1</th>
      <td id="T_3d300_row12_col0" class="data row12 col0" >-0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row13" class="row_heading level6 row13" >1</th>
      <td id="T_3d300_row13_col0" class="data row13 col0" >-0.707107+0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level5_row14" class="row_heading level5 row14" rowspan="2">1</th>
      <th id="T_3d300_level6_row14" class="row_heading level6 row14" >-1</th>
      <td id="T_3d300_row14_col0" class="data row14 col0" >-0.707107-0.000000j</td>
    </tr>
    <tr>
      <th id="T_3d300_level6_row15" class="row_heading level6 row15" >1</th>
      <td id="T_3d300_row15_col0" class="data row15 col0" >-0.707107-0.000000j</td>
    </tr>
  </tbody>
</table>
<style type="text/css">
</style>
<table id="T_80802" style='display:inline'>
  <caption><b>ePS basis</b></caption>
  <thead>
    <tr>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank" >&nbsp;</th>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_80802_level0_col0" class="col_heading level0 col0" >PU</th>
    </tr>
    <tr>
      <th class="index_name level0" >Eke</th>
      <th class="index_name level1" >Targ</th>
      <th class="index_name level2" >Total</th>
      <th class="index_name level3" >it</th>
      <th class="index_name level4" >l</th>
      <th class="index_name level5" >m</th>
      <th class="index_name level6" >mu</th>
      <th class="blank col0" >&nbsp;</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_80802_level0_row0" class="row_heading level0 row0" rowspan="4">0.100000</th>
      <th id="T_80802_level1_row0" class="row_heading level1 row0" rowspan="4">SG</th>
      <th id="T_80802_level2_row0" class="row_heading level2 row0" rowspan="4">PU</th>
      <th id="T_80802_level3_row0" class="row_heading level3 row0" rowspan="4">1</th>
      <th id="T_80802_level4_row0" class="row_heading level4 row0" rowspan="2">1</th>
      <th id="T_80802_level5_row0" class="row_heading level5 row0" >-1</th>
      <th id="T_80802_level6_row0" class="row_heading level6 row0" >1</th>
      <td id="T_80802_row0_col0" class="data row0 col0" >-1.775708+0.634748j</td>
    </tr>
    <tr>
      <th id="T_80802_level5_row1" class="row_heading level5 row1" >1</th>
      <th id="T_80802_level6_row1" class="row_heading level6 row1" >-1</th>
      <td id="T_80802_row1_col0" class="data row1 col0" >-1.775708+0.634748j</td>
    </tr>
    <tr>
      <th id="T_80802_level4_row2" class="row_heading level4 row2" rowspan="2">3</th>
      <th id="T_80802_level5_row2" class="row_heading level5 row2" >-1</th>
      <th id="T_80802_level6_row2" class="row_heading level6 row2" >1</th>
      <td id="T_80802_row2_col0" class="data row2 col0" >0.075363+0.602171j</td>
    </tr>
    <tr>
      <th id="T_80802_level5_row3" class="row_heading level5 row3" >1</th>
      <th id="T_80802_level6_row3" class="row_heading level6 row3" >-1</th>
      <td id="T_80802_row3_col0" class="data row3 col0" >0.075363+0.602171j</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Here (<span class="math notranslate nohighlight">\(\Pi_u\)</span> case) the symmetry-defined basis has two degenerate continua, <code class="docutils literal notranslate"><span class="pre">it=0,1</span></code>, with a phase rotation applied between them. For <code class="docutils literal notranslate"><span class="pre">it=0</span></code> the <span class="math notranslate nohighlight">\(\pm m\)</span> terms are anti-phase, whilst for <code class="docutils literal notranslate"><span class="pre">it=1</span></code> they are in-phase (all negative). For the ePS basis, only the anti-phase component is present, and is further reduced to terms with <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(mu\)</span> of opposite sign. These differences are due to additional restrictions imposed by angular momentum selection rules, which are not included in the symmetry-defined case.</p>
<p>In general, the current mappings should be suitable for simulation and reconstruction, but care should be taken to:</p>
<ol class="arabic simple">
<li><p>Confirm symmetry and angular momentum relations for a given case.</p></li>
<li><p>Apply additional transformations if comparison with computational results is required.</p></li>
<li><p>Add degeneracy factors if required (otherwise these will be subsumed into matrix element values).</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./part2"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="extracting_matrix_elements_overview_270423.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>Extracting matrix elements overview</p>
      </div>
    </a>
    <a class="right-next"
       href="basic_fitting_numerics_intro_260723.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>General fit setup and numerics</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-defined-basis-sets">6.1. Symmetry-defined basis sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#computationally-defined-basis-sets">6.2. Computationally-defined basis sets</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#basis-creation-worked-examples">6.3. Basis creation worked examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#simple-case-n-2-3-sigma-g-1-ionization">6.3.1. Simple case: <span class="math notranslate nohighlight">\(N_2~3\sigma_g^{-1}\)</span> ionization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#degenerate-case-example-n-2-3-pi-u-1-ionization">6.3.2. Degenerate case example: <span class="math notranslate nohighlight">\(N_2~3\pi_u^{-1}\)</span> ionization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#defining-symmetrized-harmonics">6.3.3. Defining symmetrized harmonics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-symmetrized-harmonics-to-fit-parameters">6.3.4. Mapping symmetrized harmonics to fit parameters</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#remapping-to-epolyscat-definitions">6.3.4.1. Remapping to ePolyScat definitions</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#mapping-to-fitting-parameters-and-reduction">6.3.4.2. Mapping to fitting parameters (and reduction)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparison-with-symmetry-defined-and-computational-matrix-elements">6.4. Comparison with symmetry-defined and computational matrix elements</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Paul Hockett with Varun Makhija
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>